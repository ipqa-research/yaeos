<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Calculation of thermodynamic properties and phase-equilibria with Equation of State. Keeping high performance with the power of Fortran and the possiblity of using either automatic differentiation and anallytical derivatives.">
    <meta name="author" content="Federico Benelli" >
    <link rel="icon" href="../favicon.png">

    <title>yaeos__equilibria_boundaries_phase_envelopes_mp &ndash; yaeos</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">yaeos </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">User documentation</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>yaeos__equilibria_boundaries_phase_envelopes_mp
      <small>Module</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li class="list-inline-item" id="meta-license"><i class="fa fa-legal"></i> MPL</li>

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 3.5% of total for modules and submodules.">413 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/phase_envelopes_pt_mp.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/phase_envelopes_pt_mp.f90.html'>phase_envelopes_pt_mp.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">yaeos__equilibria_boundaries_phase_envelopes_mp</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#types-0"
         aria-expanded="false" aria-controls="types-0">
         <h4 class="card-header bg-primary text-white">Derived Types</h4>
      </a>
      <div id="types-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/yaeos__equilibria_boundaries_phase_envelopes_mp.html#type-ptenvelmp">PTEnvelMP</a>
            <a class="list-group-item" href="../module/yaeos__equilibria_boundaries_phase_envelopes_mp.html#type-mppoint">MPPoint</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#funcs-0"
         aria-expanded="false" aria-controls="funcs-0">
         <h4 class="card-header bg-primary text-white">Functions</h4>
      </a>
      <div id="funcs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/yaeos__equilibria_boundaries_phase_envelopes_mp.html#proc-pt_envelope">pt_envelope</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/yaeos__equilibria_boundaries_phase_envelopes_mp.html#proc-pt_f_np">pt_F_NP</a>
            <a class="list-group-item" href="../module/yaeos__equilibria_boundaries_phase_envelopes_mp.html#proc-get_values_from_x~2">get_values_from_X</a>
            <a class="list-group-item" href="../module/yaeos__equilibria_boundaries_phase_envelopes_mp.html#proc-solve_point~2">solve_point</a>
            <a class="list-group-item" href="../module/yaeos__equilibria_boundaries_phase_envelopes_mp.html#proc-update_specification~2">update_specification</a>
            <a class="list-group-item" href="../module/yaeos__equilibria_boundaries_phase_envelopes_mp.html#proc-write_envelope_pt_mp">write_envelope_PT_MP</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  


  </div>

    </div>

    <div class="col-md-9" id='text'>
      <p>Multiphase PT envelope calculation module.</p>
<p>This module contains the functions to calculate the PT envelope of a
mixture with multiple phases.</p>
<br>          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='yaeos__equilibria_equilibrium_state.html'>yaeos__equilibria_equilibrium_state</a></li>
                  <li class="list-inline-item"><a href='yaeos__math.html'>yaeos__math</a></li>
                  <li class="list-inline-item"><a href='yaeos__equilibria_boundaries_auxiliar.html'>yaeos__equilibria_boundaries_auxiliar</a></li>
                  <li class="list-inline-item"><a href='yaeos__constants.html'>yaeos__constants</a></li>
                  <li class="list-inline-item"><a href='yaeos__models_ar.html'>yaeos__models_ar</a></li>
              </ul>
            </li>
        </ul>
      </div>
    </div>

      
      <br>






        <section>
          <h2>Derived Types</h2>
              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-ptenvelmp"></span>
      <h3>
        type, public&nbsp;::&nbsp;
        <a href='../type/ptenvelmp.html'>PTEnvelMP</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>Multiphase PT envelope.</p>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-pc"></span>
              real(kind=pr),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>Pc</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
<p>Critical pressures.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tc"></span>
              real(kind=pr),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>Tc</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
<p>Critical temperatures.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-points~2"></span>
              type(<a href='../type/mppoint.html'>MPPoint</a>),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>points</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
<p>Array of converged points.</p>
            </td>
        </tr>
    </tbody>
  </table>




        <h4>Type-Bound Procedures</h4>
        <table class="table table-striped varlist">
          <tbody>
              <tr>
                <td>  procedure, public, nopass ::
  <strong><a href='../type/ptenvelmp.html#boundprocedure-get_values_from_x'>get_values_from_X</a></strong></td>
                  <td></td>
              </tr>
              <tr>
                <td>  procedure, public, nopass ::
  <strong><a href='../type/ptenvelmp.html#boundprocedure-solve_point'>solve_point</a></strong></td>
                  <td></td>
              </tr>
              <tr>
                <td>  procedure, public ::
  <strong><a href='../type/ptenvelmp.html#boundprocedure-write'>write</a></strong> => <a href='/home/runner/work/yaeos/yaeos/doc/ford_site/proc/write_envelope_pt_mp.html'>write_envelope_PT_MP</a></td>
                  <td></td>
              </tr>
          </tbody>
        </table>
    </div>
  </div>

              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-mppoint"></span>
      <h3>
        type, private&nbsp;::&nbsp;
        <a href='../type/mppoint.html'>MPPoint</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>Multiphase equilibria point.</p>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-p~7"></span>
              real(kind=pr),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>P</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Pressure [bar]</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t~7"></span>
              real(kind=pr),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>T</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Temperature [K]</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-beta_w"></span>
              real(kind=pr),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>beta_w</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Fraction of the reference (incipient) phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-betas"></span>
              real(kind=pr),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>betas</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
<p>Fractions of the main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iters"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iters</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Number of iterations needed to converge the point.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kind_w"></span>
              character(len=14),
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>kind_w</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Kind of the reference phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kinds_x"></span>
              character(len=14),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>kinds_x</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
<p>Kinds of the main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nc~7"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nc</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Number of components</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-np"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>np</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Number of phases</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ns~7"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ns</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Number of the specified variable.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-w~5"></span>
              real(kind=pr),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>w</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
<p>Mole fractions of the incipient phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x_l"></span>
              real(kind=pr),
            </td>
              <td>public,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>x_l</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
<p>Mole fractions of the main phases.</p>
            </td>
        </tr>
    </tbody>
  </table>




    </div>
  </div>

        </section>
        <br>

        <section>
          <h2>Functions</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-pt_envelope"></span> <h3>public  function <a href='../proc/pt_envelope.html'>pt_envelope</a>(model, z, np, kinds_x, kind_w, x_l0, w0, betas0, P0, T0, ns0, dS0, beta_w, points, max_pressure)  
</h3></div>
    <div class="card-body">
          
  <p>Calculation of a multiphase PT envelope.</p><a href="../proc/pt_envelope.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-model~6"></span>
              class(<a href='../type/armodel.html'>ArModel</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>model</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z~6"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>z</strong>(:)</td>
            <td>
<p>Mixture global composition.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-np~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>np</strong></td>
            <td>
<p>Number of main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kinds_x~2"></span>
              character(len=14),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>kinds_x</strong>(np)</td>
            <td>
<p>Kind of the main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kind_w~2"></span>
              character(len=14),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>kind_w</strong></td>
            <td>
<p>Kind of the reference phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x_l0"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x_l0</strong>(np,size(z))</td>
            <td>
<p>Initial guess for the mole fractions of each phase. arranged as
an array of size <code>(np, nc)</code>, where nc is the number of components
and <code>np</code> the number of main phases. Each row correspond to the
composition of each main phaase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-w0~2"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>w0</strong>(size(z))</td>
            <td>
<p>Initial guess for the mole fractions of the
reference/incipient phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-betas0"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>betas0</strong>(np)</td>
            <td>
<p>Initial guess for the fractions of the main phases. arranged as
an array of size <code>(np)</code>, where <code>np</code> is the number of main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p0~2"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>P0</strong></td>
            <td>
<p>Initial guess for the pressure [bar].</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t0~2"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>T0</strong></td>
            <td>
<p>Initial guess for the temperature [K].</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ns0~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ns0</strong></td>
            <td>
<p>Number of the specified variable.
The variable to be specified. This is the variable that will be
used to calculate the first point of the envelope. The variable
can be any of the variables in the vector X, but it is recommended
to use the temperature or pressure. The variables are aranged as
follows:</p><a href="../proc/pt_envelope.html#variable-ns0~2" class="pull-right"><emph>Read more&hellip;</emph></a>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ds0~2"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dS0</strong></td>
            <td>
<p>Step size of the specification for the next point.
This is the step size that will be used to calculate the next point.
Inside the algorithm this value is modified to adapt the step size
to facilitate the convergence of each point.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-beta_w~2"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>beta_w</strong></td>
            <td>
<p>Fraction of the reference (incipient) phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-points~3"></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>points</strong></td>
            <td>
<p>Number of points to calculate.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_pressure"></span>
              real(kind=pr),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_pressure</strong></td>
            <td>
<p>Maximum pressure [bar] to calculate.
If the pressure of the point is greater than this value, the
calculation is stopped.
This is useful to avoid calculating envelopes that go to infinite
values of pressure.</p>
            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>type(<a href='../type/ptenvelmp.html'>PTEnvelMP</a>)</small>
    </h4>
    

    </div>
  </div>

        </section>
        <br>

        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-pt_f_np"></span> <h3>public  subroutine <a href='../proc/pt_f_np.html'>pt_F_NP</a>(model, z, np, beta_w, kinds_x, kind_w, X, ns, S, F, df)  
</h3></div>
    <div class="card-body">
          
  <p>Function to solve at each point of a multi-phase envelope.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-model~7"></span>
              class(<a href='../type/armodel.html'>ArModel</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>model</strong></td>
            <td>
<p>Model to use.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z~7"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>z</strong>(:)</td>
            <td>
<p>Mixture global composition.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-np~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>np</strong></td>
            <td>
<p>Number of main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-beta_w~3"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>beta_w</strong></td>
            <td>
<p>Fraction of the reference (incipient) phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kinds_x~3"></span>
              character(len=14),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>kinds_x</strong>(np)</td>
            <td>
<p>Kind of the main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kind_w~3"></span>
              character(len=14),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>kind_w</strong></td>
            <td>
<p>Kind of the reference phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~5"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong>(:)</td>
            <td>
<p>Vector of variables.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ns~9"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ns</strong></td>
            <td>
<p>Number of specification.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s~7"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>S</strong></td>
            <td>
<p>Specification value.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-f~5"></span>
              real(kind=pr),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>F</strong>(size(X))</td>
            <td>
<p>Vector of functions valuated.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-df~2"></span>
              real(kind=pr),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>df</strong>(size(X),size(X))</td>
            <td>
<p>Jacobian matrix.</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-get_values_from_x~2"></span> <h3>private  subroutine <a href='../proc/get_values_from_x~2.html'>get_values_from_X</a>(X, np, z, beta_w, x_l, w, betas, P, T)  
</h3></div>
    <div class="card-body">
          
  <p>Extract the values of the variables from the vector X.</p><a href="../proc/get_values_from_x~2.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-x~8"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong>(:)</td>
            <td>
<p>Vector of variables.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-np~6"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>np</strong></td>
            <td>
<p>Number of main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z~9"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>z</strong>(:)</td>
            <td>
<p>Mixture composition.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-beta_w~5"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>beta_w</strong></td>
            <td>
<p>Fraction of the reference phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x_l~4"></span>
              real(kind=pr),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x_l</strong>(np,size(z))</td>
            <td>
<p>Mole fractions of the main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-w~8"></span>
              real(kind=pr),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>w</strong>(size(z))</td>
            <td>
<p>Mole fractions of the incipient phase.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-betas~4"></span>
              real(kind=pr),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>betas</strong>(np)</td>
            <td>
<p>Fractions of the main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p~10"></span>
              real(kind=pr),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>P</strong></td>
            <td>
<p>Pressure [bar].</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t~10"></span>
              real(kind=pr),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>T</strong></td>
            <td>
<p>Temperature [K].</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-solve_point~2"></span> <h3>private  subroutine <a href='../proc/solve_point~2.html'>solve_point</a>(model, z, np, beta_w, kinds_x, kind_w, X, ns, S, dXdS, F, df, iters, max_iterations)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-model~8"></span>
              class(<a href='../type/armodel.html'>ArModel</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>model</strong></td>
            <td>
<p>Model to use.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z~8"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>z</strong>(:)</td>
            <td>
<p>Mixture global composition.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-np~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>np</strong></td>
            <td>
<p>Number of main phases</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-beta_w~4"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>beta_w</strong></td>
            <td>
<p>Fraction of the reference (incipient) phase</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kinds_x~4"></span>
              character(len=14),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>kinds_x</strong>(np)</td>
            <td>
<p>Kind of the main phases</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-kind_w~4"></span>
              character(len=14),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>kind_w</strong></td>
            <td>
<p>Kind of the reference phase</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~6"></span>
              real(kind=pr),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong>(:)</td>
            <td>
<p>Vector of variables</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ns~10"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ns</strong></td>
            <td>
<p>Number of specification</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s~8"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>S</strong></td>
            <td>
<p>Specification value</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dxds~5"></span>
              real(kind=pr),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dXdS</strong>(size(X))</td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-f~6"></span>
              real(kind=pr),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>F</strong>(size(X))</td>
            <td>
<p>Vector of functions valuated</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-df~3"></span>
              real(kind=pr),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>df</strong>(size(X),size(X))</td>
            <td>
<p>Jacobian matrix</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iters~2"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iters</strong></td>
            <td>
<p>Number of iterations to solve the current point</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-max_iterations~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>max_iterations</strong></td>
            <td>
<p>Maximum number of iterations to solve the point</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-update_specification~2"></span> <h3>private  subroutine <a href='../proc/update_specification~2.html'>update_specification</a>(its, nc, np, X, dF, dXdS, ns, dS)  
</h3></div>
    <div class="card-body">
          
  <p>Change the specified variable for the next step.</p><a href="../proc/update_specification~2.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-its~6"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>its</strong></td>
            <td>
<p>Iterations to solve the current point.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nc~11"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nc</strong></td>
            <td>
<p>Number of components in the mixture.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-np~5"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>np</strong></td>
            <td>
<p>Number of main phases.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~7"></span>
              real(kind=pr),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong>(:)</td>
            <td>
<p>Vector of variables.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-df~5"></span>
              real(kind=pr),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dF</strong>(:,:)</td>
            <td>
<p>Jacobian matrix.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dxds~6"></span>
              real(kind=pr),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dXdS</strong>(:)</td>
            <td>
<p>Sensitivity of the variables wrt the specification.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ns~11"></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ns</strong></td>
            <td>
<p>Number of the specified variable.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ds~5"></span>
              real(kind=pr),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dS</strong></td>
            <td>
<p>Step size of the specification for the next point.</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-write_envelope_pt_mp"></span> <h3>private  subroutine <a href='../proc/write_envelope_pt_mp.html'>write_envelope_PT_MP</a>(env, unit)  
</h3></div>
    <div class="card-body">
          
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-env"></span>
              class(<a href='../type/ptenvelmp.html'>PTEnvelMP</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>env</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-unit"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>unit</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

        </section>
        <br>



    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              yaeos
 was developed by Federico Benelli<br>              &copy; 2025 MPL
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-01 23:26 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>