<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Calculation of thermodynamic properties and phase-equilibria with Equation of State. Keeping high performance with the power of Fortran and the possiblity of using either automatic differentiation and anallytical derivatives.">
    <meta name="author" content="Federico Benelli" >
    <link rel="icon" href="../../favicon.png">

    <title>Using yaeos &ndash; yaeos</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../../css/pygments.css" rel="stylesheet">
    <link href="../../css/font-awesome.min.css" rel="stylesheet">
    <link href="../../css/local.css" rel="stylesheet">
      <link  href="../../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../../index.html">yaeos </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../index.html">User documentation</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>Using yaeos</h1>
    <div class="container p-2 mb-4 bg-light border rounded-3">
      <div class="row align-items-center justify-content-between">
        <div class="col">
          <ul class="list-inline" style="margin-bottom:0px; display:inline">
          </ul>
        </div>
        <div class="col">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../index.html'>User documentation</a></li>
              <li class="breadcrumb-item active" aria-current="page">Using yaeos</li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
      <div class="col-3">
        <div class="card card-body bg-light" id="sidebar-toc">
          <ul class="nav flex-column align-items">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">User documentation</a>
            </li>
          </ul>
          <hr>
          <nav class="nav nav-pills flex-column">
              <a class="nav-link active disabled" href="index.html">Using yaeos</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="eos/index.html">Equations of State</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="eos/cubics/index.html">Cubics</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="eos/cubics/alpha.html">Alpha functions</a>
              <a class="nav-link" href="eos/cubics/mixing.html">Mixing Rules</a>

                </nav>

                </nav>
              <a class="nav-link" href="excessmodels/index.html">Gibbs Excess Models</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="excessmodels/nrtl.html">NRTL</a>
              <a class="nav-link" href="excessmodels/unifaclv.html">UNIFAC-LV</a>

                </nav>
              <a class="nav-link" href="phase_equilibrium/index.html">Phase Equilibrium</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="phase_equilibrium/envelopes.html">Phase envelopes</a>
              <a class="nav-link" href="phase_equilibrium/flash.html">Flash calculations</a>
              <a class="nav-link" href="phase_equilibrium/saturation_points.html">Saturation Points</a>

                </nav>
              <a class="nav-link" href="newmodels/index.html">Adding your own models</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="newmodels/analtical.html">Analytical derivatives</a>
              <a class="nav-link" href="newmodels/autodiff.html">Automatic differentiation</a>

                </nav>

                </nav>
              <a class="nav-link" href="../contributing/index.html">Contributing</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="../contributing/styleguide.html">Style guide</a>

                </nav>
              <a class="nav-link" href="../python-api/index.html">Python-API</a>
          </nav>
        </div>
      </div>

    <div class="col-9" id='text'>
      <div class="toc">
<ul>
<li><a href="#getting-started">Getting started</a><ul>
<li><a href="#fortran">Fortran</a></li>
<li><a href="#getting-yaeos">Getting yaeos</a></li>
</ul>
</li>
<li><a href="#setting-up-a-model">Setting up a model</a></li>
<li><a href="#calculating-thermodynamic-properties">Calculating thermodynamic properties</a></li>
<li><a href="#phase-equilibria">Phase equilibria</a></li>
</ul>
</div>
<h1 id="getting-started">Getting started</h1>
<h2 id="fortran">Fortran</h2>
<p>Maybe you&rsquo;ve heard of Fortran as that old and cryptic language that everyone is
afraid of. Well, not anymore! Fortran is really easy to understand and has been
updated a lot in the recent decades. There is a fairly direct guide on the
<a href="https://fortran-lang.org/learn/">fortran-lang site</a></p>
<h2 id="getting-yaeos">Getting yaeos</h2>
<p><code>yaeos</code>is a Fortran library intended to be used as a
<a href="fpm.fortran-lang.org"><code>fpm</code></a> package, <code>fpm</code> can be easily easily obtained with
the Python package manager <code>pip</code> with a simple:</p>
<div class="codehilite"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>--user<span class="w"> </span>fpm
</code></pre></div>

<p>With <code>fpm</code> installed you can create a new Fortran project by running:</p>
<div class="codehilite"><pre><span></span><code>fpm<span class="w"> </span>new<span class="w"> </span>your_project_name
</code></pre></div>

<p>A new directory with the name of your project will be created. </p>
<p>You include <code>yaeos</code> in your  <code>fpm</code> project by adding it as a dependency on your
<code>fpm.toml</code> file by adding this:</p>
<div class="codehilite"><pre><span></span><code><span class="k">[dependencies]</span>
<span class="n">stdlib</span><span class="o">=</span><span class="s2">&quot;*&quot;</span>
<span class="n">yaeos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">git</span><span class="p">=</span><span class="s2">&quot;https://github.com/ipqa-research/yaeos&quot;</span><span class="p">}</span>
</code></pre></div>

<p>Or maybe you want a specific version:</p>
<div class="codehilite"><pre><span></span><code><span class="k">[dependencies]</span>
<span class="n">stdlib</span><span class="o">=</span><span class="s2">&quot;*&quot;</span>
<span class="n">yaeos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">git</span><span class="p">=</span><span class="s2">&quot;https://github.com/ipqa-research/yaeos&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">=</span><span class="s2">&quot;0.1.0b2&quot;</span><span class="p">}</span>
</code></pre></div>

<h1 id="setting-up-a-model">Setting up a model</h1>
<p>On <code>yaeos</code> there is a series of models implemented, right now we include
Residual Helmholtz energy models (like Cubic Equations of State), but plan on
extening to a broader variety.</p>
<p>In this example we&rsquo;ll show how a model in <code>yaeos</code> can be used. We&rsquo;ll take
the <code>Peng-Robinson</code> equation of state as an example, but all the implemented
models can be seen at <a href="../../module/yaeos__models.html">yaeos__models</a>. Inside
your <code>app/main.f90</code> file use</p>
<div class="codehilite"><pre><span></span><code><span class="k">program </span><span class="n">main</span>
<span class="w">    </span><span class="k">use </span><span class="n">yaeos</span>

<span class="w">    </span><span class="c">! Set the variable `model` as a generic `ArModel`</span>
<span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">ArModel</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">model</span>

<span class="w">    </span><span class="c">! Set the the variables that we&#39;re going to use</span>
<span class="w">    </span><span class="c">! as variable lenght arrays</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">pr</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="p">(:),</span><span class="w"> </span><span class="n">tc</span><span class="p">(:),</span><span class="w"> </span><span class="n">pc</span><span class="p">(:),</span><span class="w"> </span><span class="n">w</span><span class="p">(:)</span>

<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">]</span><span class="w">    </span><span class="c">! Number of moles of each component</span>
<span class="w">    </span><span class="n">tc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">190</span><span class="p">,</span><span class="w"> </span><span class="mi">310</span><span class="p">]</span><span class="w">   </span><span class="c">! Critical temperatures</span>
<span class="w">    </span><span class="n">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">]</span><span class="w">     </span><span class="c">! Critical pressures</span>
<span class="w">    </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03</span><span class="p">]</span><span class="w"> </span><span class="c">! Acentric factors</span>

<span class="w">    </span><span class="c">! Now we set our model as the PengRobinson76</span>
<span class="w">    </span><span class="c">! Equation of state.</span>
<span class="w">    </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PengRobinson76</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="w"> </span><span class="n">pc</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span>

<span class="k">end program</span>
</code></pre></div>

<p>And then it&rsquo;s all set, now we&rsquo;ve set the <code>model</code> variable to use in our
calculations</p>
<h1 id="calculating-thermodynamic-properties">Calculating thermodynamic properties</h1>
<p>Some thermodynamic properties can be calculated with <code>yaeos</code> models, and we&rsquo;re
adding more! In this example we&rsquo;ll calculate a PV isotherm from our previously
defined model. For the sake of simplicity all the next code blocks are assumed
to be extensions of the previous one, before the <code>end program</code> sentence.</p>
<div class="codehilite"><pre><span></span><code><span class="n">pv_isotherm</span><span class="p">:</span><span class="w"> </span><span class="k">block</span>
<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">pr</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w">   </span><span class="c">! Thermodynamic variables</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">pr</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">v0</span><span class="p">,</span><span class="w"> </span><span class="n">vf</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="w"> </span><span class="c">! End and start volumes</span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">n_points</span><span class="w"> </span><span class="c">! iteration variable and how many points to calc</span>

<span class="w">    </span><span class="n">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.001</span>
<span class="w">    </span><span class="n">vf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="n">dv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">vf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">v0</span><span class="p">)</span><span class="o">/</span><span class="n">n_points</span>

<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_points</span>
<span class="w">        </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="o">*</span><span class="n">dv</span><span class="w">  </span><span class="c">! Set new volume point</span>

<span class="w">        </span><span class="k">call </span><span class="n">pressure</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="c">! Calculate pressure</span>

<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">p</span>
<span class="w">    </span><span class="k">end do</span>
<span class="k">end block </span><span class="n">pv_isotherm</span>
</code></pre></div>

<p>Also some useful derivatives are available when calculating each property, they
can be easily accessed as optional arguments of the routine. For example, to 
obtain the derivative of pressure with respect to volume the line that
calculates pressure should be changed to:</p>
<div class="codehilite"><pre><span></span><code><span class="k">call </span><span class="n">pressure</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dpdv</span><span class="o">=</span><span class="n">dpdv</span><span class="p">)</span><span class="w"> </span><span class="c">! Calculate pressure and dPdV</span>
</code></pre></div>

<p>The available thermodynamic properties to calculate can be seen at the
<a>yaeos__thermoprops</a> module.</p>
<h1 id="phase-equilibria">Phase equilibria</h1>
    </div>
  </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              yaeos
 was developed by Federico Benelli<br>              &copy; 2024 MPL
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-09-09 12:31              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../../tipuesearch/tipuesearch_content.js"></script>
          <script src="../../tipuesearch/tipuesearch_set.js"></script>
          <script src="../../tipuesearch/tipuesearch.js"></script>

  </body>
</html>