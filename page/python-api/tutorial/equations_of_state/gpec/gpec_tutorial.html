

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Binary Systems Diagrams &mdash; yaeos 4.3.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=a17b270f"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Fitting Equations of State" href="../fitting/fitting.html" />
    <link rel="prev" title="GPEC (Global Phase Equilibrium Calculations)" href="gpec.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            yaeos
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorial_tree.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../equations_of_state.html">Equations of State (EoS)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../bulk_properties.html">Bulk Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cubic_eos/cubic_eos.html">Cubic Equations of State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multifluid_eos/multifluid_eos.html">Multifluid Equations of State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../phase_equilibrium/phase_equilibrium.html">Phase Equilibrium Calculations</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="gpec.html">GPEC (Global Phase Equilibrium Calculations)</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Binary Systems Diagrams</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../fitting/fitting.html">Fitting Equations of State</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../gibbs_excess/gibbs_excess.html">Excess Gibbs models</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../core.html">Core Module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../models/init.html">Models</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../envelopes.html">Envelopes Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fitting.html">Fitting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">yaeos</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../tutorial_tree.html">Tutorial</a></li>
          <li class="breadcrumb-item"><a href="../equations_of_state.html">Equations of State (EoS)</a></li>
          <li class="breadcrumb-item"><a href="gpec.html">GPEC (Global Phase Equilibrium Calculations)</a></li>
      <li class="breadcrumb-item active">Binary Systems Diagrams</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/tutorial/equations_of_state/gpec/gpec_tutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Binary-Systems-Diagrams">
<h1>Binary Systems Diagrams<a class="headerlink" href="#Binary-Systems-Diagrams" title="Link to this heading"></a></h1>
<p>Phase diagrams of binary mixtures are extremely important to understand the phase behaviour of mixtures, make predictions and evaluate models.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">yaeos</span></code> the <code class="docutils literal notranslate"><span class="pre">GPEC</span></code> algorithm has been partially implemented. This algorithm allows the efficient calculation of phase diagrams for binary mixtures.</p>
<blockquote>
<div><p>Warning: This implementation is still a working in progress and due to several changes in the future. Revisions and opinions are also welcomed!</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaeos</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<section id="Global-Phase-Equilibria-Diagram-(GPED)">
<h2>Global Phase Equilibria Diagram (GPED)<a class="headerlink" href="#Global-Phase-Equilibria-Diagram-(GPED)" title="Link to this heading"></a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">yaeos</span></code> the <span class="math notranslate nohighlight">\(GPED\)</span> of a binary mixture is easy to generate. First, we define the model (EoS) that we want to use. Once the model is defined we use the object <code class="docutils literal notranslate"><span class="pre">GPEC</span></code> that receives as argument the defined model.</p>
<p>First we define the mixture that we are going to study, we will use the binary mixture of <span class="math notranslate nohighlight">\(CO_2\)</span> and <span class="math notranslate nohighlight">\(nC_4\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pure compounds properties</span>
<span class="n">Tc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">304.2</span><span class="p">,</span> <span class="mf">425.1</span><span class="p">])</span>      <span class="c1"># critical temperature of CO2 and n-butane [K]</span>
<span class="n">Pc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">73.8</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">])</span>        <span class="c1"># critical pressure of CO2 and n-butane [bar]</span>
<span class="n">w</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2236</span><span class="p">,</span> <span class="mf">0.200164</span><span class="p">])</span>  <span class="c1"># acentric factor of CO2 and n-butane [-]</span>
</pre></div>
</div>
</div>
<p>Once we have defined our system, we define the model to use. For this case we will use the PengRobinson78 Equation of State, with the classical quadratic mixing rules using a constant <span class="math notranslate nohighlight">\(k_{ij}=0.1\)</span> and <span class="math notranslate nohighlight">\(l_{ij}=0\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>       <span class="c1"># binary interaction parameter matrix</span>
<span class="n">kij</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kij</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># CO2-n-butane</span>


<span class="n">mixrule</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">QMR</span><span class="p">(</span><span class="n">kij</span><span class="o">=</span><span class="n">kij</span><span class="p">,</span> <span class="n">lij</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">kij</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">PengRobinson78</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">mixrule</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Once we have everything defined. We just instantiate a <code class="docutils literal notranslate"><span class="pre">GPEC</span></code> object like follows.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpec</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">GPEC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Plotting-diagrams">
<h3>Plotting diagrams<a class="headerlink" href="#Plotting-diagrams" title="Link to this heading"></a></h3>
<p>We can now plot the different kind of phase diagrams calculated for a binary mixture. Starting with the global phase equilibrium diagram, we use the method <code class="docutils literal notranslate"><span class="pre">plot_gped</span></code>.</p>
<p>Here we can see how to do it, and the resulting diagram, where it is possible to see the vapor pressure lines for each pure component and two critical lines. One corresponding to the LV equilibrium line, that goes from one pure component critical point to the other and a LL equilibrium line. This second line starts from high pressure and ends at a lower critical end point.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpec</span><span class="o">.</span><span class="n">plot_gped</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorial_equations_of_state_gpec_gpec_tutorial_10_0.png" src="../../../_images/tutorial_equations_of_state_gpec_gpec_tutorial_10_0.png" />
</div>
</div>
</section>
<section id="Plotting-isotherms-(Pxy-diagrams)">
<h3>Plotting isotherms (Pxy diagrams)<a class="headerlink" href="#Plotting-isotherms-(Pxy-diagrams)" title="Link to this heading"></a></h3>
<p>It is also possible to calculate <span class="math notranslate nohighlight">\(Pxy\)</span> diagrams, just specifying the temperature. This is done with the <code class="docutils literal notranslate"><span class="pre">plot_pxy</span></code> method, which plots the phase diagram and outputs the calculated values too.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpec</span><span class="o">.</span><span class="n">plot_pxy</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">350</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 1.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorial_equations_of_state_gpec_gpec_tutorial_12_1.png" src="../../../_images/tutorial_equations_of_state_gpec_gpec_tutorial_12_1.png" />
</div>
</div>
</section>
<section id="Pxy-regions-with-LL-equilibria">
<h3>Pxy regions with LL equilibria<a class="headerlink" href="#Pxy-regions-with-LL-equilibria" title="Link to this heading"></a></h3>
<p>The GPEC algorithm will detect if the Liquid-Liquid critical line exists at the specified temperature and will calculate the corresponding LL region.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpec</span><span class="o">.</span><span class="n">plot_pxy</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">210</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;L + G&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;L + L&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">3000</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">3000</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorial_equations_of_state_gpec_gpec_tutorial_14_0.png" src="../../../_images/tutorial_equations_of_state_gpec_gpec_tutorial_14_0.png" />
</div>
</div>
</section>
<section id="Plot-isobaric-(Txy)-diagrams">
<h3>Plot isobaric (Txy) diagrams<a class="headerlink" href="#Plot-isobaric-(Txy)-diagrams" title="Link to this heading"></a></h3>
<p>It is also possible to calculate isobaric diagrams. This is done in a similar way that isothermic ones, but in this case we use the <code class="docutils literal notranslate"><span class="pre">plot_txy</span></code> method. This method receives the specified pressure for this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpec</span><span class="o">.</span><span class="n">plot_txy</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorial_equations_of_state_gpec_gpec_tutorial_16_0.png" src="../../../_images/tutorial_equations_of_state_gpec_gpec_tutorial_16_0.png" />
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gpec.html" class="btn btn-neutral float-left" title="GPEC (Global Phase Equilibrium Calculations)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../fitting/fitting.html" class="btn btn-neutral float-right" title="Fitting Equations of State" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Federico E. Benelli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>