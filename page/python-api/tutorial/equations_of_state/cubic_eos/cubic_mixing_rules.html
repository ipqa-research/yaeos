

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mixing Rules &mdash; yaeos 4.3.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=a17b270f"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Multifluid Equations of State" href="../multifluid_eos/multifluid_eos.html" />
    <link rel="prev" title="Generic Cubic Equation of State" href="cubic_models.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            yaeos
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorial_tree.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../equations_of_state.html">Equations of State (EoS)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../bulk_properties.html">Bulk Properties</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="cubic_eos.html">Cubic Equations of State</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="cubic_models.html">Generic Cubic Equation of State</a></li>
<li class="toctree-l4"><a class="reference internal" href="cubic_models.html#Peng-Robinson-(1976)">Peng-Robinson (1976)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cubic_models.html#Peng-Robinson-(1978)">Peng-Robinson (1978)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cubic_models.html#Soave-Redlich-Kwong">Soave-Redlich-Kwong</a></li>
<li class="toctree-l4"><a class="reference internal" href="cubic_models.html#RKPR">RKPR</a></li>
<li class="toctree-l4"><a class="reference internal" href="cubic_models.html#Predictive-Soave-Redlich-Kwong-(PSRK)">Predictive Soave-Redlich-Kwong (PSRK)</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Mixing Rules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../multifluid_eos/multifluid_eos.html">Multifluid Equations of State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../phase_equilibrium/phase_equilibrium.html">Phase Equilibrium Calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpec/gpec.html">GPEC (Global Phase Equilibrium Calculations)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fitting/fitting.html">Fitting Equations of State</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../gibbs_excess/gibbs_excess.html">Excess Gibbs models</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../core.html">Core Module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../models/init.html">Models</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../envelopes.html">Envelopes Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fitting.html">Fitting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">yaeos</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../tutorial_tree.html">Tutorial</a></li>
          <li class="breadcrumb-item"><a href="../equations_of_state.html">Equations of State (EoS)</a></li>
          <li class="breadcrumb-item"><a href="cubic_eos.html">Cubic Equations of State</a></li>
      <li class="breadcrumb-item active">Mixing Rules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/tutorial/equations_of_state/cubic_eos/cubic_mixing_rules.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Mixing-Rules">
<h1>Mixing Rules<a class="headerlink" href="#Mixing-Rules" title="Link to this heading"></a></h1>
<p>There is one more thing to show of the Python API that <code class="docutils literal notranslate"><span class="pre">yaeos</span></code> supports. At this point of the tutorial we have been using cubic equations of state to perform different calculations. The experience users may have noticed that we never set any interaction parameters for the cubic equations of state.</p>
<p><code class="docutils literal notranslate"><span class="pre">yaeos</span></code> support the following mixing rules for cubic equations of state:</p>
<ul class="simple">
<li><p>QMR: quadratic mixing rule</p></li>
<li><p>QMRTD: QMR with temperature dependance of <span class="math notranslate nohighlight">\(k_{ij}\)</span></p></li>
<li><p>MHV: modified Huron-Vidal mixing rule</p></li>
<li><p>HV: Huron-Vidal mixing rule</p></li>
<li><p>HVNRTL: Huron-Vidal mixing rule coupled with their NRTL model</p></li>
</ul>
<p>You can check the available mixing rules by running the following command:</p>
<section id="Quadratic-mixing-rule-(QMR)">
<h2>Quadratic mixing rule (QMR)<a class="headerlink" href="#Quadratic-mixing-rule-(QMR)" title="Link to this heading"></a></h2>
<div class="math notranslate nohighlight">
\[nB = \sum_i \sum_j n_i n_j \frac{b_i + b_j}{2} (1 - l_{ij})\]</div>
<div class="math notranslate nohighlight">
\[D = \sum_i \sum_j n_i n_j a_{ij}\]</div>
<p>With:</p>
<div class="math notranslate nohighlight">
\[a_{ij} = \sqrt{a_i \, a_j} (1 - k_{i,j})\]</div>
<p>The QMR is the default mixing rule for almost all cubic equations of state. But it is always set with all the interaction parameters equals to zero by default.</p>
<p>To set the <span class="math notranslate nohighlight">\(k_{ij}\)</span> and <span class="math notranslate nohighlight">\(l_{ij}\)</span> interaction matrix you can do the following:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaeos</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">tcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">190.6</span><span class="p">,</span> <span class="mf">369.8</span><span class="p">])</span>  <span class="c1"># critical temperatures [K]</span>
<span class="n">pcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">45.99</span><span class="p">,</span> <span class="mf">42.48</span><span class="p">])</span>  <span class="c1"># critical pressures [bar]</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0115</span><span class="p">,</span> <span class="mf">0.0866</span><span class="p">])</span>  <span class="c1"># acentric factors [-]</span>

<span class="c1"># binary interaction parameters</span>
<span class="n">kij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
<span class="n">lij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>

<span class="c1"># Set QMR</span>
<span class="n">mixing_rule</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">QMR</span><span class="p">(</span><span class="n">kij</span><span class="o">=</span><span class="n">kij</span><span class="p">,</span> <span class="n">lij</span><span class="o">=</span><span class="n">lij</span><span class="p">)</span>

<span class="c1"># Set a model with the QMR with parameters</span>
<span class="n">model_kij</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">PengRobinson76</span><span class="p">(</span>
    <span class="n">critical_temperatures</span><span class="o">=</span><span class="n">tcs</span><span class="p">,</span>
    <span class="n">critical_pressures</span><span class="o">=</span><span class="n">pcs</span><span class="p">,</span>
    <span class="n">acentric_factors</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
    <span class="n">mixrule</span><span class="o">=</span><span class="n">mixing_rule</span><span class="p">,</span> <span class="c1"># &lt;- here comes the mixing rule</span>
<span class="p">)</span>

<span class="c1"># Set model without QMR (QMR with all kij and lij as zero)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">PengRobinson76</span><span class="p">(</span><span class="n">tcs</span><span class="p">,</span> <span class="n">pcs</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>There we have instantiated a <code class="docutils literal notranslate"><span class="pre">PengRobinson76</span></code> with the QMR mixing rule with fantasy interaction parameters. And then we instantiated a <code class="docutils literal notranslate"><span class="pre">PengRobinson76</span></code> with no interaction parameters as we have been doing in previous sections.</p>
<p>With the model with interaction parameters we can calculate the same things that we have been calculating at this tutorial. But to show that there is a difference, we can calculate a phase envelope and see what happens.</p>
<p>A liquid-vapor phase envelope (PT) show us all the dew and bubble points of a mixture at fixed composition <span class="math notranslate nohighlight">\(z\)</span>. In the section “Phase Equilibrium Calculations” we will learn more about this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Composition of the mixture</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="c1"># Initial guesses for the envelope (not too important right now)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">150.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Envelope with the model with kij and lij</span>
<span class="n">envelope_kij</span> <span class="o">=</span> <span class="n">model_kij</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;dew&quot;</span><span class="p">)</span>

<span class="c1"># Envelope with the model without kij and lij</span>
<span class="n">envelope</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">max_points</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;dew&quot;</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">envelope_kij</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;With kij and lij&quot;</span><span class="p">)</span>
<span class="n">envelope</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Without kij and lij&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature [K]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pressure [bar]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_4_0.png" src="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_4_0.png" />
</div>
</div>
<p>The QMR mix rule can be used with any cubic equation of state that <code class="docutils literal notranslate"><span class="pre">yaeos</span></code> supports.</p>
</section>
<section id="QMRTD:-QMR-with-temperature-dependence-of-k_{ij}">
<h2>QMRTD: QMR with temperature dependence of <span class="math notranslate nohighlight">\(k_{ij}\)</span><a class="headerlink" href="#QMRTD:-QMR-with-temperature-dependence-of-k_{ij}" title="Link to this heading"></a></h2>
<p>It is possible also to give some dependence of temperature to the <span class="math notranslate nohighlight">\(k_{ij}\)</span> values, corresponding to the equations:</p>
<div class="math notranslate nohighlight">
\[nB = \sum_i \sum_j n_i n_j \frac{b_i + b_j}{2} (1 - l_{ij})\]</div>
<div class="math notranslate nohighlight">
\[D = \sum_i \sum_j n_i n_j a_{ij}\]</div>
<p>With:</p>
<div class="math notranslate nohighlight">
\[a_{ij} = \sqrt{a_i \, a_j} (1 - k_{i,j})\]</div>
<div class="math notranslate nohighlight">
\[k_{ij}(T) = k_{ij}^{\infty} + k_{ij}^{0} \exp{\left(-T/T^{ref}\right)}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaeos</span>


<span class="n">tcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">190.6</span><span class="p">,</span> <span class="mf">369.8</span><span class="p">])</span>  <span class="c1"># critical temperatures [K]</span>
<span class="n">pcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">45.99</span><span class="p">,</span> <span class="mf">42.48</span><span class="p">])</span>  <span class="c1"># critical pressures [bar]</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0115</span><span class="p">,</span> <span class="mf">0.0866</span><span class="p">])</span>  <span class="c1"># acentric factors [-]</span>

<span class="c1"># Binary interaction parameters:</span>
<span class="c1">## Strong repulsions at low temperatures</span>
<span class="n">kij_0</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]</span>

<span class="c1">## &quot;attraction&quot; at high temperatures</span>
<span class="n">kij_inf</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]</span>

<span class="n">Tref</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">350</span><span class="p">],</span> <span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]</span>

<span class="n">lij</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]</span>

<span class="c1"># Quadratic mixing rule instance</span>
<span class="n">mixrule</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">QMRTD</span><span class="p">(</span><span class="n">kij_0</span><span class="p">,</span> <span class="n">kij_inf</span><span class="p">,</span> <span class="n">Tref</span><span class="p">,</span> <span class="n">lij</span><span class="p">)</span>

<span class="n">model_kij_tdep</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">PengRobinson76</span><span class="p">(</span>
    <span class="n">critical_temperatures</span><span class="o">=</span><span class="n">tcs</span><span class="p">,</span>
    <span class="n">critical_pressures</span><span class="o">=</span><span class="n">pcs</span><span class="p">,</span>
    <span class="n">acentric_factors</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
    <span class="n">mixrule</span><span class="o">=</span><span class="n">mixrule</span><span class="p">,</span> <span class="c1"># &lt;- here comes the mixing rule</span>
<span class="p">)</span>

<span class="n">model_kij_tdep</span><span class="o">.</span><span class="n">pressure</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
6.959049536037986
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">150.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Envelope with the model with kij and lij</span>
<span class="n">envelope_kij_tdep</span> <span class="o">=</span> <span class="n">model_kij_tdep</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;dew&quot;</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">envelope_kij_tdep</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;With kij(T) and lij (QMRTD)&quot;</span><span class="p">)</span>
<span class="n">envelope_kij</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;With kij and lij (QMR)&quot;</span><span class="p">)</span>
<span class="n">envelope</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Without kij and lij&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">350</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature [K]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pressure [bar]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Pressure [bar]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_8_1.png" src="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_8_1.png" />
</div>
</div>
</section>
<section id="Huron-Vidal-mixing-rule">
<h2>Huron-Vidal mixing rule<a class="headerlink" href="#Huron-Vidal-mixing-rule" title="Link to this heading"></a></h2>
<p>The Huron-Vidal mixing rule allows linking a Cubic Equation of State with an Excess Gibbs model, this can be helpful to predict behaviour of systems with high asymmetry in polarity.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaeos</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">tcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">190.6</span><span class="p">,</span> <span class="mf">369.8</span><span class="p">])</span>  <span class="c1"># critical temperatures [K]</span>
<span class="n">pcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">45.99</span><span class="p">,</span> <span class="mf">42.48</span><span class="p">])</span>  <span class="c1"># critical pressures [bar]</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0115</span><span class="p">,</span> <span class="mf">0.0866</span><span class="p">])</span>  <span class="c1"># acentric factors [-]</span>

<span class="c1"># binary interaction parameters for NRTL model</span>
<span class="n">aij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>

<span class="n">bij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>

<span class="n">cij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>

<span class="n">nrtl</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">NRTL</span><span class="p">(</span><span class="n">aij</span><span class="p">,</span> <span class="n">bij</span><span class="p">,</span> <span class="n">cij</span><span class="p">)</span>

<span class="n">mixing_rule</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">HV</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="n">nrtl</span><span class="p">)</span>

<span class="c1"># Set a model with the MHV with parameters</span>
<span class="n">model_hv_nrtl</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">PengRobinson76</span><span class="p">(</span>
    <span class="n">critical_temperatures</span><span class="o">=</span><span class="n">tcs</span><span class="p">,</span>
    <span class="n">critical_pressures</span><span class="o">=</span><span class="n">pcs</span><span class="p">,</span>
    <span class="n">acentric_factors</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
    <span class="n">mixrule</span><span class="o">=</span><span class="n">mixing_rule</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Modified-Huron-Vidal-mixing-rule-(MHV)">
<h2>Modified Huron-Vidal mixing rule (MHV)<a class="headerlink" href="#Modified-Huron-Vidal-mixing-rule-(MHV)" title="Link to this heading"></a></h2>
<p>The other mixing rule that <code class="docutils literal notranslate"><span class="pre">yaeos</span></code> supports is the MHV mixing rule. To use it we need to instantiate an Excess Gibbs free energy model and pass it to the MHV mixing rule. Any of the supported Excess Gibbs models could be supplied.</p>
<div class="math notranslate nohighlight">
\[nB = \sum_i \sum_j n_i n_j \frac{b_i + b_j}{2} (1 - l_{ij})\]</div>
<div class="math notranslate nohighlight">
\[\frac{D}{RTB} = \sum_i n_i \frac{a_i(T)}{b_i} + \frac{1}{q}
\left(\frac{G^E(n, T)}{RT} + \sum_i n_i \ln \frac{B}{nb_i} \right)\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaeos</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="c1"># binary interaction parameters for NRTL model</span>
<span class="n">aij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>

<span class="n">bij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>

<span class="n">cij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>

<span class="c1"># Set an NRTl model</span>
<span class="n">nrtl</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">NRTL</span><span class="p">(</span><span class="n">aij</span><span class="p">,</span> <span class="n">bij</span><span class="p">,</span> <span class="n">cij</span><span class="p">)</span>

<span class="c1"># Mixing rule instance</span>
<span class="n">mixing_rule</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">MHV</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="n">nrtl</span><span class="p">,</span> <span class="n">q</span><span class="o">=-</span><span class="mf">0.53</span><span class="p">)</span>

<span class="c1"># Set a model with the MHV with parameters</span>
<span class="n">model_mhv_nrtl</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">PengRobinson76</span><span class="p">(</span>
    <span class="n">critical_temperatures</span><span class="o">=</span><span class="n">tcs</span><span class="p">,</span>
    <span class="n">critical_pressures</span><span class="o">=</span><span class="n">pcs</span><span class="p">,</span>
    <span class="n">acentric_factors</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
    <span class="n">mixrule</span><span class="o">=</span><span class="n">mixing_rule</span><span class="p">,</span> <span class="c1"># &lt;- mixing rule</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s make first an envelope to see the difference and then explain what is happening.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">150.0</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Envelope with the model with HV and NRTL</span>
<span class="n">envelope_mhv_nrtl</span> <span class="o">=</span> <span class="n">model_mhv_nrtl</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span>
    <span class="n">z</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">max_points</span><span class="o">=</span><span class="mi">5000</span>
<span class="p">)</span>

<span class="c1"># Envelope with the model with MHV and NRTL</span>
<span class="n">envelope_hv_nrtl</span> <span class="o">=</span> <span class="n">model_hv_nrtl</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span>
    <span class="n">z</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">max_points</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">envelope_hv_nrtl</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span> <span class="n">envelope_hv_nrtl</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;HV-NRTL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">envelope_mhv_nrtl</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span> <span class="n">envelope_mhv_nrtl</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MHV-NRTL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span> <span class="n">envelope</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Without kij and lij&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature [K]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pressure [bar]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">350</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 150.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_14_1.png" src="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_14_1.png" />
</div>
</div>
<p>We have instantiated a <code class="docutils literal notranslate"><span class="pre">NRTL</span></code> model with some interaction parameters and then instantiated a <code class="docutils literal notranslate"><span class="pre">MHV</span></code> mixing rule with the <code class="docutils literal notranslate"><span class="pre">NRTL</span></code> model. The <code class="docutils literal notranslate"><span class="pre">q</span></code> value of the <code class="docutils literal notranslate"><span class="pre">MHV</span></code> mixing rule is taken from bibliography. The value to use are:</p>
<ul class="simple">
<li><p>q = -0.594 for Soave-Redlich-Kwong</p></li>
<li><p>q = -0.53 for Peng-Robinson</p></li>
<li><p>q = -0.85 for Van der Waals</p></li>
</ul>
</section>
<section id="Huron-Vidal-Coupled-with-NRTL-Mixing-Rule">
<h2>Huron-Vidal Coupled with NRTL Mixing Rule<a class="headerlink" href="#Huron-Vidal-Coupled-with-NRTL-Mixing-Rule" title="Link to this heading"></a></h2>
<p>Huron and Vidal presented their mixing rule with a modified <span class="math notranslate nohighlight">\(NRTL\)</span> model. This model includes the covolume parameter <span class="math notranslate nohighlight">\(b\)</span> from the cubic EoS. This modification has the characteristic that it can be simplified and use the classic QMR mixing rules for specific binaries in the mixture.</p>
<p>First we will define a model that uses the <span class="math notranslate nohighlight">\(QMR\)</span> mixing rule</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaeos</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="c1"># Methane, butane, CO2</span>
<span class="n">Tc</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">190.564</span><span class="p">,</span> <span class="mf">425.12</span><span class="p">,</span> <span class="mf">304.21</span><span class="p">]</span>
<span class="n">Pc</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">45.99</span><span class="p">,</span> <span class="mf">37.96</span><span class="p">,</span> <span class="mf">73.83</span><span class="p">]</span>
<span class="n">w</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.0115478</span><span class="p">,</span> <span class="mf">0.200164</span><span class="p">,</span> <span class="mf">0.223621</span><span class="p">]</span>

<span class="c1"># binary interaction parameters</span>
<span class="n">kij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
     <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
     <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
     <span class="p">])</span>

<span class="c1"># Set QMR</span>
<span class="n">mixing_rule</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">QMR</span><span class="p">(</span><span class="n">kij</span><span class="o">=</span><span class="n">kij</span><span class="p">,</span> <span class="n">lij</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">kij</span><span class="p">)</span>

<span class="c1"># Set a model with the QMR with parameters</span>
<span class="n">model_kij</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">PengRobinson76</span><span class="p">(</span>
    <span class="n">critical_temperatures</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span>
    <span class="n">critical_pressures</span><span class="o">=</span><span class="n">Pc</span><span class="p">,</span>
    <span class="n">acentric_factors</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
    <span class="n">mixrule</span><span class="o">=</span><span class="n">mixing_rule</span><span class="p">,</span> <span class="c1"># &lt;- mixing rule</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we will define a model using the <span class="math notranslate nohighlight">\(NRTLHV\)</span> mixing rule</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">gji</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">22.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Where to use kij values</span>
<span class="n">use_kij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># While we must provide a kij matrix, it will not be used since all the use_kij</span>
<span class="c1"># matrix is set to False</span>
<span class="n">mixrule</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">HVNRTL</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">gji</span><span class="o">=</span><span class="n">gji</span><span class="p">,</span> <span class="n">use_kij</span><span class="o">=</span><span class="n">use_kij</span><span class="p">,</span> <span class="n">kij</span><span class="o">=</span><span class="n">kij</span><span class="p">)</span>

<span class="n">model_hvnrtl</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">PengRobinson76</span><span class="p">(</span>
    <span class="n">critical_temperatures</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span>
    <span class="n">critical_pressures</span><span class="o">=</span><span class="n">Pc</span><span class="p">,</span>
    <span class="n">acentric_factors</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
    <span class="n">mixrule</span><span class="o">=</span><span class="n">mixrule</span><span class="p">,</span> <span class="c1"># &lt;- mixing rule</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>

<span class="n">model_kij</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;QMR&quot;</span><span class="p">)</span>
<span class="n">model_hvnrtl</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;HVNRTL&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f20be712870&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_21_1.png" src="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_21_1.png" />
</div>
</div>
<p>Now let’s modify the <code class="docutils literal notranslate"><span class="pre">use_kij</span></code> matrix, to use the kij values between methane and butane.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">use_kij</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">use_kij</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">mixrule</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">HVNRTL</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">gji</span><span class="o">=</span><span class="n">gji</span><span class="p">,</span> <span class="n">use_kij</span><span class="o">=</span><span class="n">use_kij</span><span class="p">,</span> <span class="n">kij</span><span class="o">=</span><span class="n">kij</span><span class="p">)</span>

<span class="n">model_hvnrtl_2</span> <span class="o">=</span> <span class="n">yaeos</span><span class="o">.</span><span class="n">PengRobinson76</span><span class="p">(</span>
    <span class="n">critical_temperatures</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span>
    <span class="n">critical_pressures</span><span class="o">=</span><span class="n">Pc</span><span class="p">,</span>
    <span class="n">acentric_factors</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
    <span class="n">mixrule</span><span class="o">=</span><span class="n">mixrule</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>When we plot the phase envelopes we can se how using the <span class="math notranslate nohighlight">\(k_{ij}\)</span> values for methane-butane the phase diagram become more similar to the one with the classic <span class="math notranslate nohighlight">\(QMR\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_kij</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;QMR&quot;</span><span class="p">)</span>
<span class="n">model_hvnrtl</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;HVNRTL&quot;</span><span class="p">)</span>
<span class="n">model_hvnrtl_2</span><span class="o">.</span><span class="n">phase_envelope_pt</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;HVNRTL-with-kij&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_25_0.png" src="../../../_images/tutorial_equations_of_state_cubic_eos_cubic_mixing_rules_25_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cubic_models.html" class="btn btn-neutral float-left" title="Generic Cubic Equation of State" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../multifluid_eos/multifluid_eos.html" class="btn btn-neutral float-right" title="Multifluid Equations of State" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Federico E. Benelli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>