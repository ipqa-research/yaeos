!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (develop) - 13 Sep 2023 12:36
!
!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (develop) - 13 Sep 2023 12:36
!
!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (develop) - 13 Sep 2023 12:36
!
!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (develop) - 13 Sep 2023 12:36
!
!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (develop) - 13 Sep 2023 12:36
!
MODULE YAEOS__MODELS_AR_GERG2008
   USE YAEOS__TAPENADE_AR_API, ONLY : armodeltapenade
   USE YAEOS__TAPENADE_INTERFACES
   use yaeos__constants, only: Ryaeos => R !! Ideal gas constants used on yaeos
   use yaeos__models_ar_cubic_implementations, only: SoaveRedlichKwong
   use yaeos__models_ar_genericcubic, only: CubicEoS
   IMPLICIT NONE
   
   TYPE GERG2008PURE
      INTEGER :: kpol
      INTEGER :: kexp
      REAL(pr), ALLOCATABLE :: n(:)
      REAL(pr), ALLOCATABLE :: d(:)
      REAL(pr), ALLOCATABLE :: t(:)
      REAL(pr), ALLOCATABLE :: c(:)
   end type GERG2008PURE


   TYPE GERG2008BINARY
      REAL(pr) :: bv !! Binary volume interaction parameters
      REAL(pr) :: gv !! Binary volume interaction parameters
      REAL(pr) :: bt !! Binary temperature interaction parameters
      REAL(pr) :: gt !! Binary temperature interaction parameters
      INTEGER :: kpolij
      INTEGER :: kexpij
      REAL(pr), ALLOCATABLE :: nij(:)
      REAL(pr), ALLOCATABLE :: dij(:)
      REAL(pr), ALLOCATABLE :: tij(:)
      REAL(pr), ALLOCATABLE :: ethaij(:)
      REAL(pr), ALLOCATABLE :: epsij(:)
      REAL(pr), ALLOCATABLE :: betaij(:)
      REAL(pr), ALLOCATABLE :: gammaij(:)
      REAL(pr) :: fij
   end type GERG2008BINARY

   type, extends(ArModelTapenade) :: Gerg2008
      type(GERG2008PURE), ALLOCATABLE :: pures(:)
      type(GERG2008BINARY), ALLOCATABLE :: binaries(:, :)
      type(CubicEoS) :: srk
   contains
      procedure :: ar
      procedure :: ar_d
      procedure :: ar_b
      procedure :: ar_d_b
      procedure :: ar_d_d
      procedure :: get_v0 => VOLUME_INITALIZER
   end type Gerg2008

CONTAINS
!  Differentiation of reducing_functions_d in reverse (adjoint) mode (with options noISIZE):
!   gradient     of useful results: trd tr nd n vrd vr
!   with respect to varying inputs: nd n
!  Differentiation of reducing_functions in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: tr vr
!   with respect to varying inputs: n
   SUBROUTINE REDUCING_FUNCTIONS_D_B(model, n, nb, nd, ndb, vr, vrb, vrd&
   &   , vrdb, tr, trb, trd, trdb)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:)
      REAL(pr) :: nb(:)
      REAL(pr), INTENT(IN) :: nd(:)
      REAL(pr) :: ndb(:)
      REAL(pr) :: vr
      REAL(pr) :: vrb
      REAL(pr) :: vrd
      REAL(pr) :: vrdb
      REAL(pr) :: tr
      REAL(pr) :: trb
      REAL(pr) :: trd
      REAL(pr) :: trdb
      REAL(pr) :: vc(SIZE(n)), tc(SIZE(n)), x(SIZE(n)), rho_c(SIZE(n))
      REAL(pr) :: xb(SIZE(n))
      REAL(pr) :: xd(SIZE(n))
      REAL(pr) :: xdb(SIZE(n))
      REAL(pr) :: bv(SIZE(n), SIZE(n)), gv(SIZE(n), SIZE(n))
      REAL(pr) :: bt(SIZE(n), SIZE(n)), gt(SIZE(n), SIZE(n))
      INTEGER :: i, j, nc
      INTRINSIC SUM
      INTRINSIC SQRT
      INTRINSIC SIZE
      REAL(pr), DIMENSION(SIZE(n)) :: arg1
      REAL(pr), DIMENSION(SIZE(n)) :: arg1b
      REAL(pr), DIMENSION(SIZE(n)) :: arg1d
      REAL(pr), DIMENSION(SIZE(n)) :: arg1db
      REAL(pr) :: arg10
      REAL(pr) :: result1
      REAL(pr) :: temp
      REAL(pr) :: tempb
      REAL(pr) :: temp0
      REAL(pr) :: temp0b
      REAL(pr) :: temp1
      REAL(pr) :: temp1b
      REAL(pr) :: temp2
      REAL(pr) :: temp2b
      REAL(pr) :: temp3
      REAL(pr) :: temp3b
      REAL(pr), DIMENSION(SIZE(n, 1)) :: tempb0
      REAL(pr), DIMENSION(SIZE(n, 1)) :: temp4
      REAL(pr) :: temp5
      REAL(pr), DIMENSION(SIZE(n, 1)) :: tempb1
      REAL(pr) :: tempb2
      REAL(pr) :: temp6
      REAL(pr) :: tempb3
      REAL(pr) :: temp7
      REAL(pr) :: tempb4
      INTEGER :: ad_from
      REAL(pr) :: result10
      vc = model%components%vc
      tc = model%components%tc
      bv = model%binaries%bv
      gv = model%binaries%gv
      bt = model%binaries%bt
      gt = model%binaries%gt
      rho_c = 1/vc
      temp = SUM(n)
      xd = (nd-n*SUM(nd)/temp)/temp
      x = n/temp
      nc = SIZE(n)
      arg1d(:) = vc*2*n*nd
      arg1(:) = n**2*vc
      arg1d(:) = tc*2*n*nd
      arg1(:) = n**2*tc
      DO i=1,nc
         ad_from = i + 1
         DO j=ad_from,nc
            CALL PUSHREAL8(temp)
            temp = 2*bv(i, j)*gv(i, j)*((rho_c(i)**(-(1.0/3))+rho_c(j)**(-(&
            &         1.0/3)))*(rho_c(i)**(-(1.0/3))+rho_c(j)**(-(1.0/3)))*(rho_c(i)&
            &         **(-(1.0/3))+rho_c(j)**(-(1.0/3))))
            CALL PUSHREAL8(temp3)
            arg10 = tc(i)*tc(j)
            result1 = SQRT(arg10)
            temp3 = 2*bt(i, j)*gt(i, j)*result1
            CALL PUSHREAL8(temp)
         END DO
         CALL PUSHINTEGER4(ad_from)
      END DO
      xdb = 0.0_pr
      xb = 0.0_pr
      DO i=nc,1,-1
         CALL POPINTEGER4(ad_from)
         DO j=nc,ad_from,-1
            temp2 = bt(i, j)*bt(i, j)
            temp1 = temp2*x(i) + x(j)
            temp5 = temp2*xd(i) + xd(j)
            tempb4 = temp3*trdb/temp1
            tempb3 = (x(i)+x(j))*tempb4
            tempb = temp3*trb - temp5*tempb4
            temp0 = x(i)*x(j)
            temp = temp0*(x(i)+x(j))/temp1
            temp6 = x(j)*xd(i) + x(i)*xd(j)
            xb(i) = xb(i) + temp6*tempb4
            xb(j) = xb(j) + temp6*tempb4 + xd(i)*tempb3
            temp0b = (xd(i)+xd(j))*tempb4
            xdb(i) = xdb(i) + temp0*tempb4
            xdb(j) = xdb(j) + temp0*tempb4
            xdb(i) = xdb(i) - temp2*temp*tempb4
            xdb(j) = xdb(j) - temp*tempb4
            temp1b = -(((x(i)+x(j))*temp6+temp0*(xd(i)+xd(j))-temp*temp5)*&
            &         tempb4/temp1)
            xdb(i) = xdb(i) + x(j)*tempb3
            xdb(j) = xdb(j) + x(i)*tempb3
            CALL POPREAL8(temp)
            temp7 = temp0/temp1
            xb(i) = xb(i) + xd(j)*tempb3 + temp7*tempb
            xb(j) = xb(j) + temp7*tempb
            tempb4 = (x(i)+x(j))*tempb/temp1
            temp0b = temp0b + tempb4
            temp1b = temp1b - temp7*tempb4
            xb(i) = xb(i) + x(j)*temp0b
            xb(j) = xb(j) + x(i)*temp0b
            xb(i) = xb(i) + temp2*temp1b
            xb(j) = xb(j) + temp1b
            temp0 = bv(i, j)*bv(i, j)
            temp1 = 8*(temp0*x(i)+x(j))
            temp2 = x(i)*x(j)
            temp3 = temp2*(x(i)+x(j))/temp1
            temp6 = x(j)*xd(i) + x(i)*xd(j)
            temp7 = temp0*xd(i) + xd(j)
            tempb2 = temp*vrdb/temp1
            temp3b = temp*vrb - 8*temp7*tempb2
            xb(i) = xb(i) + temp6*tempb2
            tempb3 = (x(i)+x(j))*tempb2
            xb(j) = xb(j) + temp6*tempb2 + xd(i)*tempb3
            temp2b = (xd(i)+xd(j))*tempb2
            xdb(i) = xdb(i) + temp2*tempb2
            xdb(j) = xdb(j) + temp2*tempb2
            tempb4 = -(8*temp3*tempb2)
            temp1b = -(((x(i)+x(j))*temp6+temp2*(xd(i)+xd(j))-8*temp3*temp7)&
            &         *tempb2/temp1)
            xdb(i) = xdb(i) + temp0*tempb4
            xdb(j) = xdb(j) + tempb4
            xdb(i) = xdb(i) + x(j)*tempb3
            xdb(j) = xdb(j) + x(i)*tempb3
            CALL POPREAL8(temp3)
            temp5 = temp2/temp1
            xb(i) = xb(i) + xd(j)*tempb3 + temp5*temp3b
            xb(j) = xb(j) + temp5*temp3b
            tempb2 = (x(i)+x(j))*temp3b/temp1
            temp2b = temp2b + tempb2
            temp1b = temp1b - temp5*tempb2
            xb(i) = xb(i) + x(j)*temp2b
            xb(j) = xb(j) + x(i)*temp2b
            xb(i) = xb(i) + temp0*8*temp1b
            xb(j) = xb(j) + 8*temp1b
            CALL POPREAL8(temp)
         END DO
      END DO
      temp5 = SUM(nd)
      tempb0 = xdb/temp
      tempb1 = -(temp5*tempb0/temp)
      temp4 = n/temp
      result10 = SUM((nd-temp5*temp4)*tempb0)
      tempb = -(SUM(n*xb)/temp**2) - result10/temp - SUM(temp4*tempb1)
      arg1b = 0.0_pr
      arg1b = trb
      arg1db = 0.0_pr
      arg1db = trdb
      nb = nb + 2*n*tc*arg1b + nd*tc*2*arg1db
      ndb = ndb + n*tc*2*arg1db
      arg1b = 0.0_pr
      arg1b = vrb
      arg1db = 0.0_pr
      arg1db = vrdb
      nb = nb + 2*n*vc*arg1b + nd*vc*2*arg1db + xb/temp + tempb1 + tempb
      ndb = ndb + n*vc*2*arg1db + tempb0 - SUM(temp4*tempb0)
   end subroutine REDUCING_FUNCTIONS_D_B

!  Differentiation of reducing_functions in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: tr vr
!   with respect to varying inputs: n
   SUBROUTINE REDUCING_FUNCTIONS_D(model, n, nd, vr, vrd, tr, trd)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:)
      REAL(pr), INTENT(IN) :: nd(:)
      REAL(pr), INTENT(OUT) :: vr
      REAL(pr), INTENT(OUT) :: vrd
      REAL(pr), INTENT(OUT) :: tr
      REAL(pr), INTENT(OUT) :: trd
      REAL(pr) :: vc(SIZE(n)), tc(SIZE(n)), x(SIZE(n)), rho_c(SIZE(n))
      REAL(pr) :: xd(SIZE(n))
      REAL(pr) :: bv(SIZE(n), SIZE(n)), gv(SIZE(n), SIZE(n))
      REAL(pr) :: bt(SIZE(n), SIZE(n)), gt(SIZE(n), SIZE(n))
      INTEGER :: i, j, nc
      INTRINSIC SUM
      INTRINSIC SQRT
      INTRINSIC SIZE
      REAL(pr), DIMENSION(SIZE(n)) :: arg1
      REAL(pr), DIMENSION(SIZE(n)) :: arg1d
      REAL(pr) :: arg10
      REAL(pr) :: result1
      REAL(pr) :: temp
      REAL(pr) :: temp0
      REAL(pr) :: temp1
      REAL(pr) :: temp2
      REAL(pr) :: temp3
      vc = model%components%vc
      tc = model%components%tc
      bv = model%binaries%bv
      gv = model%binaries%gv
      bt = model%binaries%bt
      gt = model%binaries%gt
      rho_c = 1/vc
      temp = SUM(n)
      xd = (nd-n*SUM(nd)/temp)/temp
      x = n/temp
      nc = SIZE(n)
      arg1d(:) = vc*2*n*nd
      arg1(:) = n**2*vc
      vrd = SUM(arg1d(:))
      vr = SUM(arg1(:))
      arg1d(:) = tc*2*n*nd
      arg1(:) = n**2*tc
      trd = SUM(arg1d(:))
      tr = SUM(arg1(:))
      DO i=1,nc
         DO j=i+1,nc
            temp = 2*bv(i, j)*gv(i, j)*((rho_c(i)**(-(1.0/3))+rho_c(j)**(-(&
            &         1.0/3)))*(rho_c(i)**(-(1.0/3))+rho_c(j)**(-(1.0/3)))*(rho_c(i)&
            &         **(-(1.0/3))+rho_c(j)**(-(1.0/3))))
            temp0 = bv(i, j)*bv(i, j)
            temp1 = 8*(temp0*x(i)+x(j))
            temp2 = x(i)*x(j)
            temp3 = temp2*(x(i)+x(j))/temp1
            vrd = vrd + temp*((x(i)+x(j))*(x(j)*xd(i)+x(i)*xd(j))+temp2*(xd(&
            &         i)+xd(j))-temp3*8*(temp0*xd(i)+xd(j)))/temp1
            vr = vr + temp*temp3
            arg10 = tc(i)*tc(j)
            result1 = SQRT(arg10)
            temp3 = 2*bt(i, j)*gt(i, j)*result1
            temp2 = bt(i, j)*bt(i, j)
            temp1 = temp2*x(i) + x(j)
            temp0 = x(i)*x(j)
            temp = temp0*(x(i)+x(j))/temp1
            trd = trd + temp3*((x(i)+x(j))*(x(j)*xd(i)+x(i)*xd(j))+temp0*(xd&
            &         (i)+xd(j))-temp*(temp2*xd(i)+xd(j)))/temp1
            tr = tr + temp3*temp
         END DO
      END DO
   end subroutine REDUCING_FUNCTIONS_D

!  Differentiation of reducing_functions in reverse (adjoint) mode (with options noISIZE):
!   gradient     of useful results: tr n vr
!   with respect to varying inputs: n
   SUBROUTINE REDUCING_FUNCTIONS_B(model, n, nb, vr, vrb, tr, trb)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:)
      REAL(pr) :: nb(:)
      REAL(pr) :: vr
      REAL(pr) :: vrb
      REAL(pr) :: tr
      REAL(pr) :: trb
      REAL(pr) :: vc(SIZE(n)), tc(SIZE(n)), x(SIZE(n)), rho_c(SIZE(n))
      REAL(pr) :: xb(SIZE(n))
      REAL(pr) :: bv(SIZE(n), SIZE(n)), gv(SIZE(n), SIZE(n))
      REAL(pr) :: bt(SIZE(n), SIZE(n)), gt(SIZE(n), SIZE(n))
      INTEGER :: i, j, nc
      INTRINSIC SUM
      INTRINSIC SQRT
      INTRINSIC SIZE
      REAL(pr), DIMENSION(SIZE(n)) :: arg1
      REAL(pr), DIMENSION(SIZE(n)) :: arg1b
      REAL(pr) :: arg10
      REAL(pr) :: result1
      REAL(pr) :: temp
      REAL(pr) :: temp0
      REAL(pr) :: temp1
      REAL(pr) :: tempb
      REAL(pr) :: temp2
      REAL(pr) :: temp3
      REAL(pr) :: temp4
      REAL(pr) :: tempb0
      REAL(pr) :: tempb1
      REAL(pr) :: tempb2
      INTEGER :: ad_from
      vc = model%components%vc
      tc = model%components%tc
      bv = model%binaries%bv
      gv = model%binaries%gv
      bt = model%binaries%bt
      gt = model%binaries%gt
      rho_c = 1/vc
      x = n/SUM(n)
      nc = SIZE(n)
      arg1(:) = n**2*vc
      arg1(:) = n**2*tc
      DO i=1,nc
         ad_from = i + 1
         DO j=ad_from,nc
            arg10 = tc(i)*tc(j)
            CALL PUSHREAL8(result1)
            result1 = SQRT(arg10)
         END DO
         CALL PUSHINTEGER4(ad_from)
      END DO
      xb = 0.0_pr
      DO i=nc,1,-1
         CALL POPINTEGER4(ad_from)
         DO j=nc,ad_from,-1
            temp4 = bt(i, j)*bt(i, j)
            temp3 = temp4*x(i) + x(j)
            temp1 = x(i) + x(j)
            temp0 = x(i)*x(j)
            tempb1 = bt(i, j)*gt(i, j)*result1*2*trb/temp3
            xb(i) = xb(i) + x(j)*temp1*tempb1
            xb(j) = xb(j) + x(i)*temp1*tempb1
            xb(i) = xb(i) + temp0*tempb1
            xb(j) = xb(j) + temp0*tempb1
            tempb2 = -(temp0*temp1*tempb1/temp3)
            xb(i) = xb(i) + temp4*tempb2
            xb(j) = xb(j) + tempb2
            CALL POPREAL8(result1)
            temp = bv(i, j)*bv(i, j)
            temp0 = 8*(temp*x(i)+x(j))
            temp2 = x(i) + x(j)
            temp3 = x(i)*x(j)
            tempb = bv(i, j)*2*gv(i, j)*(rho_c(i)**(-(1.0/3))+rho_c(j)**(-(&
            &         1.0/3)))**3*vrb/temp0
            xb(i) = xb(i) + x(j)*temp2*tempb
            xb(j) = xb(j) + x(i)*temp2*tempb
            xb(i) = xb(i) + temp3*tempb
            xb(j) = xb(j) + temp3*tempb
            tempb0 = -(8*temp3*temp2*tempb/temp0)
            xb(i) = xb(i) + temp*tempb0
            xb(j) = xb(j) + tempb0
         END DO
      END DO
      temp = SUM(n)
      arg1b = 0.0_pr
      arg1b = trb
      nb = nb + 2*n*tc*arg1b
      arg1b = 0.0_pr
      arg1b = vrb
      nb = nb + 2*n*vc*arg1b + xb/temp - SUM(n*xb)/temp**2
   end subroutine REDUCING_FUNCTIONS_B

   SUBROUTINE REDUCING_FUNCTIONS(model, n, vr, tr)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:)
      REAL(pr), INTENT(OUT) :: vr
      REAL(pr), INTENT(OUT) :: tr
      REAL(pr) :: vc(SIZE(n)), tc(SIZE(n)), x(SIZE(n)), rho_c(SIZE(n))
      REAL(pr) :: bv(SIZE(n), SIZE(n)), gv(SIZE(n), SIZE(n))
      REAL(pr) :: bt(SIZE(n), SIZE(n)), gt(SIZE(n), SIZE(n))
      INTEGER :: i, j, nc
      INTRINSIC SUM
      INTRINSIC SQRT
      INTRINSIC SIZE
      REAL(pr), DIMENSION(SIZE(n)) :: arg1
      REAL(pr) :: arg10
      REAL(pr) :: result1
      vc = model%components%vc
      tc = model%components%tc
      bv = model%binaries%bv
      gv = model%binaries%gv
      bt = model%binaries%bt
      gt = model%binaries%gt
      rho_c = 1/vc
      x = n/SUM(n)
      nc = SIZE(n)
      arg1(:) = n**2*vc
      vr = SUM(arg1(:))
      arg1(:) = n**2*tc
      tr = SUM(arg1(:))
      DO i=1,nc
         DO j=i+1,nc
            vr = vr + 2*x(i)*x(j)*bv(i, j)*gv(i, j)*(x(i)+x(j))/(bv(i, j)**2&
            &         *x(i)+x(j))*1.d0/8*(rho_c(i)**(-(1.d0/3))+rho_c(j)**(-(1.d0/3)&
            &         ))**3
            arg10 = tc(i)*tc(j)
            result1 = SQRT(arg10)
            tr = tr + 2*x(i)*x(j)*bt(i, j)*gt(i, j)*(x(i)+x(j))/(bt(i, j)**2&
            &         *x(i)+x(j))*result1
         END DO
      END DO
   end subroutine REDUCING_FUNCTIONS

!  Differentiation of ar_pure_d_d in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: ar ard0 ard ardd
!   with respect to varying inputs: taudd taud tau deltad0 deltad
!                taud0 delta deltadd
!  Differentiation of ar_pure_d in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: ar ard
!   with respect to varying inputs: taud tau deltad delta
!  Differentiation of ar_pure in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: ar
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_PURE_D_D_D(pure, delta, deltad1, deltad0, deltad0d, &
   &   deltad, deltadd0, deltadd, deltaddd, tau, taud1, taud0, taud0d, taud&
   &   , taudd0, taudd, tauddd, ar, ard1, ard0, ard0d, ard, ardd0, ardd, &
   &   arddd)
      IMPLICIT NONE
      class(GERG2008PURE), INTENT(IN) :: pure
      REAL(pr), INTENT(IN) :: delta
      REAL(pr), INTENT(IN) :: deltad1
      REAL(pr), INTENT(IN) :: deltad0
      REAL(pr), INTENT(IN) :: deltad0d
      REAL(pr), INTENT(IN) :: deltad
      REAL(pr), INTENT(IN) :: deltadd0
      REAL(pr), INTENT(IN) :: deltadd
      REAL(pr), INTENT(IN) :: deltaddd
      REAL(pr), INTENT(IN) :: tau
      REAL(pr), INTENT(IN) :: taud1
      REAL(pr), INTENT(IN) :: taud0
      REAL(pr), INTENT(IN) :: taud0d
      REAL(pr), INTENT(IN) :: taud
      REAL(pr), INTENT(IN) :: taudd0
      REAL(pr), INTENT(IN) :: taudd
      REAL(pr), INTENT(IN) :: tauddd
      REAL(pr), INTENT(OUT) :: ar
      REAL(pr), INTENT(OUT) :: ard1
      REAL(pr), INTENT(OUT) :: ard0
      REAL(pr), INTENT(OUT) :: ard0d
      REAL(pr), INTENT(OUT) :: ard
      REAL(pr), INTENT(OUT) :: ardd0
      REAL(pr), INTENT(OUT) :: ardd
      REAL(pr), INTENT(OUT) :: arddd
      INTEGER :: i, kpol, kexp
      REAL(pr) :: n_pol(pure%kpol), d_pol(pure%kpol), t_pol(pure%kpol)
      REAL(pr) :: n_exp(pure%kexp), d_exp(pure%kexp), t_exp(pure%kexp)
      REAL(pr) :: c_exp(pure%kexp)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(pure%kpol) :: arg1
      REAL(pr), DIMENSION(pure%kpol) :: arg1d1
      REAL(pr), DIMENSION(pure%kpol) :: arg1d0
      REAL(pr), DIMENSION(pure%kpol) :: arg1d0d
      REAL(pr), DIMENSION(pure%kpol) :: arg1d
      REAL(pr), DIMENSION(pure%kpol) :: arg1dd0
      REAL(pr), DIMENSION(pure%kpol) :: arg1dd
      REAL(pr), DIMENSION(pure%kpol) :: arg1ddd
      REAL(pr), DIMENSION(pure%kexp) :: arg2
      REAL(pr), DIMENSION(pure%kexp) :: arg2d1
      REAL(pr), DIMENSION(pure%kexp) :: arg2d0
      REAL(pr), DIMENSION(pure%kexp) :: arg2d0d
      REAL(pr), DIMENSION(pure%kexp) :: arg2d
      REAL(pr), DIMENSION(pure%kexp) :: arg2dd0
      REAL(pr), DIMENSION(pure%kexp) :: arg2dd
      REAL(pr), DIMENSION(pure%kexp) :: arg2ddd
      REAL(pr), DIMENSION(pure%kexp) :: arg3
      REAL(pr), DIMENSION(pure%kexp) :: arg3d1
      REAL(pr), DIMENSION(pure%kexp) :: arg3d0
      REAL(pr), DIMENSION(pure%kexp) :: arg3d0d
      REAL(pr), DIMENSION(pure%kexp) :: arg3d
      REAL(pr), DIMENSION(pure%kexp) :: arg3dd0
      REAL(pr), DIMENSION(pure%kexp) :: arg3dd
      REAL(pr), DIMENSION(pure%kexp) :: arg3ddd
      REAL(pr), DIMENSION(pure%kpol) :: temp
      REAL(pr), DIMENSION(pure%kpol) :: tempd7
      REAL(pr), DIMENSION(pure%kpol) :: tempd4
      REAL(pr), DIMENSION(pure%kpol) :: tempd4d
      REAL(pr), DIMENSION(pure%kpol) :: temp0
      REAL(pr), DIMENSION(pure%kpol) :: temp0d0
      REAL(pr), DIMENSION(pure%kpol) :: temp0d
      REAL(pr), DIMENSION(pure%kpol) :: temp0dd
      REAL(pr), DIMENSION(pure%kpol) :: tempd
      REAL(pr), DIMENSION(pure%kpol) :: tempdd0
      REAL(pr), DIMENSION(pure%kpol) :: tempdd
      REAL(pr), DIMENSION(pure%kpol) :: tempddd
      REAL(pr), DIMENSION(pure%kpol) :: tempd0
      REAL(pr), DIMENSION(pure%kpol) :: tempd0d0
      REAL(pr), DIMENSION(pure%kpol) :: tempd0d
      REAL(pr), DIMENSION(pure%kpol) :: tempd0dd
      REAL(pr), DIMENSION(pure%kexp) :: temp1
      REAL(pr), DIMENSION(pure%kexp) :: temp1d0
      REAL(pr), DIMENSION(pure%kexp) :: temp1d
      REAL(pr), DIMENSION(pure%kexp) :: temp1dd
      REAL(pr), DIMENSION(pure%kexp) :: tempd1
      REAL(pr), DIMENSION(pure%kexp) :: tempd1d0
      REAL(pr), DIMENSION(pure%kexp) :: tempd1d
      REAL(pr), DIMENSION(pure%kexp) :: tempd1dd
      REAL(pr), DIMENSION(pure%kexp) :: temp2
      REAL(pr), DIMENSION(pure%kexp) :: temp2d0
      REAL(pr), DIMENSION(pure%kexp) :: temp2d
      REAL(pr), DIMENSION(pure%kexp) :: temp2dd
      REAL(pr), DIMENSION(pure%kexp) :: temp3
      REAL(pr), DIMENSION(pure%kexp) :: temp3d0
      REAL(pr), DIMENSION(pure%kexp) :: temp3d
      REAL(pr), DIMENSION(pure%kexp) :: temp3dd
      REAL(pr), DIMENSION(pure%kexp) :: tempd2
      REAL(pr), DIMENSION(pure%kexp) :: tempd2d0
      REAL(pr), DIMENSION(pure%kexp) :: tempd2d
      REAL(pr), DIMENSION(pure%kexp) :: tempd2dd
      REAL(pr), DIMENSION(pure%kexp) :: tempd3
      REAL(pr), DIMENSION(pure%kexp) :: tempd3d0
      REAL(pr), DIMENSION(pure%kexp) :: tempd3d
      REAL(pr), DIMENSION(pure%kexp) :: tempd3dd
      REAL(pr), DIMENSION(pure%kexp) :: temp4
      REAL(pr), DIMENSION(pure%kexp) :: temp4d0
      REAL(pr), DIMENSION(pure%kexp) :: temp4d
      REAL(pr), DIMENSION(pure%kexp) :: temp4dd
      INTRINSIC INT
      REAL(pr), DIMENSION(pure%kpol) :: temp5
      REAL(pr), DIMENSION(pure%kpol) :: temp5d
      REAL(pr), DIMENSION(pure%kpol) :: tempd5
      REAL(pr), DIMENSION(pure%kpol) :: tempd5d
      REAL(pr), DIMENSION(pure%kexp) :: temp6
      REAL(pr), DIMENSION(pure%kexp) :: temp6d
      REAL(pr), DIMENSION(pure%kexp) :: tempd6
      REAL(pr), DIMENSION(pure%kexp) :: tempd6d
      REAL(pr), DIMENSION(pure%kexp) :: temp7
      REAL(pr), DIMENSION(pure%kexp) :: temp7d
      REAL(pr), DIMENSION(pure%kpol) :: temp8
      REAL(pr), DIMENSION(pure%kpol) :: tempd8
      REAL(pr), DIMENSION(pure%kexp) :: temp9
      REAL(pr), DIMENSION(pure%kexp) :: tempd9
      REAL(pr), DIMENSION(pure%kexp) :: temp10
      REAL(pr), DIMENSION(pure%kexp) :: temp11
      REAL(pr), DIMENSION(pure%kexp) :: temp12
      LOGICAL, DIMENSION(pure%kpol) :: mask
      LOGICAL, DIMENSION(pure%kpol) :: mask0
      LOGICAL, DIMENSION(pure%kpol) :: mask1
      LOGICAL, DIMENSION(pure%kpol) :: mask2
      LOGICAL, DIMENSION(pure%kpol) :: mask3
      LOGICAL, DIMENSION(pure%kpol) :: mask4
      LOGICAL, DIMENSION(pure%kpol) :: mask5
      LOGICAL, DIMENSION(pure%kpol) :: mask6
      LOGICAL, DIMENSION(pure%kpol) :: mask7
      LOGICAL, DIMENSION(pure%kpol) :: mask8
      LOGICAL, DIMENSION(pure%kpol) :: mask9
      LOGICAL, DIMENSION(pure%kpol) :: mask10
      LOGICAL, DIMENSION(pure%kpol) :: mask11
      LOGICAL, DIMENSION(pure%kpol) :: mask12
      LOGICAL, DIMENSION(pure%kpol) :: mask13
      LOGICAL, DIMENSION(pure%kpol) :: mask14
      LOGICAL, DIMENSION(pure%kpol) :: mask15
      LOGICAL, DIMENSION(pure%kpol) :: mask16
      LOGICAL, DIMENSION(pure%kpol) :: mask17
      LOGICAL, DIMENSION(pure%kpol) :: mask18
      LOGICAL, DIMENSION(pure%kpol) :: mask19
      LOGICAL, DIMENSION(pure%kpol) :: mask20
      LOGICAL, DIMENSION(pure%kpol) :: mask21
      LOGICAL, DIMENSION(pure%kpol) :: mask22
      LOGICAL, DIMENSION(pure%kexp) :: mask23
      LOGICAL, DIMENSION(pure%kexp) :: mask24
      LOGICAL, DIMENSION(pure%kexp) :: mask25
      LOGICAL, DIMENSION(pure%kexp) :: mask26
      LOGICAL, DIMENSION(pure%kexp) :: mask27
      LOGICAL, DIMENSION(pure%kexp) :: mask28
      LOGICAL, DIMENSION(pure%kexp) :: mask29
      LOGICAL, DIMENSION(pure%kexp) :: mask30
      LOGICAL, DIMENSION(pure%kexp) :: mask31
      LOGICAL, DIMENSION(pure%kexp) :: mask32
      LOGICAL, DIMENSION(pure%kexp) :: mask33
      LOGICAL, DIMENSION(pure%kexp) :: mask34
      LOGICAL, DIMENSION(pure%kexp) :: mask35
      LOGICAL, DIMENSION(pure%kexp) :: mask36
      LOGICAL, DIMENSION(pure%kexp) :: mask37
      LOGICAL, DIMENSION(pure%kexp) :: mask38
      LOGICAL, DIMENSION(pure%kexp) :: mask39
      LOGICAL, DIMENSION(pure%kexp) :: mask40
      LOGICAL, DIMENSION(pure%kexp) :: mask41
      LOGICAL, DIMENSION(pure%kexp) :: mask42
      LOGICAL, DIMENSION(pure%kexp) :: mask43
      LOGICAL, DIMENSION(pure%kexp) :: mask44
      LOGICAL, DIMENSION(pure%kexp) :: mask45
      LOGICAL, DIMENSION(pure%kexp) :: mask46
      LOGICAL, DIMENSION(pure%kexp) :: mask47
      LOGICAL, DIMENSION(pure%kexp) :: mask48
      LOGICAL, DIMENSION(pure%kexp) :: mask49
      LOGICAL, DIMENSION(pure%kexp) :: mask50
      LOGICAL, DIMENSION(pure%kexp) :: mask51
      LOGICAL, DIMENSION(pure%kexp) :: mask52
      LOGICAL, DIMENSION(pure%kexp) :: mask53
      LOGICAL, DIMENSION(pure%kexp) :: mask54
      LOGICAL, DIMENSION(pure%kexp) :: mask55
      LOGICAL, DIMENSION(pure%kexp) :: mask56
      kpol = pure%kpol
      kexp = pure%kexp
      n_pol = pure%n(1:kpol)
      d_pol = pure%d(1:kpol)
      t_pol = pure%t(1:kpol)
      n_exp = pure%n(kpol+1:kpol+kexp)
      d_exp = pure%d(kpol+1:kpol+kexp)
      t_exp = pure%t(kpol+1:kpol+kexp)
      c_exp = pure%c
      mask = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol)&
      &     )
      WHERE (mask) tempd4 = 0.0_pr
      tempd4d = 0.0_pr
      mask0 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT&
      &     (t_pol)))
      WHERE (mask0)
         temp8 = tau**(t_pol-1)
         mask1 = tau .LE. 0.0 .AND. (t_pol - 1 .EQ. 0.0 .OR. t_pol - 1 .NE.&
         &       INT(t_pol - 1))
         WHERE (mask1)
            tempd8 = 0.0_pr
         ELSEWHERE
            tempd8 = (t_pol-1)*tau**(t_pol-2)*taud1
         END WHERE
         tempd4d = t_pol*(taud0*tempd8+temp8*taud0d)
         tempd4 = t_pol*(temp8*taud0)
      END WHERE
      mask2 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol&
      &     ))
      WHERE (mask2)
         tempd7 = 0.0_pr
      ELSEWHERE
         tempd7 = t_pol*tau**(t_pol-1)*taud1
      END WHERE
      temp = tau**t_pol
      mask3 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask3) temp0d = 0.0_pr
      temp0dd = 0.0_pr
      mask4 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask4)
         temp8 = delta**(d_pol-1)
         mask5 = delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol - 1 &
         &       .NE. INT(d_pol - 1))
         WHERE (mask5)
            tempd8 = 0.0_pr
         ELSEWHERE
            tempd8 = (d_pol-1)*delta**(d_pol-2)*deltad1
         END WHERE
         temp0dd = d_pol*(deltad0*tempd8+temp8*deltad0d)
         temp0d = d_pol*(temp8*deltad0)
      END WHERE
      mask6 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask6)
         temp0d0 = 0.0_pr
      ELSEWHERE
         temp0d0 = d_pol*delta**(d_pol-1)*deltad1
      END WHERE
      temp0 = delta**d_pol
      mask7 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask7) tempd = 0.0_pr
      tempdd = 0.0_pr
      temp5d = 0.0_pr
      mask8 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask8)
         mask9 = delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol - 1 &
         &       .NE. INT(d_pol - 1))
         WHERE (mask9)
            temp5d = 0.0_pr
         ELSEWHERE
            temp5d = (d_pol-1)*delta**(d_pol-2)*deltad1
         END WHERE
         temp5 = delta**(d_pol-1)
         mask10 = delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol - 1 &
         &       .NE. INT(d_pol - 1))
         WHERE (mask10) tempd5 = 0.0_pr
      END WHERE
      tempd5d = 0.0_pr
      mask11 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask11)
         mask12 = .NOT.(delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol&
         &       - 1 .NE. INT(d_pol - 1)))
         WHERE (mask12)
            temp8 = delta**(d_pol-2)
            mask13 = delta .LE. 0.0 .AND. (d_pol - 2 .EQ. 0.0 .OR. d_pol - 2&
            &         .NE. INT(d_pol - 2))
            WHERE (mask13)
               tempd8 = 0.0_pr
            ELSEWHERE
               tempd8 = (d_pol-2)*delta**(d_pol-3)*deltad1
            END WHERE
            tempd5d = (d_pol-1)*(deltad0*tempd8+temp8*deltad0d)
            tempd5 = (d_pol-1)*(temp8*deltad0)
         END WHERE
      END WHERE
      tempddd = 0.0_pr
      mask14 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask14)
         tempddd = d_pol*(tempd5*deltadd0+deltad*tempd5d+deltadd*temp5d+&
         &       temp5*deltaddd)
         tempdd = d_pol*(deltad*tempd5+temp5*deltadd)
      END WHERE
      tempdd0 = 0.0_pr
      mask15 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask15)
         tempdd0 = d_pol*(deltad*temp5d+temp5*deltadd0)
         tempd = d_pol*(temp5*deltad)
      END WHERE
      mask16 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(&
      &     t_pol))
      WHERE (mask16) tempd0 = 0.0_pr
      tempd0d = 0.0_pr
      mask17 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. &
      &     INT(t_pol)))
      WHERE (mask17)
         mask18 = tau .LE. 0.0 .AND. (t_pol - 1 .EQ. 0.0 .OR. t_pol - 1 &
         &       .NE. INT(t_pol - 1))
         WHERE (mask18)
            temp5d = 0.0_pr
         ELSEWHERE
            temp5d = (t_pol-1)*tau**(t_pol-2)*taud1
         END WHERE
         temp5 = tau**(t_pol-1)
         mask19 = tau .LE. 0.0 .AND. (t_pol - 1 .EQ. 0.0 .OR. t_pol - 1 &
         &       .NE. INT(t_pol - 1))
         WHERE (mask19)
            tempd5d = 0.0_pr
            tempd5 = 0.0_pr
         ELSEWHERE
            temp8 = tau**(t_pol-2)
            mask20 = tau .LE. 0.0 .AND. (t_pol - 2 .EQ. 0.0 .OR. t_pol - 2 &
            &         .NE. INT(t_pol - 2))
            WHERE (mask20)
               tempd8 = 0.0_pr
            ELSEWHERE
               tempd8 = (t_pol-2)*tau**(t_pol-3)*taud1
            END WHERE
            tempd5d = (t_pol-1)*(taud0*tempd8+temp8*taud0d)
            tempd5 = (t_pol-1)*(temp8*taud0)
         END WHERE
      END WHERE
      tempd0dd = 0.0_pr
      mask21 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. &
      &     INT(t_pol)))
      WHERE (mask21)
         tempd0dd = t_pol*(tempd5*taudd0+taud*tempd5d+taudd*temp5d+temp5*&
         &       tauddd)
         tempd0d = t_pol*(taud*tempd5+temp5*taudd)
      END WHERE
      tempd0d0 = 0.0_pr
      mask22 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. &
      &     INT(t_pol)))
      WHERE (mask22)
         tempd0d0 = t_pol*(taud*temp5d+temp5*taudd0)
         tempd0 = t_pol*(temp5*taud)
      END WHERE
      arg1ddd(:) = n_pol*(tempd4*tempdd0+tempd*tempd4d+tempdd*tempd7+temp*&
      &     tempddd+temp0d*tempd0d0+tempd0*temp0dd+tempd0d*temp0d0+temp0*&
      &     tempd0dd)
      arg1dd(:) = n_pol*(tempd*tempd4+temp*tempdd+tempd0*temp0d+temp0*&
      &     tempd0d)
      arg1dd0(:) = n_pol*(tempd*tempd7+temp*tempdd0+tempd0*temp0d0+temp0*&
      &     tempd0d0)
      arg1d(:) = n_pol*(temp*tempd+temp0*tempd0)
      arg1d0d(:) = n_pol*(temp0d*tempd7+temp*temp0dd+tempd4*temp0d0+temp0*&
      &     tempd4d)
      arg1d0(:) = n_pol*(temp*temp0d+temp0*tempd4)
      arg1d1(:) = n_pol*(temp*temp0d0+temp0*tempd7)
      arg1(:) = n_pol*(temp0*temp)
      mask23 = delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. INT(&
      &     c_exp))
      WHERE (mask23) tempd1 = 0.0_pr
      tempd1d = 0.0_pr
      temp6d = 0.0_pr
      mask24 = .NOT.(delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. &
      &     INT(c_exp)))
      WHERE (mask24)
         mask25 = delta .LE. 0.0 .AND. (c_exp - 1 .EQ. 0.0 .OR. c_exp - 1 &
         &       .NE. INT(c_exp - 1))
         WHERE (mask25)
            temp6d = 0.0_pr
         ELSEWHERE
            temp6d = (c_exp-1)*delta**(c_exp-2)*deltad1
         END WHERE
         temp6 = delta**(c_exp-1)
         mask26 = delta .LE. 0.0 .AND. (c_exp - 1 .EQ. 0.0 .OR. c_exp - 1 &
         &       .NE. INT(c_exp - 1))
         WHERE (mask26) tempd6 = 0.0_pr
      END WHERE
      tempd6d = 0.0_pr
      mask27 = .NOT.(delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. &
      &     INT(c_exp)))
      WHERE (mask27)
         mask28 = .NOT.(delta .LE. 0.0 .AND. (c_exp - 1 .EQ. 0.0 .OR. c_exp&
         &       - 1 .NE. INT(c_exp - 1)))
         WHERE (mask28)
            temp9 = delta**(c_exp-2)
            mask29 = delta .LE. 0.0 .AND. (c_exp - 2 .EQ. 0.0 .OR. c_exp - 2&
            &         .NE. INT(c_exp - 2))
            WHERE (mask29)
               tempd9 = 0.0_pr
            ELSEWHERE
               tempd9 = (c_exp-2)*delta**(c_exp-3)*deltad1
            END WHERE
            tempd6d = (c_exp-1)*(deltad0*tempd9+temp9*deltad0d)
            tempd6 = (c_exp-1)*(temp9*deltad0)
         END WHERE
      END WHERE
      tempd1dd = 0.0_pr
      mask30 = .NOT.(delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. &
      &     INT(c_exp)))
      WHERE (mask30)
         tempd1dd = c_exp*(tempd6*deltadd0+deltad*tempd6d+deltadd*temp6d+&
         &       temp6*deltaddd)
         tempd1d = c_exp*(deltad*tempd6+temp6*deltadd)
      END WHERE
      tempd1d0 = 0.0_pr
      mask31 = .NOT.(delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. &
      &     INT(c_exp)))
      WHERE (mask31)
         tempd1d0 = c_exp*(deltad*temp6d+temp6*deltadd0)
         tempd1 = c_exp*(temp6*deltad)
      END WHERE
      arg2ddd(:) = -tempd1dd
      arg2dd(:) = -tempd1d
      arg2dd0(:) = -tempd1d0
      arg2d(:) = -tempd1
      mask32 = delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. INT(&
      &     c_exp))
      WHERE (mask32)
         tempd6d = 0.0_pr
         tempd6 = 0.0_pr
      ELSEWHERE
         temp9 = delta**(c_exp-1)
         mask33 = delta .LE. 0.0 .AND. (c_exp - 1 .EQ. 0.0 .OR. c_exp - 1 &
         &       .NE. INT(c_exp - 1))
         WHERE (mask33)
            tempd9 = 0.0_pr
         ELSEWHERE
            tempd9 = (c_exp-1)*delta**(c_exp-2)*deltad1
         END WHERE
         tempd6d = c_exp*(deltad0*tempd9+temp9*deltad0d)
         tempd6 = c_exp*(temp9*deltad0)
      END WHERE
      arg2d0d(:) = -tempd6d
      arg2d0(:) = -tempd6
      mask34 = delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. INT(&
      &     c_exp))
      WHERE (mask34)
         tempd9 = 0.0_pr
      ELSEWHERE
         tempd9 = c_exp*delta**(c_exp-1)*deltad1
      END WHERE
      arg2d1(:) = -tempd9
      arg2(:) = -(delta**c_exp)
      temp9 = EXP(arg2(:))
      temp1dd = arg2d0(:)*EXP(arg2(:))*arg2d1(:) + temp9*arg2d0d(:)
      temp1d = temp9*arg2d0(:)
      temp1d0 = EXP(arg2(:))*arg2d1(:)
      temp1 = EXP(arg2(:))
      mask35 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(&
      &     t_exp))
      WHERE (mask35) temp2d = 0.0_pr
      temp2dd = 0.0_pr
      mask36 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask36)
         temp9 = tau**(t_exp-1)
         mask37 = tau .LE. 0.0 .AND. (t_exp - 1 .EQ. 0.0 .OR. t_exp - 1 &
         &       .NE. INT(t_exp - 1))
         WHERE (mask37)
            tempd9 = 0.0_pr
         ELSEWHERE
            tempd9 = (t_exp-1)*tau**(t_exp-2)*taud1
         END WHERE
         temp2dd = t_exp*(taud0*tempd9+temp9*taud0d)
         temp2d = t_exp*(temp9*taud0)
      END WHERE
      mask38 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(&
      &     t_exp))
      WHERE (mask38)
         temp2d0 = 0.0_pr
      ELSEWHERE
         temp2d0 = t_exp*tau**(t_exp-1)*taud1
      END WHERE
      temp2 = tau**t_exp
      mask39 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask39) temp3d = 0.0_pr
      temp3dd = 0.0_pr
      mask40 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask40)
         temp9 = delta**(d_exp-1)
         mask41 = delta .LE. 0.0 .AND. (d_exp - 1 .EQ. 0.0 .OR. d_exp - 1 &
         &       .NE. INT(d_exp - 1))
         WHERE (mask41)
            tempd9 = 0.0_pr
         ELSEWHERE
            tempd9 = (d_exp-1)*delta**(d_exp-2)*deltad1
         END WHERE
         temp3dd = d_exp*(deltad0*tempd9+temp9*deltad0d)
         temp3d = d_exp*(temp9*deltad0)
      END WHERE
      mask42 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask42)
         temp3d0 = 0.0_pr
      ELSEWHERE
         temp3d0 = d_exp*delta**(d_exp-1)*deltad1
      END WHERE
      temp3 = delta**d_exp
      temp4dd = temp3d*temp2d0 + temp2*temp3dd + temp2d*temp3d0 + temp3*&
      &     temp2dd
      temp4d = temp2*temp3d + temp3*temp2d
      temp4d0 = temp2*temp3d0 + temp3*temp2d0
      temp4 = temp3*temp2
      mask43 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask43) tempd2 = 0.0_pr
      tempd2d = 0.0_pr
      mask44 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask44)
         mask45 = delta .LE. 0.0 .AND. (d_exp - 1 .EQ. 0.0 .OR. d_exp - 1 &
         &       .NE. INT(d_exp - 1))
         WHERE (mask45)
            temp6d = 0.0_pr
         ELSEWHERE
            temp6d = (d_exp-1)*delta**(d_exp-2)*deltad1
         END WHERE
         temp6 = delta**(d_exp-1)
         mask46 = delta .LE. 0.0 .AND. (d_exp - 1 .EQ. 0.0 .OR. d_exp - 1 &
         &       .NE. INT(d_exp - 1))
         WHERE (mask46)
            tempd6d = 0.0_pr
            tempd6 = 0.0_pr
         ELSEWHERE
            temp9 = delta**(d_exp-2)
            mask47 = delta .LE. 0.0 .AND. (d_exp - 2 .EQ. 0.0 .OR. d_exp - 2&
            &         .NE. INT(d_exp - 2))
            WHERE (mask47)
               tempd9 = 0.0_pr
            ELSEWHERE
               tempd9 = (d_exp-2)*delta**(d_exp-3)*deltad1
            END WHERE
            tempd6d = (d_exp-1)*(deltad0*tempd9+temp9*deltad0d)
            tempd6 = (d_exp-1)*(temp9*deltad0)
         END WHERE
      END WHERE
      tempd2dd = 0.0_pr
      mask48 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask48)
         tempd2dd = d_exp*(tempd6*deltadd0+deltad*tempd6d+deltadd*temp6d+&
         &       temp6*deltaddd)
         tempd2d = d_exp*(deltad*tempd6+temp6*deltadd)
      END WHERE
      tempd2d0 = 0.0_pr
      mask49 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask49)
         tempd2d0 = d_exp*(deltad*temp6d+temp6*deltadd0)
         tempd2 = d_exp*(temp6*deltad)
      END WHERE
      mask50 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(&
      &     t_exp))
      WHERE (mask50) tempd3 = 0.0_pr
      tempd3d = 0.0_pr
      mask51 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask51)
         mask52 = tau .LE. 0.0 .AND. (t_exp - 1 .EQ. 0.0 .OR. t_exp - 1 &
         &       .NE. INT(t_exp - 1))
         WHERE (mask52)
            temp6d = 0.0_pr
         ELSEWHERE
            temp6d = (t_exp-1)*tau**(t_exp-2)*taud1
         END WHERE
         temp6 = tau**(t_exp-1)
         mask53 = tau .LE. 0.0 .AND. (t_exp - 1 .EQ. 0.0 .OR. t_exp - 1 &
         &       .NE. INT(t_exp - 1))
         WHERE (mask53)
            tempd6d = 0.0_pr
            tempd6 = 0.0_pr
         ELSEWHERE
            temp9 = tau**(t_exp-2)
            mask54 = tau .LE. 0.0 .AND. (t_exp - 2 .EQ. 0.0 .OR. t_exp - 2 &
            &         .NE. INT(t_exp - 2))
            WHERE (mask54)
               tempd9 = 0.0_pr
            ELSEWHERE
               tempd9 = (t_exp-2)*tau**(t_exp-3)*taud1
            END WHERE
            tempd6d = (t_exp-1)*(taud0*tempd9+temp9*taud0d)
            tempd6 = (t_exp-1)*(temp9*taud0)
         END WHERE
      END WHERE
      tempd3dd = 0.0_pr
      mask55 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask55)
         tempd3dd = t_exp*(tempd6*taudd0+taud*tempd6d+taudd*temp6d+temp6*&
         &       tauddd)
         tempd3d = t_exp*(taud*tempd6+temp6*taudd)
      END WHERE
      tempd3d0 = 0.0_pr
      mask56 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask56)
         tempd3d0 = t_exp*(taud*temp6d+temp6*taudd0)
         tempd3 = t_exp*(temp6*taud)
      END WHERE
      temp6d = tempd2*temp2d0 + temp2*tempd2d0 + tempd3*temp3d0 + temp3*&
      &     tempd3d0
      temp6 = temp2*tempd2 + temp3*tempd3
      temp7d = EXP(arg2(:))*arg2d1(:)
      temp7 = EXP(arg2(:))
      temp9 = tempd2*temp2d + temp2*tempd2d + tempd3*temp3d + temp3*&
      &     tempd3d
      temp10 = EXP(arg2(:))
      temp11 = temp4*arg2d(:)*arg2d0(:)
      temp12 = arg2d(:)*temp4d + temp4*arg2dd(:)
      arg3ddd(:) = n_exp*(temp1d*temp6d+temp6*temp1dd+temp9*temp1d0+temp1*&
      &     (temp2d*tempd2d0+tempd2*temp2dd+tempd2d*temp2d0+temp2*tempd2dd+&
      &     temp3d*tempd3d0+tempd3*temp3dd+tempd3d*temp3d0+temp3*tempd3dd)+&
      &     temp10*(arg2d0(:)*(arg2d(:)*temp4d0+temp4*arg2dd0(:))+temp4*arg2d(&
      &     :)*arg2d0d(:))+temp11*EXP(arg2(:))*arg2d1(:)+temp12*temp7d+temp7*(&
      &     temp4d*arg2dd0(:)+arg2d(:)*temp4dd+arg2dd(:)*temp4d0+temp4*arg2ddd&
      &     (:)))
      arg3dd(:) = n_exp*(temp6*temp1d+temp1*temp9+temp11*temp10+temp7*&
      &     temp12)
      arg3dd0(:) = n_exp*(temp6*temp1d0+temp1*temp6d+arg2d(:)*(temp4*&
      &     temp7d+temp7*temp4d0)+temp7*temp4*arg2dd0(:))
      arg3d(:) = n_exp*(temp1*temp6+temp7*(temp4*arg2d(:)))
      arg3d0d(:) = n_exp*(temp4d*temp1d0+temp1*temp4dd+temp1d*temp4d0+&
      &     temp4*temp1dd)
      arg3d0(:) = n_exp*(temp1*temp4d+temp4*temp1d)
      arg3d1(:) = n_exp*(temp1*temp4d0+temp4*temp1d0)
      arg3(:) = n_exp*(temp4*temp1)
      arddd = SUM(arg1ddd(:)) + SUM(arg3ddd(:))
      ardd = SUM(arg1dd(:)) + SUM(arg3dd(:))
      ardd0 = SUM(arg1dd0(:)) + SUM(arg3dd0(:))
      ard = SUM(arg1d(:)) + SUM(arg3d(:))
      ard0d = SUM(arg1d0d(:)) + SUM(arg3d0d(:))
      ard0 = SUM(arg1d0(:)) + SUM(arg3d0(:))
      ard1 = SUM(arg1d1(:)) + SUM(arg3d1(:))
      ar = SUM(arg1(:)) + SUM(arg3(:))
   end subroutine AR_PURE_D_D_D

!  Differentiation of ar_pure_d in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: ar ard
!   with respect to varying inputs: taud tau deltad delta
!  Differentiation of ar_pure in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: ar
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_PURE_D_D(pure, delta, deltad0, deltad, deltadd, tau, &
   &   taud0, taud, taudd, ar, ard0, ard, ardd)
      IMPLICIT NONE
      class(GERG2008PURE), INTENT(IN) :: pure
      REAL(pr), INTENT(IN) :: delta
      REAL(pr), INTENT(IN) :: deltad0
      REAL(pr), INTENT(IN) :: deltad
      REAL(pr), INTENT(IN) :: deltadd
      REAL(pr), INTENT(IN) :: tau
      REAL(pr), INTENT(IN) :: taud0
      REAL(pr), INTENT(IN) :: taud
      REAL(pr), INTENT(IN) :: taudd
      REAL(pr), INTENT(OUT) :: ar
      REAL(pr), INTENT(OUT) :: ard0
      REAL(pr), INTENT(OUT) :: ard
      REAL(pr), INTENT(OUT) :: ardd
      INTEGER :: i, kpol, kexp
      REAL(pr) :: n_pol(pure%kpol), d_pol(pure%kpol), t_pol(pure%kpol)
      REAL(pr) :: n_exp(pure%kexp), d_exp(pure%kexp), t_exp(pure%kexp)
      REAL(pr) :: c_exp(pure%kexp)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(pure%kpol) :: arg1
      REAL(pr), DIMENSION(pure%kpol) :: arg1d0
      REAL(pr), DIMENSION(pure%kpol) :: arg1d
      REAL(pr), DIMENSION(pure%kpol) :: arg1dd
      REAL(pr), DIMENSION(pure%kexp) :: arg2
      REAL(pr), DIMENSION(pure%kexp) :: arg2d0
      REAL(pr), DIMENSION(pure%kexp) :: arg2d
      REAL(pr), DIMENSION(pure%kexp) :: arg2dd
      REAL(pr), DIMENSION(pure%kexp) :: arg3
      REAL(pr), DIMENSION(pure%kexp) :: arg3d0
      REAL(pr), DIMENSION(pure%kexp) :: arg3d
      REAL(pr), DIMENSION(pure%kexp) :: arg3dd
      REAL(pr), DIMENSION(pure%kpol) :: temp
      REAL(pr), DIMENSION(pure%kpol) :: tempd4
      REAL(pr), DIMENSION(pure%kpol) :: temp0
      REAL(pr), DIMENSION(pure%kpol) :: temp0d
      REAL(pr), DIMENSION(pure%kpol) :: tempd
      REAL(pr), DIMENSION(pure%kpol) :: tempdd
      REAL(pr), DIMENSION(pure%kpol) :: tempd0
      REAL(pr), DIMENSION(pure%kpol) :: tempd0d
      REAL(pr), DIMENSION(pure%kexp) :: temp1
      REAL(pr), DIMENSION(pure%kexp) :: temp1d
      REAL(pr), DIMENSION(pure%kexp) :: tempd1
      REAL(pr), DIMENSION(pure%kexp) :: tempd1d
      REAL(pr), DIMENSION(pure%kexp) :: temp2
      REAL(pr), DIMENSION(pure%kexp) :: temp2d
      REAL(pr), DIMENSION(pure%kexp) :: temp3
      REAL(pr), DIMENSION(pure%kexp) :: temp3d
      REAL(pr), DIMENSION(pure%kexp) :: tempd2
      REAL(pr), DIMENSION(pure%kexp) :: tempd2d
      REAL(pr), DIMENSION(pure%kexp) :: tempd3
      REAL(pr), DIMENSION(pure%kexp) :: tempd3d
      REAL(pr), DIMENSION(pure%kexp) :: temp4
      REAL(pr), DIMENSION(pure%kexp) :: temp4d
      INTRINSIC INT
      REAL(pr), DIMENSION(pure%kpol) :: temp5
      REAL(pr), DIMENSION(pure%kpol) :: tempd5
      REAL(pr), DIMENSION(pure%kexp) :: temp6
      REAL(pr), DIMENSION(pure%kexp) :: tempd6
      REAL(pr), DIMENSION(pure%kexp) :: temp7
      LOGICAL, DIMENSION(pure%kpol) :: mask
      LOGICAL, DIMENSION(pure%kpol) :: mask0
      LOGICAL, DIMENSION(pure%kpol) :: mask1
      LOGICAL, DIMENSION(pure%kpol) :: mask2
      LOGICAL, DIMENSION(pure%kpol) :: mask3
      LOGICAL, DIMENSION(pure%kpol) :: mask4
      LOGICAL, DIMENSION(pure%kpol) :: mask5
      LOGICAL, DIMENSION(pure%kpol) :: mask6
      LOGICAL, DIMENSION(pure%kexp) :: mask7
      LOGICAL, DIMENSION(pure%kexp) :: mask8
      LOGICAL, DIMENSION(pure%kexp) :: mask9
      LOGICAL, DIMENSION(pure%kexp) :: mask10
      LOGICAL, DIMENSION(pure%kexp) :: mask11
      LOGICAL, DIMENSION(pure%kexp) :: mask12
      LOGICAL, DIMENSION(pure%kexp) :: mask13
      LOGICAL, DIMENSION(pure%kexp) :: mask14
      LOGICAL, DIMENSION(pure%kexp) :: mask15
      LOGICAL, DIMENSION(pure%kexp) :: mask16
      LOGICAL, DIMENSION(pure%kexp) :: mask17
      LOGICAL, DIMENSION(pure%kexp) :: mask18
      kpol = pure%kpol
      kexp = pure%kexp
      n_pol = pure%n(1:kpol)
      d_pol = pure%d(1:kpol)
      t_pol = pure%t(1:kpol)
      n_exp = pure%n(kpol+1:kpol+kexp)
      d_exp = pure%d(kpol+1:kpol+kexp)
      t_exp = pure%t(kpol+1:kpol+kexp)
      c_exp = pure%c
      mask = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol)&
      &     )
      WHERE (mask)
         tempd4 = 0.0_pr
      ELSEWHERE
         tempd4 = t_pol*tau**(t_pol-1)*taud0
      END WHERE
      temp = tau**t_pol
      mask0 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask0)
         temp0d = 0.0_pr
      ELSEWHERE
         temp0d = d_pol*delta**(d_pol-1)*deltad0
      END WHERE
      temp0 = delta**d_pol
      mask1 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask1) tempd = 0.0_pr
      tempdd = 0.0_pr
      mask2 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask2)
         temp5 = delta**(d_pol-1)
         mask3 = delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol - 1 &
         &       .NE. INT(d_pol - 1))
         WHERE (mask3)
            tempd5 = 0.0_pr
         ELSEWHERE
            tempd5 = (d_pol-1)*delta**(d_pol-2)*deltad0
         END WHERE
         tempdd = d_pol*(deltad*tempd5+temp5*deltadd)
         tempd = d_pol*(temp5*deltad)
      END WHERE
      mask4 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol&
      &     ))
      WHERE (mask4) tempd0 = 0.0_pr
      tempd0d = 0.0_pr
      mask5 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT&
      &     (t_pol)))
      WHERE (mask5)
         temp5 = tau**(t_pol-1)
         mask6 = tau .LE. 0.0 .AND. (t_pol - 1 .EQ. 0.0 .OR. t_pol - 1 .NE.&
         &       INT(t_pol - 1))
         WHERE (mask6)
            tempd5 = 0.0_pr
         ELSEWHERE
            tempd5 = (t_pol-1)*tau**(t_pol-2)*taud0
         END WHERE
         tempd0d = t_pol*(taud*tempd5+temp5*taudd)
         tempd0 = t_pol*(temp5*taud)
      END WHERE
      arg1dd(:) = n_pol*(tempd*tempd4+temp*tempdd+tempd0*temp0d+temp0*&
      &     tempd0d)
      arg1d(:) = n_pol*(temp*tempd+temp0*tempd0)
      arg1d0(:) = n_pol*(temp*temp0d+temp0*tempd4)
      arg1(:) = n_pol*(temp0*temp)
      mask7 = delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. INT(&
      &     c_exp))
      WHERE (mask7) tempd1 = 0.0_pr
      tempd1d = 0.0_pr
      mask8 = .NOT.(delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. &
      &     INT(c_exp)))
      WHERE (mask8)
         temp6 = delta**(c_exp-1)
         mask9 = delta .LE. 0.0 .AND. (c_exp - 1 .EQ. 0.0 .OR. c_exp - 1 &
         &       .NE. INT(c_exp - 1))
         WHERE (mask9)
            tempd6 = 0.0_pr
         ELSEWHERE
            tempd6 = (c_exp-1)*delta**(c_exp-2)*deltad0
         END WHERE
         tempd1d = c_exp*(deltad*tempd6+temp6*deltadd)
         tempd1 = c_exp*(temp6*deltad)
      END WHERE
      arg2dd(:) = -tempd1d
      arg2d(:) = -tempd1
      mask10 = delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. INT(&
      &     c_exp))
      WHERE (mask10)
         tempd6 = 0.0_pr
      ELSEWHERE
         tempd6 = c_exp*delta**(c_exp-1)*deltad0
      END WHERE
      arg2d0(:) = -tempd6
      arg2(:) = -(delta**c_exp)
      temp1d = EXP(arg2(:))*arg2d0(:)
      temp1 = EXP(arg2(:))
      mask11 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(&
      &     t_exp))
      WHERE (mask11)
         temp2d = 0.0_pr
      ELSEWHERE
         temp2d = t_exp*tau**(t_exp-1)*taud0
      END WHERE
      temp2 = tau**t_exp
      mask12 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask12)
         temp3d = 0.0_pr
      ELSEWHERE
         temp3d = d_exp*delta**(d_exp-1)*deltad0
      END WHERE
      temp3 = delta**d_exp
      temp4d = temp2*temp3d + temp3*temp2d
      temp4 = temp3*temp2
      mask13 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask13) tempd2 = 0.0_pr
      tempd2d = 0.0_pr
      mask14 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask14)
         temp6 = delta**(d_exp-1)
         mask15 = delta .LE. 0.0 .AND. (d_exp - 1 .EQ. 0.0 .OR. d_exp - 1 &
         &       .NE. INT(d_exp - 1))
         WHERE (mask15)
            tempd6 = 0.0_pr
         ELSEWHERE
            tempd6 = (d_exp-1)*delta**(d_exp-2)*deltad0
         END WHERE
         tempd2d = d_exp*(deltad*tempd6+temp6*deltadd)
         tempd2 = d_exp*(temp6*deltad)
      END WHERE
      mask16 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(&
      &     t_exp))
      WHERE (mask16) tempd3 = 0.0_pr
      tempd3d = 0.0_pr
      mask17 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask17)
         temp6 = tau**(t_exp-1)
         mask18 = tau .LE. 0.0 .AND. (t_exp - 1 .EQ. 0.0 .OR. t_exp - 1 &
         &       .NE. INT(t_exp - 1))
         WHERE (mask18)
            tempd6 = 0.0_pr
         ELSEWHERE
            tempd6 = (t_exp-1)*tau**(t_exp-2)*taud0
         END WHERE
         tempd3d = t_exp*(taud*tempd6+temp6*taudd)
         tempd3 = t_exp*(temp6*taud)
      END WHERE
      temp6 = temp2*tempd2 + temp3*tempd3
      temp7 = EXP(arg2(:))
      arg3dd(:) = n_exp*(temp6*temp1d+temp1*(tempd2*temp2d+temp2*tempd2d+&
      &     tempd3*temp3d+temp3*tempd3d)+temp4*arg2d(:)*EXP(arg2(:))*arg2d0(:)&
      &     +temp7*(arg2d(:)*temp4d+temp4*arg2dd(:)))
      arg3d(:) = n_exp*(temp1*temp6+temp7*(temp4*arg2d(:)))
      arg3d0(:) = n_exp*(temp1*temp4d+temp4*temp1d)
      arg3(:) = n_exp*(temp4*temp1)
      ardd = SUM(arg1dd(:)) + SUM(arg3dd(:))
      ard = SUM(arg1d(:)) + SUM(arg3d(:))
      ard0 = SUM(arg1d0(:)) + SUM(arg3d0(:))
      ar = SUM(arg1(:)) + SUM(arg3(:))
   end subroutine AR_PURE_D_D

!  Differentiation of ar_pure_d in reverse (adjoint) mode (with options noISIZE):
!   gradient     of useful results: taud tau ar deltad ard delta
!   with respect to varying inputs: taud tau deltad delta
!  Differentiation of ar_pure in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: ar
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_PURE_D_B(pure, delta, deltab, deltad, deltadb, tau, taub&
   &   , taud, taudb, ar, arb, ard, ardb)
      IMPLICIT NONE
      class(GERG2008PURE), INTENT(IN) :: pure
      REAL(pr), INTENT(IN) :: delta
      REAL(pr) :: deltab
      REAL(pr), INTENT(IN) :: deltad
      REAL(pr) :: deltadb
      REAL(pr), INTENT(IN) :: tau
      REAL(pr) :: taub
      REAL(pr), INTENT(IN) :: taud
      REAL(pr) :: taudb
      REAL(pr) :: ar
      REAL(pr) :: arb
      REAL(pr) :: ard
      REAL(pr) :: ardb
      INTEGER :: i, kpol, kexp
      REAL(pr) :: n_pol(pure%kpol), d_pol(pure%kpol), t_pol(pure%kpol)
      REAL(pr) :: n_exp(pure%kexp), d_exp(pure%kexp), t_exp(pure%kexp)
      REAL(pr) :: c_exp(pure%kexp)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(pure%kpol) :: arg1
      REAL(pr), DIMENSION(pure%kpol) :: arg1b
      REAL(pr), DIMENSION(pure%kpol) :: arg1d
      REAL(pr), DIMENSION(pure%kpol) :: arg1db
      REAL(pr), DIMENSION(pure%kexp) :: arg2
      REAL(pr), DIMENSION(pure%kexp) :: arg2b
      REAL(pr), DIMENSION(pure%kexp) :: arg2d
      REAL(pr), DIMENSION(pure%kexp) :: arg2db
      REAL(pr), DIMENSION(pure%kexp) :: arg3
      REAL(pr), DIMENSION(pure%kexp) :: arg3b
      REAL(pr), DIMENSION(pure%kexp) :: arg3d
      REAL(pr), DIMENSION(pure%kexp) :: arg3db
      REAL(pr), DIMENSION(pure%kpol) :: temp
      REAL(pr), DIMENSION(pure%kpol) :: tempb
      REAL(pr), DIMENSION(pure%kpol) :: temp0
      REAL(pr), DIMENSION(pure%kpol) :: temp0b
      REAL(pr), DIMENSION(pure%kpol) :: tempd
      REAL(pr), DIMENSION(pure%kpol) :: tempdb
      REAL(pr), DIMENSION(pure%kpol) :: tempd0
      REAL(pr), DIMENSION(pure%kpol) :: tempd0b
      REAL(pr), DIMENSION(pure%kexp) :: temp1
      REAL(pr), DIMENSION(pure%kexp) :: temp1b
      REAL(pr), DIMENSION(pure%kexp) :: tempd1
      REAL(pr), DIMENSION(pure%kexp) :: tempd1b
      REAL(pr), DIMENSION(pure%kexp) :: temp2
      REAL(pr), DIMENSION(pure%kexp) :: temp2b
      REAL(pr), DIMENSION(pure%kexp) :: temp3
      REAL(pr), DIMENSION(pure%kexp) :: temp3b
      REAL(pr), DIMENSION(pure%kexp) :: tempd2
      REAL(pr), DIMENSION(pure%kexp) :: tempd2b
      REAL(pr), DIMENSION(pure%kexp) :: tempd3
      REAL(pr), DIMENSION(pure%kexp) :: tempd3b
      REAL(pr), DIMENSION(pure%kexp) :: temp4
      REAL(pr), DIMENSION(pure%kexp) :: temp4b
      INTRINSIC INT
      LOGICAL, DIMENSION(pure%kpol) :: mask
      LOGICAL, DIMENSION(pure%kpol) :: mask0
      LOGICAL, DIMENSION(pure%kexp) :: mask1
      LOGICAL, DIMENSION(pure%kexp) :: mask2
      LOGICAL, DIMENSION(pure%kexp) :: mask3
      REAL(pr), DIMENSION(pure%kpol) :: tempb0
      REAL(pr), DIMENSION(pure%kexp) :: tempb1
      REAL(pr), DIMENSION(pure%kexp) :: tempb2
      REAL(pr), DIMENSION(pure%kexp) :: tempb3
      LOGICAL, DIMENSION(pure%kexp) :: arg10
      REAL(pr) :: result1
      LOGICAL, DIMENSION(pure%kexp) :: arg20
      REAL(pr) :: result2
      LOGICAL, DIMENSION(pure%kexp) :: arg30
      REAL(pr) :: result3
      LOGICAL, DIMENSION(pure%kexp) :: arg4
      REAL(pr) :: result4
      LOGICAL, DIMENSION(pure%kpol) :: arg5
      REAL(pr) :: result5
      LOGICAL, DIMENSION(pure%kpol) :: arg6
      REAL(pr) :: result6
      LOGICAL, DIMENSION(pure%kpol) :: arg31
      LOGICAL, DIMENSION(pure%kpol) :: arg40
      LOGICAL, DIMENSION(pure%kpol) :: arg21
      kpol = pure%kpol
      kexp = pure%kexp
      n_pol = pure%n(1:kpol)
      d_pol = pure%d(1:kpol)
      t_pol = pure%t(1:kpol)
      n_exp = pure%n(kpol+1:kpol+kexp)
      d_exp = pure%d(kpol+1:kpol+kexp)
      t_exp = pure%t(kpol+1:kpol+kexp)
      c_exp = pure%c
      temp = tau**t_pol
      temp0 = delta**d_pol
      mask = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask)
         tempd = 0.0_pr
      ELSEWHERE
         tempd = d_pol*delta**(d_pol-1)*deltad
      END WHERE
      mask0 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol&
      &     ))
      WHERE (mask0)
         tempd0 = 0.0_pr
      ELSEWHERE
         tempd0 = t_pol*tau**(t_pol-1)*taud
      END WHERE
      arg1d(:) = n_pol*(temp*tempd+temp0*tempd0)
      arg1(:) = n_pol*(temp0*temp)
      mask1 = delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. INT(&
      &     c_exp))
      WHERE (mask1)
         tempd1 = 0.0_pr
      ELSEWHERE
         tempd1 = c_exp*delta**(c_exp-1)*deltad
      END WHERE
      arg2d(:) = -tempd1
      arg2(:) = -(delta**c_exp)
      temp1 = EXP(arg2(:))
      temp2 = tau**t_exp
      temp3 = delta**d_exp
      temp4 = temp3*temp2
      mask2 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask2)
         tempd2 = 0.0_pr
      ELSEWHERE
         tempd2 = d_exp*delta**(d_exp-1)*deltad
      END WHERE
      mask3 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(t_exp&
      &     ))
      WHERE (mask3)
         tempd3 = 0.0_pr
      ELSEWHERE
         tempd3 = t_exp*tau**(t_exp-1)*taud
      END WHERE
      arg3d(:) = n_exp*(temp1*(temp2*tempd2+temp3*tempd3)+temp4*EXP(arg2(:&
      &     ))*arg2d(:))
      arg3(:) = n_exp*(temp4*temp1)
      arg1b = 0.0_pr
      arg3b = 0.0_pr
      arg1b = arb
      arg3b = arb
      arg1db = 0.0_pr
      arg3db = 0.0_pr
      arg1db = ardb
      arg3db = ardb
      temp4b = 0.0_pr
      temp1b = 0.0_pr
      arg2b = 0.0_pr
      tempd2b = 0.0_pr
      tempd3b = 0.0_pr
      arg2db = 0.0_pr
      temp2b = 0.0_pr
      temp3b = 0.0_pr
      tempb1 = n_exp*arg3db
      temp1b = temp4*n_exp*arg3b + (temp2*tempd2+temp3*tempd3)*tempb1
      tempb2 = temp1*tempb1
      arg2b = EXP(arg2)*temp4*arg2d*tempb1 + EXP(arg2)*temp1b
      tempb3 = EXP(arg2)*tempb1
      temp4b = temp1*n_exp*arg3b + arg2d*tempb3
      arg2db = temp4*tempb3
      temp2b = tempd2*tempb2 + temp3*temp4b
      tempd2b = temp2*tempb2
      temp3b = tempd3*tempb2 + temp2*temp4b
      tempd3b = temp3*tempb2
      tempd1b = 0.0_pr
      tempd1b = -arg2db
      tempb = 0.0_pr
      temp0b = 0.0_pr
      tempd0b = 0.0_pr
      tempdb = 0.0_pr
      tempb0 = n_pol*arg1db
      temp0b = temp*n_pol*arg1b + tempd0*tempb0
      tempb = temp0*n_pol*arg1b + tempd*tempb0
      tempdb = temp*tempb0
      arg10(:) = .NOT.mask2 .AND. (.NOT.(delta .LE. 0.0 .AND. (d_exp - 1 &
      &     .EQ. 0.0 .OR. d_exp - 1 .NE. INT(d_exp - 1))))
      result1 = SUM((d_exp-1)*delta**(d_exp-2)*d_exp*tempd2b, mask=arg10(:&
      &     ))
      arg20(:) = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp &
      &     .NE. INT(d_exp)))
      result2 = SUM(d_exp*delta**(d_exp-1)*temp3b, mask=arg20(:))
      arg30(:) = .NOT.mask1 .AND. (.NOT.(delta .LE. 0.0 .AND. (c_exp - 1 &
      &     .EQ. 0.0 .OR. c_exp - 1 .NE. INT(c_exp - 1))))
      result3 = SUM((c_exp-1)*delta**(c_exp-2)*c_exp*tempd1b, mask=arg30(:&
      &     ))
      arg4(:) = .NOT.(delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE.&
      &     INT(c_exp)))
      result4 = SUM(c_exp*delta**(c_exp-1)*arg2b, mask=arg4(:))
      arg5(:) = .NOT.mask .AND. (.NOT.(delta .LE. 0.0 .AND. (d_pol - 1 &
      &     .EQ. 0.0 .OR. d_pol - 1 .NE. INT(d_pol - 1))))
      result5 = SUM((d_pol-1)*delta**(d_pol-2)*d_pol*tempdb, mask=arg5(:))
      arg6(:) = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE.&
      &     INT(d_pol)))
      result6 = SUM(d_pol*delta**(d_pol-1)*temp0b, mask=arg6(:))
      deltab = deltab + result1*deltad + result2 + result3*deltad - &
      &     result4 + result5*deltad + result6
      arg10(:) = .NOT.mask2
      result1 = SUM(delta**(d_exp-1)*d_exp*tempd2b, mask=arg10(:))
      arg20(:) = .NOT.mask1
      result2 = SUM(delta**(c_exp-1)*c_exp*tempd1b, mask=arg20(:))
      arg31(:) = .NOT.mask
      result3 = SUM(delta**(d_pol-1)*d_pol*tempdb, mask=arg31(:))
      deltadb = deltadb + result1 + result2 + result3
      tempd0b = temp0*tempb0
      arg10(:) = .NOT.mask3 .AND. (.NOT.(tau .LE. 0.0 .AND. (t_exp - 1 &
      &     .EQ. 0.0 .OR. t_exp - 1 .NE. INT(t_exp - 1))))
      result1 = SUM((t_exp-1)*tau**(t_exp-2)*t_exp*tempd3b, mask=arg10(:))
      arg20(:) = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      result2 = SUM(t_exp*tau**(t_exp-1)*temp2b, mask=arg20(:))
      arg31(:) = .NOT.mask0 .AND. (.NOT.(tau .LE. 0.0 .AND. (t_pol - 1 &
      &     .EQ. 0.0 .OR. t_pol - 1 .NE. INT(t_pol - 1))))
      result3 = SUM((t_pol-1)*tau**(t_pol-2)*t_pol*tempd0b, mask=arg31(:))
      arg40(:) = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. &
      &     INT(t_pol)))
      result4 = SUM(t_pol*tau**(t_pol-1)*tempb, mask=arg40(:))
      taub = taub + result1*taud + result2 + result3*taud + result4
      arg10(:) = .NOT.mask3
      result1 = SUM(tau**(t_exp-1)*t_exp*tempd3b, mask=arg10(:))
      arg21(:) = .NOT.mask0
      result2 = SUM(tau**(t_pol-1)*t_pol*tempd0b, mask=arg21(:))
      taudb = taudb + result1 + result2
   end subroutine AR_PURE_D_B

!  Differentiation of ar_pure in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: ar
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_PURE_D(pure, delta, deltad, tau, taud, ar, ard)
      IMPLICIT NONE
      class(GERG2008PURE), INTENT(IN) :: pure
      REAL(pr), INTENT(IN) :: delta
      REAL(pr), INTENT(IN) :: deltad
      REAL(pr), INTENT(IN) :: tau
      REAL(pr), INTENT(IN) :: taud
      REAL(pr), INTENT(OUT) :: ar
      REAL(pr), INTENT(OUT) :: ard
      INTEGER :: i, kpol, kexp
      REAL(pr) :: n_pol(pure%kpol), d_pol(pure%kpol), t_pol(pure%kpol)
      REAL(pr) :: n_exp(pure%kexp), d_exp(pure%kexp), t_exp(pure%kexp)
      REAL(pr) :: c_exp(pure%kexp)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(pure%kpol) :: arg1
      REAL(pr), DIMENSION(pure%kpol) :: arg1d
      REAL(pr), DIMENSION(pure%kexp) :: arg2
      REAL(pr), DIMENSION(pure%kexp) :: arg2d
      REAL(pr), DIMENSION(pure%kexp) :: arg3
      REAL(pr), DIMENSION(pure%kexp) :: arg3d
      REAL(pr), DIMENSION(pure%kpol) :: temp
      REAL(pr), DIMENSION(pure%kpol) :: temp0
      REAL(pr), DIMENSION(pure%kpol) :: tempd
      REAL(pr), DIMENSION(pure%kpol) :: tempd0
      REAL(pr), DIMENSION(pure%kexp) :: temp1
      REAL(pr), DIMENSION(pure%kexp) :: tempd1
      REAL(pr), DIMENSION(pure%kexp) :: temp2
      REAL(pr), DIMENSION(pure%kexp) :: temp3
      REAL(pr), DIMENSION(pure%kexp) :: tempd2
      REAL(pr), DIMENSION(pure%kexp) :: tempd3
      REAL(pr), DIMENSION(pure%kexp) :: temp4
      INTRINSIC INT
      LOGICAL, DIMENSION(pure%kpol) :: mask
      LOGICAL, DIMENSION(pure%kpol) :: mask0
      LOGICAL, DIMENSION(pure%kexp) :: mask1
      LOGICAL, DIMENSION(pure%kexp) :: mask2
      LOGICAL, DIMENSION(pure%kexp) :: mask3
      kpol = pure%kpol
      kexp = pure%kexp
      n_pol = pure%n(1:kpol)
      d_pol = pure%d(1:kpol)
      t_pol = pure%t(1:kpol)
      n_exp = pure%n(kpol+1:kpol+kexp)
      d_exp = pure%d(kpol+1:kpol+kexp)
      t_exp = pure%t(kpol+1:kpol+kexp)
      c_exp = pure%c
      temp = tau**t_pol
      temp0 = delta**d_pol
      mask = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask)
         tempd = 0.0_pr
      ELSEWHERE
         tempd = d_pol*delta**(d_pol-1)*deltad
      END WHERE
      mask0 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol&
      &     ))
      WHERE (mask0)
         tempd0 = 0.0_pr
      ELSEWHERE
         tempd0 = t_pol*tau**(t_pol-1)*taud
      END WHERE
      arg1d(:) = n_pol*(temp*tempd+temp0*tempd0)
      arg1(:) = n_pol*(temp0*temp)
      mask1 = delta .LE. 0.0 .AND. (c_exp .EQ. 0.0 .OR. c_exp .NE. INT(&
      &     c_exp))
      WHERE (mask1)
         tempd1 = 0.0_pr
      ELSEWHERE
         tempd1 = c_exp*delta**(c_exp-1)*deltad
      END WHERE
      arg2d(:) = -tempd1
      arg2(:) = -(delta**c_exp)
      temp1 = EXP(arg2(:))
      temp2 = tau**t_exp
      temp3 = delta**d_exp
      temp4 = temp3*temp2
      mask2 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask2)
         tempd2 = 0.0_pr
      ELSEWHERE
         tempd2 = d_exp*delta**(d_exp-1)*deltad
      END WHERE
      mask3 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(t_exp&
      &     ))
      WHERE (mask3)
         tempd3 = 0.0_pr
      ELSEWHERE
         tempd3 = t_exp*tau**(t_exp-1)*taud
      END WHERE
      arg3d(:) = n_exp*(temp1*(temp2*tempd2+temp3*tempd3)+temp4*EXP(arg2(:&
      &     ))*arg2d(:))
      arg3(:) = n_exp*(temp4*temp1)
      ard = SUM(arg1d(:)) + SUM(arg3d(:))
      ar = SUM(arg1(:)) + SUM(arg3(:))
   end subroutine AR_PURE_D

!  Differentiation of ar_pure in reverse (adjoint) mode (with options noISIZE):
!   gradient     of useful results: tau ar delta
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_PURE_B(pure, delta, deltab, tau, taub, ar, arb)
      IMPLICIT NONE
      class(GERG2008PURE), INTENT(IN) :: pure
      REAL(pr), INTENT(IN) :: delta
      REAL(pr) :: deltab
      REAL(pr), INTENT(IN) :: tau
      REAL(pr) :: taub
      REAL(pr) :: ar
      REAL(pr) :: arb
      INTEGER :: i, kpol, kexp
      REAL(pr) :: n_pol(pure%kpol), d_pol(pure%kpol), t_pol(pure%kpol)
      REAL(pr) :: n_exp(pure%kexp), d_exp(pure%kexp), t_exp(pure%kexp)
      REAL(pr) :: c_exp(pure%kexp)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(pure%kpol) :: arg1
      REAL(pr), DIMENSION(pure%kpol) :: arg1b
      REAL(pr), DIMENSION(pure%kexp) :: arg2
      REAL(pr), DIMENSION(pure%kexp) :: arg2b
      REAL(pr), DIMENSION(pure%kexp) :: arg3
      REAL(pr), DIMENSION(pure%kexp) :: arg3b
      REAL(pr), DIMENSION(pure%kexp) :: tempb
      REAL(pr), DIMENSION(pure%kexp) :: temp
      REAL(pr), DIMENSION(pure%kexp) :: temp0
      kpol = pure%kpol
      kexp = pure%kexp
      n_pol = pure%n(1:kpol)
      d_pol = pure%d(1:kpol)
      t_pol = pure%t(1:kpol)
      n_exp = pure%n(kpol+1:kpol+kexp)
      d_exp = pure%d(kpol+1:kpol+kexp)
      t_exp = pure%t(kpol+1:kpol+kexp)
      c_exp = pure%c
      arg1(:) = n_pol*delta**d_pol*tau**t_pol
      arg2(:) = -(delta**c_exp)
      arg3(:) = n_exp*delta**d_exp*tau**t_exp*EXP(arg2(:))
      arg1b = 0.0_pr
      arg3b = 0.0_pr
      arg1b = arb
      arg3b = arb
      arg2b = 0.0_pr
      temp = tau**t_exp
      temp0 = delta**d_exp
      tempb = EXP(arg2)*n_exp*arg3b
      arg2b = EXP(arg2)*temp0*temp*n_exp*arg3b
      deltab = deltab + SUM(d_exp*delta**(d_exp-1)*temp*tempb, MASK=.NOT.(&
      &     delta.LE.0.0.AND.(d_exp.EQ.0.0.OR.d_exp.NE.INT(d_exp)))) + SUM(&
      &     d_pol*delta**(d_pol-1)*tau**t_pol*n_pol*arg1b, MASK=.NOT.(delta&
      &     .LE.0.0.AND.(d_pol.EQ.0.0.OR.d_pol.NE.INT(d_pol)))) - SUM(c_exp*&
      &     delta**(c_exp-1)*arg2b, MASK=.NOT.(delta.LE.0.0.AND.(c_exp.EQ.0.0&
      &     .OR.c_exp.NE.INT(c_exp))))
      taub = taub + SUM(t_exp*tau**(t_exp-1)*temp0*tempb, MASK=.NOT.(tau&
      &     .LE.0.0.AND.(t_exp.EQ.0.0.OR.t_exp.NE.INT(t_exp)))) + SUM(t_pol*&
      &     tau**(t_pol-1)*delta**d_pol*n_pol*arg1b, MASK=.NOT.(tau.LE.0.0&
      &     .AND.(t_pol.EQ.0.0.OR.t_pol.NE.INT(t_pol))))
   end subroutine AR_PURE_B

   SUBROUTINE AR_PURE(pure, delta, tau, ar)
      IMPLICIT NONE
      class(GERG2008PURE), INTENT(IN) :: pure
      REAL(pr), INTENT(IN) :: delta
      REAL(pr), INTENT(IN) :: tau
      REAL(pr), INTENT(OUT) :: ar
      INTEGER :: i, kpol, kexp
      REAL(pr) :: n_pol(pure%kpol), d_pol(pure%kpol), t_pol(pure%kpol)
      REAL(pr) :: n_exp(pure%kexp), d_exp(pure%kexp), t_exp(pure%kexp)
      REAL(pr) :: c_exp(pure%kexp)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(pure%kpol) :: arg1
      REAL(pr), DIMENSION(pure%kexp) :: arg2
      REAL(pr), DIMENSION(pure%kexp) :: arg3
      kpol = pure%kpol
      kexp = pure%kexp
      n_pol = pure%n(1:kpol)
      d_pol = pure%d(1:kpol)
      t_pol = pure%t(1:kpol)
      n_exp = pure%n(kpol+1:kpol+kexp)
      d_exp = pure%d(kpol+1:kpol+kexp)
      t_exp = pure%t(kpol+1:kpol+kexp)
      c_exp = pure%c
      arg1(:) = n_pol*delta**d_pol*tau**t_pol
      arg2(:) = -(delta**c_exp)
      arg3(:) = n_exp*delta**d_exp*tau**t_exp*EXP(arg2(:))
      ar = SUM(arg1(:)) + SUM(arg3(:))
   end subroutine AR_PURE

!  Differentiation of ar_ij_d_d in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: aijd0 aijd aijdd aij
!   with respect to varying inputs: taudd taud tau deltad0 deltad
!                taud0 delta deltadd
!  Differentiation of ar_ij_d in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: aijd aij
!   with respect to varying inputs: taud tau deltad delta
!  Differentiation of ar_ij in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: aij
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_IJ_D_D_D(model, delta, deltad1, deltad0, deltad0d, &
   &   deltad, deltadd0, deltadd, deltaddd, tau, taud1, taud0, taud0d, taud&
   &   , taudd0, taudd, tauddd, binary, aij, aijd1, aijd0, aijd0d, aijd, &
   &   aijdd0, aijdd, aijddd)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: delta
      REAL(pr), INTENT(IN) :: deltad1
      REAL(pr), INTENT(IN) :: deltad0
      REAL(pr), INTENT(IN) :: deltad0d
      REAL(pr), INTENT(IN) :: deltad
      REAL(pr), INTENT(IN) :: deltadd0
      REAL(pr), INTENT(IN) :: deltadd
      REAL(pr), INTENT(IN) :: deltaddd
      REAL(pr), INTENT(IN) :: tau
      REAL(pr), INTENT(IN) :: taud1
      REAL(pr), INTENT(IN) :: taud0
      REAL(pr), INTENT(IN) :: taud0d
      REAL(pr), INTENT(IN) :: taud
      REAL(pr), INTENT(IN) :: taudd0
      REAL(pr), INTENT(IN) :: taudd
      REAL(pr), INTENT(IN) :: tauddd
      class(GERG2008BINARY), INTENT(IN) :: binary
      REAL(pr), INTENT(OUT) :: aij
      REAL(pr), INTENT(OUT) :: aijd1
      REAL(pr), INTENT(OUT) :: aijd0
      REAL(pr), INTENT(OUT) :: aijd0d
      REAL(pr), INTENT(OUT) :: aijd
      REAL(pr), INTENT(OUT) :: aijdd0
      REAL(pr), INTENT(OUT) :: aijdd
      REAL(pr), INTENT(OUT) :: aijddd
      INTEGER :: idx_poly, idx_exp
      INTEGER :: k
      REAL(pr) :: n_pol(binary%kpolij), d_pol(binary%kpolij), t_pol(binary%&
      &   kpolij)
      REAL(pr) :: n_exp(binary%kexpij), d_exp(binary%kexpij), t_exp(binary%&
      &   kexpij)
      REAL(pr) :: etha(binary%kexpij), eps(binary%kexpij), beta(binary%&
      &   kexpij), gama(binary%kexpij)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(binary%kpolij) :: arg1
      REAL(pr), DIMENSION(binary%kpolij) :: arg1d1
      REAL(pr), DIMENSION(binary%kpolij) :: arg1d0
      REAL(pr), DIMENSION(binary%kpolij) :: arg1d0d
      REAL(pr), DIMENSION(binary%kpolij) :: arg1d
      REAL(pr), DIMENSION(binary%kpolij) :: arg1dd0
      REAL(pr), DIMENSION(binary%kpolij) :: arg1dd
      REAL(pr), DIMENSION(binary%kpolij) :: arg1ddd
      REAL(pr), DIMENSION(binary%kexpij) :: arg2
      REAL(pr), DIMENSION(binary%kexpij) :: arg2d1
      REAL(pr), DIMENSION(binary%kexpij) :: arg2d0
      REAL(pr), DIMENSION(binary%kexpij) :: arg2d0d
      REAL(pr), DIMENSION(binary%kexpij) :: arg2d
      REAL(pr), DIMENSION(binary%kexpij) :: arg2dd0
      REAL(pr), DIMENSION(binary%kexpij) :: arg2dd
      REAL(pr), DIMENSION(binary%kexpij) :: arg2ddd
      REAL(pr), DIMENSION(binary%kexpij) :: arg3
      REAL(pr), DIMENSION(binary%kexpij) :: arg3d1
      REAL(pr), DIMENSION(binary%kexpij) :: arg3d0
      REAL(pr), DIMENSION(binary%kexpij) :: arg3d0d
      REAL(pr), DIMENSION(binary%kexpij) :: arg3d
      REAL(pr), DIMENSION(binary%kexpij) :: arg3dd0
      REAL(pr), DIMENSION(binary%kexpij) :: arg3dd
      REAL(pr), DIMENSION(binary%kexpij) :: arg3ddd
      REAL(pr), DIMENSION(binary%kpolij) :: temp
      REAL(pr), DIMENSION(binary%kpolij) :: tempd6
      REAL(pr), DIMENSION(binary%kpolij) :: tempd3
      REAL(pr), DIMENSION(binary%kpolij) :: tempd3d
      REAL(pr), DIMENSION(binary%kpolij) :: temp0
      REAL(pr), DIMENSION(binary%kpolij) :: temp0d0
      REAL(pr), DIMENSION(binary%kpolij) :: temp0d
      REAL(pr), DIMENSION(binary%kpolij) :: temp0dd
      REAL(pr), DIMENSION(binary%kpolij) :: tempd
      REAL(pr), DIMENSION(binary%kpolij) :: tempdd0
      REAL(pr), DIMENSION(binary%kpolij) :: tempdd
      REAL(pr), DIMENSION(binary%kpolij) :: tempddd
      REAL(pr), DIMENSION(binary%kpolij) :: tempd0
      REAL(pr), DIMENSION(binary%kpolij) :: tempd0d0
      REAL(pr), DIMENSION(binary%kpolij) :: tempd0d
      REAL(pr), DIMENSION(binary%kpolij) :: tempd0dd
      REAL(pr), DIMENSION(binary%kexpij) :: temp1
      REAL(pr), DIMENSION(binary%kexpij) :: temp1d0
      REAL(pr), DIMENSION(binary%kexpij) :: temp1d
      REAL(pr), DIMENSION(binary%kexpij) :: temp1dd
      REAL(pr), DIMENSION(binary%kexpij) :: temp2
      REAL(pr), DIMENSION(binary%kexpij) :: temp2d0
      REAL(pr), DIMENSION(binary%kexpij) :: temp2d
      REAL(pr), DIMENSION(binary%kexpij) :: temp2dd
      REAL(pr), DIMENSION(binary%kexpij) :: temp3
      REAL(pr), DIMENSION(binary%kexpij) :: temp3d0
      REAL(pr), DIMENSION(binary%kexpij) :: temp3d
      REAL(pr), DIMENSION(binary%kexpij) :: temp3dd
      REAL(pr), DIMENSION(binary%kexpij) :: tempd1
      REAL(pr), DIMENSION(binary%kexpij) :: tempd1d0
      REAL(pr), DIMENSION(binary%kexpij) :: tempd1d
      REAL(pr), DIMENSION(binary%kexpij) :: tempd1dd
      REAL(pr), DIMENSION(binary%kexpij) :: tempd2
      REAL(pr), DIMENSION(binary%kexpij) :: tempd2d0
      REAL(pr), DIMENSION(binary%kexpij) :: tempd2d
      REAL(pr), DIMENSION(binary%kexpij) :: tempd2dd
      REAL(pr), DIMENSION(binary%kexpij) :: temp4
      REAL(pr), DIMENSION(binary%kexpij) :: temp4d0
      REAL(pr), DIMENSION(binary%kexpij) :: temp4d
      REAL(pr), DIMENSION(binary%kexpij) :: temp4dd
      INTRINSIC INT
      REAL(pr), DIMENSION(binary%kpolij) :: temp5
      REAL(pr), DIMENSION(binary%kpolij) :: temp5d
      REAL(pr), DIMENSION(binary%kpolij) :: tempd4
      REAL(pr), DIMENSION(binary%kpolij) :: tempd4d
      REAL(pr), DIMENSION(binary%kexpij) :: temp6
      REAL(pr), DIMENSION(binary%kexpij) :: temp6d
      REAL(pr), DIMENSION(binary%kexpij) :: tempd5
      REAL(pr), DIMENSION(binary%kexpij) :: tempd5d
      REAL(pr), DIMENSION(binary%kexpij) :: temp7
      REAL(pr), DIMENSION(binary%kexpij) :: temp7d
      REAL(pr), DIMENSION(binary%kpolij) :: temp8
      REAL(pr), DIMENSION(binary%kpolij) :: tempd7
      REAL(pr), DIMENSION(binary%kexpij) :: temp9
      REAL(pr), DIMENSION(binary%kexpij) :: tempd8
      REAL(pr), DIMENSION(binary%kexpij) :: temp10
      REAL(pr), DIMENSION(binary%kexpij) :: temp11
      REAL(pr), DIMENSION(binary%kexpij) :: temp12
      LOGICAL, DIMENSION(binary%kpolij) :: mask
      LOGICAL, DIMENSION(binary%kpolij) :: mask0
      LOGICAL, DIMENSION(binary%kpolij) :: mask1
      LOGICAL, DIMENSION(binary%kpolij) :: mask2
      LOGICAL, DIMENSION(binary%kpolij) :: mask3
      LOGICAL, DIMENSION(binary%kpolij) :: mask4
      LOGICAL, DIMENSION(binary%kpolij) :: mask5
      LOGICAL, DIMENSION(binary%kpolij) :: mask6
      LOGICAL, DIMENSION(binary%kpolij) :: mask7
      LOGICAL, DIMENSION(binary%kpolij) :: mask8
      LOGICAL, DIMENSION(binary%kpolij) :: mask9
      LOGICAL, DIMENSION(binary%kpolij) :: mask10
      LOGICAL, DIMENSION(binary%kpolij) :: mask11
      LOGICAL, DIMENSION(binary%kpolij) :: mask12
      LOGICAL, DIMENSION(binary%kpolij) :: mask13
      LOGICAL, DIMENSION(binary%kpolij) :: mask14
      LOGICAL, DIMENSION(binary%kpolij) :: mask15
      LOGICAL, DIMENSION(binary%kpolij) :: mask16
      LOGICAL, DIMENSION(binary%kpolij) :: mask17
      LOGICAL, DIMENSION(binary%kpolij) :: mask18
      LOGICAL, DIMENSION(binary%kpolij) :: mask19
      LOGICAL, DIMENSION(binary%kpolij) :: mask20
      LOGICAL, DIMENSION(binary%kpolij) :: mask21
      LOGICAL, DIMENSION(binary%kpolij) :: mask22
      LOGICAL, DIMENSION(binary%kexpij) :: mask23
      LOGICAL, DIMENSION(binary%kexpij) :: mask24
      LOGICAL, DIMENSION(binary%kexpij) :: mask25
      LOGICAL, DIMENSION(binary%kexpij) :: mask26
      LOGICAL, DIMENSION(binary%kexpij) :: mask27
      LOGICAL, DIMENSION(binary%kexpij) :: mask28
      LOGICAL, DIMENSION(binary%kexpij) :: mask29
      LOGICAL, DIMENSION(binary%kexpij) :: mask30
      LOGICAL, DIMENSION(binary%kexpij) :: mask31
      LOGICAL, DIMENSION(binary%kexpij) :: mask32
      LOGICAL, DIMENSION(binary%kexpij) :: mask33
      LOGICAL, DIMENSION(binary%kexpij) :: mask34
      LOGICAL, DIMENSION(binary%kexpij) :: mask35
      LOGICAL, DIMENSION(binary%kexpij) :: mask36
      LOGICAL, DIMENSION(binary%kexpij) :: mask37
      LOGICAL, DIMENSION(binary%kexpij) :: mask38
      LOGICAL, DIMENSION(binary%kexpij) :: mask39
      LOGICAL, DIMENSION(binary%kexpij) :: mask40
      LOGICAL, DIMENSION(binary%kexpij) :: mask41
      LOGICAL, DIMENSION(binary%kexpij) :: mask42
      LOGICAL, DIMENSION(binary%kexpij) :: mask43
      LOGICAL, DIMENSION(binary%kexpij) :: mask44
      LOGICAL, DIMENSION(binary%kexpij) :: mask45
      LOGICAL, DIMENSION(binary%kexpij) :: mask46
      idx_poly = binary%kpolij
      idx_exp = binary%kexpij + idx_poly
      n_pol = binary%nij(1:idx_poly)
      d_pol = binary%dij(1:idx_poly)
      t_pol = binary%tij(1:idx_poly)
      n_exp = binary%nij(idx_poly+1:idx_exp)
      d_exp = binary%dij(idx_poly+1:idx_exp)
      t_exp = binary%tij(idx_poly+1:idx_exp)
      etha = binary%ethaij(1:binary%kexpij)
      eps = binary%epsij(1:binary%kexpij)
      beta = binary%betaij(1:binary%kexpij)
      gama = binary%gammaij(1:binary%kexpij)
      mask = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol)&
      &     )
      WHERE (mask) tempd3 = 0.0_pr
      tempd3d = 0.0_pr
      mask0 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT&
      &     (t_pol)))
      WHERE (mask0)
         temp8 = tau**(t_pol-1)
         mask1 = tau .LE. 0.0 .AND. (t_pol - 1 .EQ. 0.0 .OR. t_pol - 1 .NE.&
         &       INT(t_pol - 1))
         WHERE (mask1)
            tempd7 = 0.0_pr
         ELSEWHERE
            tempd7 = (t_pol-1)*tau**(t_pol-2)*taud1
         END WHERE
         tempd3d = t_pol*(taud0*tempd7+temp8*taud0d)
         tempd3 = t_pol*(temp8*taud0)
      END WHERE
      mask2 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol&
      &     ))
      WHERE (mask2)
         tempd6 = 0.0_pr
      ELSEWHERE
         tempd6 = t_pol*tau**(t_pol-1)*taud1
      END WHERE
      temp = tau**t_pol
      mask3 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask3) temp0d = 0.0_pr
      temp0dd = 0.0_pr
      mask4 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask4)
         temp8 = delta**(d_pol-1)
         mask5 = delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol - 1 &
         &       .NE. INT(d_pol - 1))
         WHERE (mask5)
            tempd7 = 0.0_pr
         ELSEWHERE
            tempd7 = (d_pol-1)*delta**(d_pol-2)*deltad1
         END WHERE
         temp0dd = d_pol*(deltad0*tempd7+temp8*deltad0d)
         temp0d = d_pol*(temp8*deltad0)
      END WHERE
      mask6 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask6)
         temp0d0 = 0.0_pr
      ELSEWHERE
         temp0d0 = d_pol*delta**(d_pol-1)*deltad1
      END WHERE
      temp0 = delta**d_pol
      mask7 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask7) tempd = 0.0_pr
      tempdd = 0.0_pr
      temp5d = 0.0_pr
      mask8 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask8)
         mask9 = delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol - 1 &
         &       .NE. INT(d_pol - 1))
         WHERE (mask9)
            temp5d = 0.0_pr
         ELSEWHERE
            temp5d = (d_pol-1)*delta**(d_pol-2)*deltad1
         END WHERE
         temp5 = delta**(d_pol-1)
         mask10 = delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol - 1 &
         &       .NE. INT(d_pol - 1))
         WHERE (mask10) tempd4 = 0.0_pr
      END WHERE
      tempd4d = 0.0_pr
      mask11 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask11)
         mask12 = .NOT.(delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol&
         &       - 1 .NE. INT(d_pol - 1)))
         WHERE (mask12)
            temp8 = delta**(d_pol-2)
            mask13 = delta .LE. 0.0 .AND. (d_pol - 2 .EQ. 0.0 .OR. d_pol - 2&
            &         .NE. INT(d_pol - 2))
            WHERE (mask13)
               tempd7 = 0.0_pr
            ELSEWHERE
               tempd7 = (d_pol-2)*delta**(d_pol-3)*deltad1
            END WHERE
            tempd4d = (d_pol-1)*(deltad0*tempd7+temp8*deltad0d)
            tempd4 = (d_pol-1)*(temp8*deltad0)
         END WHERE
      END WHERE
      tempddd = 0.0_pr
      mask14 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask14)
         tempddd = d_pol*(tempd4*deltadd0+deltad*tempd4d+deltadd*temp5d+&
         &       temp5*deltaddd)
         tempdd = d_pol*(deltad*tempd4+temp5*deltadd)
      END WHERE
      tempdd0 = 0.0_pr
      mask15 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask15)
         tempdd0 = d_pol*(deltad*temp5d+temp5*deltadd0)
         tempd = d_pol*(temp5*deltad)
      END WHERE
      mask16 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(&
      &     t_pol))
      WHERE (mask16) tempd0 = 0.0_pr
      tempd0d = 0.0_pr
      mask17 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. &
      &     INT(t_pol)))
      WHERE (mask17)
         mask18 = tau .LE. 0.0 .AND. (t_pol - 1 .EQ. 0.0 .OR. t_pol - 1 &
         &       .NE. INT(t_pol - 1))
         WHERE (mask18)
            temp5d = 0.0_pr
         ELSEWHERE
            temp5d = (t_pol-1)*tau**(t_pol-2)*taud1
         END WHERE
         temp5 = tau**(t_pol-1)
         mask19 = tau .LE. 0.0 .AND. (t_pol - 1 .EQ. 0.0 .OR. t_pol - 1 &
         &       .NE. INT(t_pol - 1))
         WHERE (mask19)
            tempd4d = 0.0_pr
            tempd4 = 0.0_pr
         ELSEWHERE
            temp8 = tau**(t_pol-2)
            mask20 = tau .LE. 0.0 .AND. (t_pol - 2 .EQ. 0.0 .OR. t_pol - 2 &
            &         .NE. INT(t_pol - 2))
            WHERE (mask20)
               tempd7 = 0.0_pr
            ELSEWHERE
               tempd7 = (t_pol-2)*tau**(t_pol-3)*taud1
            END WHERE
            tempd4d = (t_pol-1)*(taud0*tempd7+temp8*taud0d)
            tempd4 = (t_pol-1)*(temp8*taud0)
         END WHERE
      END WHERE
      tempd0dd = 0.0_pr
      mask21 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. &
      &     INT(t_pol)))
      WHERE (mask21)
         tempd0dd = t_pol*(tempd4*taudd0+taud*tempd4d+taudd*temp5d+temp5*&
         &       tauddd)
         tempd0d = t_pol*(taud*tempd4+temp5*taudd)
      END WHERE
      tempd0d0 = 0.0_pr
      mask22 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. &
      &     INT(t_pol)))
      WHERE (mask22)
         tempd0d0 = t_pol*(taud*temp5d+temp5*taudd0)
         tempd0 = t_pol*(temp5*taud)
      END WHERE
      arg1ddd(:) = n_pol*(tempd3*tempdd0+tempd*tempd3d+tempdd*tempd6+temp*&
      &     tempddd+temp0d*tempd0d0+tempd0*temp0dd+tempd0d*temp0d0+temp0*&
      &     tempd0dd)
      arg1dd(:) = n_pol*(tempd*tempd3+temp*tempdd+tempd0*temp0d+temp0*&
      &     tempd0d)
      arg1dd0(:) = n_pol*(tempd*tempd6+temp*tempdd0+tempd0*temp0d0+temp0*&
      &     tempd0d0)
      arg1d(:) = n_pol*(temp*tempd+temp0*tempd0)
      arg1d0d(:) = n_pol*(temp0d*tempd6+temp*temp0dd+tempd3*temp0d0+temp0*&
      &     tempd3d)
      arg1d0(:) = n_pol*(temp*temp0d+temp0*tempd3)
      arg1d1(:) = n_pol*(temp*temp0d0+temp0*tempd6)
      arg1(:) = n_pol*(temp0*temp)
      temp6d = etha*2*deltad1
      temp6 = beta + 2*etha*(delta-eps)
      arg2ddd(:) = -(etha*2*(deltad0*deltadd0+deltad*deltad0d)) - deltadd*&
      &     temp6d - temp6*deltaddd
      arg2dd(:) = -(deltad*etha*2*deltad0+temp6*deltadd)
      arg2dd0(:) = -(deltad*temp6d+temp6*deltadd0)
      arg2d(:) = -(temp6*deltad)
      temp9 = beta + 2*etha*(delta-eps)
      arg2d0d(:) = -(deltad0*etha*2*deltad1+temp9*deltad0d)
      arg2d0(:) = -(temp9*deltad0)
      arg2d1(:) = -((etha*2*(delta-eps)+beta)*deltad1)
      arg2(:) = -(etha*(delta-eps)**2) - beta*(delta-gama)
      temp9 = EXP(arg2(:))
      temp1dd = arg2d0(:)*EXP(arg2(:))*arg2d1(:) + temp9*arg2d0d(:)
      temp1d = temp9*arg2d0(:)
      temp1d0 = EXP(arg2(:))*arg2d1(:)
      temp1 = EXP(arg2(:))
      mask23 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(&
      &     t_exp))
      WHERE (mask23) temp2d = 0.0_pr
      temp2dd = 0.0_pr
      mask24 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask24)
         temp9 = tau**(t_exp-1)
         mask25 = tau .LE. 0.0 .AND. (t_exp - 1 .EQ. 0.0 .OR. t_exp - 1 &
         &       .NE. INT(t_exp - 1))
         WHERE (mask25)
            tempd8 = 0.0_pr
         ELSEWHERE
            tempd8 = (t_exp-1)*tau**(t_exp-2)*taud1
         END WHERE
         temp2dd = t_exp*(taud0*tempd8+temp9*taud0d)
         temp2d = t_exp*(temp9*taud0)
      END WHERE
      mask26 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(&
      &     t_exp))
      WHERE (mask26)
         temp2d0 = 0.0_pr
      ELSEWHERE
         temp2d0 = t_exp*tau**(t_exp-1)*taud1
      END WHERE
      temp2 = tau**t_exp
      mask27 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask27) temp3d = 0.0_pr
      temp3dd = 0.0_pr
      mask28 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask28)
         temp9 = delta**(d_exp-1)
         mask29 = delta .LE. 0.0 .AND. (d_exp - 1 .EQ. 0.0 .OR. d_exp - 1 &
         &       .NE. INT(d_exp - 1))
         WHERE (mask29)
            tempd8 = 0.0_pr
         ELSEWHERE
            tempd8 = (d_exp-1)*delta**(d_exp-2)*deltad1
         END WHERE
         temp3dd = d_exp*(deltad0*tempd8+temp9*deltad0d)
         temp3d = d_exp*(temp9*deltad0)
      END WHERE
      mask30 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask30)
         temp3d0 = 0.0_pr
      ELSEWHERE
         temp3d0 = d_exp*delta**(d_exp-1)*deltad1
      END WHERE
      temp3 = delta**d_exp
      temp4dd = temp3d*temp2d0 + temp2*temp3dd + temp2d*temp3d0 + temp3*&
      &     temp2dd
      temp4d = temp2*temp3d + temp3*temp2d
      temp4d0 = temp2*temp3d0 + temp3*temp2d0
      temp4 = temp3*temp2
      mask31 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask31) tempd1 = 0.0_pr
      tempd1d = 0.0_pr
      mask32 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask32)
         mask33 = delta .LE. 0.0 .AND. (d_exp - 1 .EQ. 0.0 .OR. d_exp - 1 &
         &       .NE. INT(d_exp - 1))
         WHERE (mask33)
            temp6d = 0.0_pr
         ELSEWHERE
            temp6d = (d_exp-1)*delta**(d_exp-2)*deltad1
         END WHERE
         temp6 = delta**(d_exp-1)
         mask34 = delta .LE. 0.0 .AND. (d_exp - 1 .EQ. 0.0 .OR. d_exp - 1 &
         &       .NE. INT(d_exp - 1))
         WHERE (mask34) tempd5 = 0.0_pr
      END WHERE
      tempd5d = 0.0_pr
      mask35 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask35)
         mask36 = .NOT.(delta .LE. 0.0 .AND. (d_exp - 1 .EQ. 0.0 .OR. d_exp&
         &       - 1 .NE. INT(d_exp - 1)))
         WHERE (mask36)
            temp9 = delta**(d_exp-2)
            mask37 = delta .LE. 0.0 .AND. (d_exp - 2 .EQ. 0.0 .OR. d_exp - 2&
            &         .NE. INT(d_exp - 2))
            WHERE (mask37)
               tempd8 = 0.0_pr
            ELSEWHERE
               tempd8 = (d_exp-2)*delta**(d_exp-3)*deltad1
            END WHERE
            tempd5d = (d_exp-1)*(deltad0*tempd8+temp9*deltad0d)
            tempd5 = (d_exp-1)*(temp9*deltad0)
         END WHERE
      END WHERE
      tempd1dd = 0.0_pr
      mask38 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask38)
         tempd1dd = d_exp*(tempd5*deltadd0+deltad*tempd5d+deltadd*temp6d+&
         &       temp6*deltaddd)
         tempd1d = d_exp*(deltad*tempd5+temp6*deltadd)
      END WHERE
      tempd1d0 = 0.0_pr
      mask39 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask39)
         tempd1d0 = d_exp*(deltad*temp6d+temp6*deltadd0)
         tempd1 = d_exp*(temp6*deltad)
      END WHERE
      mask40 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(&
      &     t_exp))
      WHERE (mask40) tempd2 = 0.0_pr
      tempd2d = 0.0_pr
      mask41 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask41)
         mask42 = tau .LE. 0.0 .AND. (t_exp - 1 .EQ. 0.0 .OR. t_exp - 1 &
         &       .NE. INT(t_exp - 1))
         WHERE (mask42)
            temp6d = 0.0_pr
         ELSEWHERE
            temp6d = (t_exp-1)*tau**(t_exp-2)*taud1
         END WHERE
         temp6 = tau**(t_exp-1)
         mask43 = tau .LE. 0.0 .AND. (t_exp - 1 .EQ. 0.0 .OR. t_exp - 1 &
         &       .NE. INT(t_exp - 1))
         WHERE (mask43)
            tempd5d = 0.0_pr
            tempd5 = 0.0_pr
         ELSEWHERE
            temp9 = tau**(t_exp-2)
            mask44 = tau .LE. 0.0 .AND. (t_exp - 2 .EQ. 0.0 .OR. t_exp - 2 &
            &         .NE. INT(t_exp - 2))
            WHERE (mask44)
               tempd8 = 0.0_pr
            ELSEWHERE
               tempd8 = (t_exp-2)*tau**(t_exp-3)*taud1
            END WHERE
            tempd5d = (t_exp-1)*(taud0*tempd8+temp9*taud0d)
            tempd5 = (t_exp-1)*(temp9*taud0)
         END WHERE
      END WHERE
      tempd2dd = 0.0_pr
      mask45 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask45)
         tempd2dd = t_exp*(tempd5*taudd0+taud*tempd5d+taudd*temp6d+temp6*&
         &       tauddd)
         tempd2d = t_exp*(taud*tempd5+temp6*taudd)
      END WHERE
      tempd2d0 = 0.0_pr
      mask46 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask46)
         tempd2d0 = t_exp*(taud*temp6d+temp6*taudd0)
         tempd2 = t_exp*(temp6*taud)
      END WHERE
      temp6d = tempd1*temp2d0 + temp2*tempd1d0 + tempd2*temp3d0 + temp3*&
      &     tempd2d0
      temp6 = temp2*tempd1 + temp3*tempd2
      temp7d = EXP(arg2(:))*arg2d1(:)
      temp7 = EXP(arg2(:))
      temp9 = tempd1*temp2d + temp2*tempd1d + tempd2*temp3d + temp3*&
      &     tempd2d
      temp10 = EXP(arg2(:))
      temp11 = temp4*arg2d(:)*arg2d0(:)
      temp12 = arg2d(:)*temp4d + temp4*arg2dd(:)
      arg3ddd(:) = n_exp*(temp1d*temp6d+temp6*temp1dd+temp9*temp1d0+temp1*&
      &     (temp2d*tempd1d0+tempd1*temp2dd+tempd1d*temp2d0+temp2*tempd1dd+&
      &     temp3d*tempd2d0+tempd2*temp3dd+tempd2d*temp3d0+temp3*tempd2dd)+&
      &     temp10*(arg2d0(:)*(arg2d(:)*temp4d0+temp4*arg2dd0(:))+temp4*arg2d(&
      &     :)*arg2d0d(:))+temp11*EXP(arg2(:))*arg2d1(:)+temp12*temp7d+temp7*(&
      &     temp4d*arg2dd0(:)+arg2d(:)*temp4dd+arg2dd(:)*temp4d0+temp4*arg2ddd&
      &     (:)))
      arg3dd(:) = n_exp*(temp6*temp1d+temp1*temp9+temp11*temp10+temp7*&
      &     temp12)
      arg3dd0(:) = n_exp*(temp6*temp1d0+temp1*temp6d+arg2d(:)*(temp4*&
      &     temp7d+temp7*temp4d0)+temp7*temp4*arg2dd0(:))
      arg3d(:) = n_exp*(temp1*temp6+temp7*(temp4*arg2d(:)))
      arg3d0d(:) = n_exp*(temp4d*temp1d0+temp1*temp4dd+temp1d*temp4d0+&
      &     temp4*temp1dd)
      arg3d0(:) = n_exp*(temp1*temp4d+temp4*temp1d)
      arg3d1(:) = n_exp*(temp1*temp4d0+temp4*temp1d0)
      arg3(:) = n_exp*(temp4*temp1)
      aijddd = SUM(arg1ddd(:)) + SUM(arg3ddd(:))
      aijdd = SUM(arg1dd(:)) + SUM(arg3dd(:))
      aijdd0 = SUM(arg1dd0(:)) + SUM(arg3dd0(:))
      aijd = SUM(arg1d(:)) + SUM(arg3d(:))
      aijd0d = SUM(arg1d0d(:)) + SUM(arg3d0d(:))
      aijd0 = SUM(arg1d0(:)) + SUM(arg3d0(:))
      aijd1 = SUM(arg1d1(:)) + SUM(arg3d1(:))
      aij = SUM(arg1(:)) + SUM(arg3(:))
   end subroutine AR_IJ_D_D_D

!  Differentiation of ar_ij_d in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: aijd aij
!   with respect to varying inputs: taud tau deltad delta
!  Differentiation of ar_ij in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: aij
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_IJ_D_D(model, delta, deltad0, deltad, deltadd, tau, &
   &   taud0, taud, taudd, binary, aij, aijd0, aijd, aijdd)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: delta
      REAL(pr), INTENT(IN) :: deltad0
      REAL(pr), INTENT(IN) :: deltad
      REAL(pr), INTENT(IN) :: deltadd
      REAL(pr), INTENT(IN) :: tau
      REAL(pr), INTENT(IN) :: taud0
      REAL(pr), INTENT(IN) :: taud
      REAL(pr), INTENT(IN) :: taudd
      class(GERG2008BINARY), INTENT(IN) :: binary
      REAL(pr), INTENT(OUT) :: aij
      REAL(pr), INTENT(OUT) :: aijd0
      REAL(pr), INTENT(OUT) :: aijd
      REAL(pr), INTENT(OUT) :: aijdd
      INTEGER :: idx_poly, idx_exp
      INTEGER :: k
      REAL(pr) :: n_pol(binary%kpolij), d_pol(binary%kpolij), t_pol(binary%&
      &   kpolij)
      REAL(pr) :: n_exp(binary%kexpij), d_exp(binary%kexpij), t_exp(binary%&
      &   kexpij)
      REAL(pr) :: etha(binary%kexpij), eps(binary%kexpij), beta(binary%&
      &   kexpij), gama(binary%kexpij)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(binary%kpolij) :: arg1
      REAL(pr), DIMENSION(binary%kpolij) :: arg1d0
      REAL(pr), DIMENSION(binary%kpolij) :: arg1d
      REAL(pr), DIMENSION(binary%kpolij) :: arg1dd
      REAL(pr), DIMENSION(binary%kexpij) :: arg2
      REAL(pr), DIMENSION(binary%kexpij) :: arg2d0
      REAL(pr), DIMENSION(binary%kexpij) :: arg2d
      REAL(pr), DIMENSION(binary%kexpij) :: arg2dd
      REAL(pr), DIMENSION(binary%kexpij) :: arg3
      REAL(pr), DIMENSION(binary%kexpij) :: arg3d0
      REAL(pr), DIMENSION(binary%kexpij) :: arg3d
      REAL(pr), DIMENSION(binary%kexpij) :: arg3dd
      REAL(pr), DIMENSION(binary%kpolij) :: temp
      REAL(pr), DIMENSION(binary%kpolij) :: tempd3
      REAL(pr), DIMENSION(binary%kpolij) :: temp0
      REAL(pr), DIMENSION(binary%kpolij) :: temp0d
      REAL(pr), DIMENSION(binary%kpolij) :: tempd
      REAL(pr), DIMENSION(binary%kpolij) :: tempdd
      REAL(pr), DIMENSION(binary%kpolij) :: tempd0
      REAL(pr), DIMENSION(binary%kpolij) :: tempd0d
      REAL(pr), DIMENSION(binary%kexpij) :: temp1
      REAL(pr), DIMENSION(binary%kexpij) :: temp1d
      REAL(pr), DIMENSION(binary%kexpij) :: temp2
      REAL(pr), DIMENSION(binary%kexpij) :: temp2d
      REAL(pr), DIMENSION(binary%kexpij) :: temp3
      REAL(pr), DIMENSION(binary%kexpij) :: temp3d
      REAL(pr), DIMENSION(binary%kexpij) :: tempd1
      REAL(pr), DIMENSION(binary%kexpij) :: tempd1d
      REAL(pr), DIMENSION(binary%kexpij) :: tempd2
      REAL(pr), DIMENSION(binary%kexpij) :: tempd2d
      REAL(pr), DIMENSION(binary%kexpij) :: temp4
      REAL(pr), DIMENSION(binary%kexpij) :: temp4d
      INTRINSIC INT
      REAL(pr), DIMENSION(binary%kpolij) :: temp5
      REAL(pr), DIMENSION(binary%kpolij) :: tempd4
      REAL(pr), DIMENSION(binary%kexpij) :: temp6
      REAL(pr), DIMENSION(binary%kexpij) :: tempd5
      REAL(pr), DIMENSION(binary%kexpij) :: temp7
      LOGICAL, DIMENSION(binary%kpolij) :: mask
      LOGICAL, DIMENSION(binary%kpolij) :: mask0
      LOGICAL, DIMENSION(binary%kpolij) :: mask1
      LOGICAL, DIMENSION(binary%kpolij) :: mask2
      LOGICAL, DIMENSION(binary%kpolij) :: mask3
      LOGICAL, DIMENSION(binary%kpolij) :: mask4
      LOGICAL, DIMENSION(binary%kpolij) :: mask5
      LOGICAL, DIMENSION(binary%kpolij) :: mask6
      LOGICAL, DIMENSION(binary%kexpij) :: mask7
      LOGICAL, DIMENSION(binary%kexpij) :: mask8
      LOGICAL, DIMENSION(binary%kexpij) :: mask9
      LOGICAL, DIMENSION(binary%kexpij) :: mask10
      LOGICAL, DIMENSION(binary%kexpij) :: mask11
      LOGICAL, DIMENSION(binary%kexpij) :: mask12
      LOGICAL, DIMENSION(binary%kexpij) :: mask13
      LOGICAL, DIMENSION(binary%kexpij) :: mask14
      idx_poly = binary%kpolij
      idx_exp = binary%kexpij + idx_poly
      n_pol = binary%nij(1:idx_poly)
      d_pol = binary%dij(1:idx_poly)
      t_pol = binary%tij(1:idx_poly)
      n_exp = binary%nij(idx_poly+1:idx_exp)
      d_exp = binary%dij(idx_poly+1:idx_exp)
      t_exp = binary%tij(idx_poly+1:idx_exp)
      etha = binary%ethaij(1:binary%kexpij)
      eps = binary%epsij(1:binary%kexpij)
      beta = binary%betaij(1:binary%kexpij)
      gama = binary%gammaij(1:binary%kexpij)
      mask = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol)&
      &     )
      WHERE (mask)
         tempd3 = 0.0_pr
      ELSEWHERE
         tempd3 = t_pol*tau**(t_pol-1)*taud0
      END WHERE
      temp = tau**t_pol
      mask0 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask0)
         temp0d = 0.0_pr
      ELSEWHERE
         temp0d = d_pol*delta**(d_pol-1)*deltad0
      END WHERE
      temp0 = delta**d_pol
      mask1 = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask1) tempd = 0.0_pr
      tempdd = 0.0_pr
      mask2 = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. &
      &     INT(d_pol)))
      WHERE (mask2)
         temp5 = delta**(d_pol-1)
         mask3 = delta .LE. 0.0 .AND. (d_pol - 1 .EQ. 0.0 .OR. d_pol - 1 &
         &       .NE. INT(d_pol - 1))
         WHERE (mask3)
            tempd4 = 0.0_pr
         ELSEWHERE
            tempd4 = (d_pol-1)*delta**(d_pol-2)*deltad0
         END WHERE
         tempdd = d_pol*(deltad*tempd4+temp5*deltadd)
         tempd = d_pol*(temp5*deltad)
      END WHERE
      mask4 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol&
      &     ))
      WHERE (mask4) tempd0 = 0.0_pr
      tempd0d = 0.0_pr
      mask5 = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT&
      &     (t_pol)))
      WHERE (mask5)
         temp5 = tau**(t_pol-1)
         mask6 = tau .LE. 0.0 .AND. (t_pol - 1 .EQ. 0.0 .OR. t_pol - 1 .NE.&
         &       INT(t_pol - 1))
         WHERE (mask6)
            tempd4 = 0.0_pr
         ELSEWHERE
            tempd4 = (t_pol-1)*tau**(t_pol-2)*taud0
         END WHERE
         tempd0d = t_pol*(taud*tempd4+temp5*taudd)
         tempd0 = t_pol*(temp5*taud)
      END WHERE
      arg1dd(:) = n_pol*(tempd*tempd3+temp*tempdd+tempd0*temp0d+temp0*&
      &     tempd0d)
      arg1d(:) = n_pol*(temp*tempd+temp0*tempd0)
      arg1d0(:) = n_pol*(temp*temp0d+temp0*tempd3)
      arg1(:) = n_pol*(temp0*temp)
      temp6 = beta + 2*etha*(delta-eps)
      arg2dd(:) = -(deltad*etha*2*deltad0+temp6*deltadd)
      arg2d(:) = -(temp6*deltad)
      arg2d0(:) = -((etha*2*(delta-eps)+beta)*deltad0)
      arg2(:) = -(etha*(delta-eps)**2) - beta*(delta-gama)
      temp1d = EXP(arg2(:))*arg2d0(:)
      temp1 = EXP(arg2(:))
      mask7 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(t_exp&
      &     ))
      WHERE (mask7)
         temp2d = 0.0_pr
      ELSEWHERE
         temp2d = t_exp*tau**(t_exp-1)*taud0
      END WHERE
      temp2 = tau**t_exp
      mask8 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask8)
         temp3d = 0.0_pr
      ELSEWHERE
         temp3d = d_exp*delta**(d_exp-1)*deltad0
      END WHERE
      temp3 = delta**d_exp
      temp4d = temp2*temp3d + temp3*temp2d
      temp4 = temp3*temp2
      mask9 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask9) tempd1 = 0.0_pr
      tempd1d = 0.0_pr
      mask10 = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. &
      &     INT(d_exp)))
      WHERE (mask10)
         temp6 = delta**(d_exp-1)
         mask11 = delta .LE. 0.0 .AND. (d_exp - 1 .EQ. 0.0 .OR. d_exp - 1 &
         &       .NE. INT(d_exp - 1))
         WHERE (mask11)
            tempd5 = 0.0_pr
         ELSEWHERE
            tempd5 = (d_exp-1)*delta**(d_exp-2)*deltad0
         END WHERE
         tempd1d = d_exp*(deltad*tempd5+temp6*deltadd)
         tempd1 = d_exp*(temp6*deltad)
      END WHERE
      mask12 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(&
      &     t_exp))
      WHERE (mask12) tempd2 = 0.0_pr
      tempd2d = 0.0_pr
      mask13 = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      WHERE (mask13)
         temp6 = tau**(t_exp-1)
         mask14 = tau .LE. 0.0 .AND. (t_exp - 1 .EQ. 0.0 .OR. t_exp - 1 &
         &       .NE. INT(t_exp - 1))
         WHERE (mask14)
            tempd5 = 0.0_pr
         ELSEWHERE
            tempd5 = (t_exp-1)*tau**(t_exp-2)*taud0
         END WHERE
         tempd2d = t_exp*(taud*tempd5+temp6*taudd)
         tempd2 = t_exp*(temp6*taud)
      END WHERE
      temp6 = temp2*tempd1 + temp3*tempd2
      temp7 = EXP(arg2(:))
      arg3dd(:) = n_exp*(temp6*temp1d+temp1*(tempd1*temp2d+temp2*tempd1d+&
      &     tempd2*temp3d+temp3*tempd2d)+temp4*arg2d(:)*EXP(arg2(:))*arg2d0(:)&
      &     +temp7*(arg2d(:)*temp4d+temp4*arg2dd(:)))
      arg3d(:) = n_exp*(temp1*temp6+temp7*(temp4*arg2d(:)))
      arg3d0(:) = n_exp*(temp1*temp4d+temp4*temp1d)
      arg3(:) = n_exp*(temp4*temp1)
      aijdd = SUM(arg1dd(:)) + SUM(arg3dd(:))
      aijd = SUM(arg1d(:)) + SUM(arg3d(:))
      aijd0 = SUM(arg1d0(:)) + SUM(arg3d0(:))
      aij = SUM(arg1(:)) + SUM(arg3(:))
   end subroutine AR_IJ_D_D

!  Differentiation of ar_ij_d in reverse (adjoint) mode (with options noISIZE):
!   gradient     of useful results: taud tau aijd deltad delta
!                aij
!   with respect to varying inputs: taud tau deltad delta
!  Differentiation of ar_ij in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: aij
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_IJ_D_B(model, delta, deltab, deltad, deltadb, tau, taub&
   &   , taud, taudb, binary, aij, aijb, aijd, aijdb)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: delta
      REAL(pr) :: deltab
      REAL(pr), INTENT(IN) :: deltad
      REAL(pr) :: deltadb
      REAL(pr), INTENT(IN) :: tau
      REAL(pr) :: taub
      REAL(pr), INTENT(IN) :: taud
      REAL(pr) :: taudb
      class(GERG2008BINARY), INTENT(IN) :: binary
      REAL(pr) :: aij
      REAL(pr) :: aijb
      REAL(pr) :: aijd
      REAL(pr) :: aijdb
      INTEGER :: idx_poly, idx_exp
      INTEGER :: k
      REAL(pr) :: n_pol(binary%kpolij), d_pol(binary%kpolij), t_pol(binary%&
      &   kpolij)
      REAL(pr) :: n_exp(binary%kexpij), d_exp(binary%kexpij), t_exp(binary%&
      &   kexpij)
      REAL(pr) :: etha(binary%kexpij), eps(binary%kexpij), beta(binary%&
      &   kexpij), gama(binary%kexpij)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(binary%kpolij) :: arg1
      REAL(pr), DIMENSION(binary%kpolij) :: arg1b
      REAL(pr), DIMENSION(binary%kpolij) :: arg1d
      REAL(pr), DIMENSION(binary%kpolij) :: arg1db
      REAL(pr), DIMENSION(binary%kexpij) :: arg2
      REAL(pr), DIMENSION(binary%kexpij) :: arg2b
      REAL(pr), DIMENSION(binary%kexpij) :: arg2d
      REAL(pr), DIMENSION(binary%kexpij) :: arg2db
      REAL(pr), DIMENSION(binary%kexpij) :: arg3
      REAL(pr), DIMENSION(binary%kexpij) :: arg3b
      REAL(pr), DIMENSION(binary%kexpij) :: arg3d
      REAL(pr), DIMENSION(binary%kexpij) :: arg3db
      REAL(pr), DIMENSION(binary%kpolij) :: temp
      REAL(pr), DIMENSION(binary%kpolij) :: tempb
      REAL(pr), DIMENSION(binary%kpolij) :: temp0
      REAL(pr), DIMENSION(binary%kpolij) :: temp0b
      REAL(pr), DIMENSION(binary%kpolij) :: tempd
      REAL(pr), DIMENSION(binary%kpolij) :: tempdb
      REAL(pr), DIMENSION(binary%kpolij) :: tempd0
      REAL(pr), DIMENSION(binary%kpolij) :: tempd0b
      REAL(pr), DIMENSION(binary%kexpij) :: temp1
      REAL(pr), DIMENSION(binary%kexpij) :: temp1b
      REAL(pr), DIMENSION(binary%kexpij) :: temp2
      REAL(pr), DIMENSION(binary%kexpij) :: temp2b
      REAL(pr), DIMENSION(binary%kexpij) :: temp3
      REAL(pr), DIMENSION(binary%kexpij) :: temp3b
      REAL(pr), DIMENSION(binary%kexpij) :: tempd1
      REAL(pr), DIMENSION(binary%kexpij) :: tempd1b
      REAL(pr), DIMENSION(binary%kexpij) :: tempd2
      REAL(pr), DIMENSION(binary%kexpij) :: tempd2b
      REAL(pr), DIMENSION(binary%kexpij) :: temp4
      REAL(pr), DIMENSION(binary%kexpij) :: temp4b
      INTRINSIC INT
      LOGICAL, DIMENSION(binary%kpolij) :: mask
      LOGICAL, DIMENSION(binary%kpolij) :: mask0
      LOGICAL, DIMENSION(binary%kexpij) :: mask1
      LOGICAL, DIMENSION(binary%kexpij) :: mask2
      REAL(pr), DIMENSION(binary%kpolij) :: tempb0
      REAL(pr), DIMENSION(binary%kexpij) :: tempb1
      REAL(pr), DIMENSION(binary%kexpij) :: tempb2
      REAL(pr), DIMENSION(binary%kexpij) :: tempb3
      LOGICAL, DIMENSION(binary%kexpij) :: arg10
      REAL(pr) :: result1
      LOGICAL, DIMENSION(binary%kexpij) :: arg20
      REAL(pr) :: result2
      LOGICAL, DIMENSION(binary%kpolij) :: arg30
      REAL(pr) :: result3
      REAL(pr) :: result4
      LOGICAL, DIMENSION(binary%kpolij) :: arg4
      REAL(pr) :: result5
      LOGICAL, DIMENSION(binary%kpolij) :: arg21
      idx_poly = binary%kpolij
      idx_exp = binary%kexpij + idx_poly
      n_pol = binary%nij(1:idx_poly)
      d_pol = binary%dij(1:idx_poly)
      t_pol = binary%tij(1:idx_poly)
      n_exp = binary%nij(idx_poly+1:idx_exp)
      d_exp = binary%dij(idx_poly+1:idx_exp)
      t_exp = binary%tij(idx_poly+1:idx_exp)
      etha = binary%ethaij(1:binary%kexpij)
      eps = binary%epsij(1:binary%kexpij)
      beta = binary%betaij(1:binary%kexpij)
      gama = binary%gammaij(1:binary%kexpij)
      temp = tau**t_pol
      temp0 = delta**d_pol
      mask = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask)
         tempd = 0.0_pr
      ELSEWHERE
         tempd = d_pol*delta**(d_pol-1)*deltad
      END WHERE
      mask0 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol&
      &     ))
      WHERE (mask0)
         tempd0 = 0.0_pr
      ELSEWHERE
         tempd0 = t_pol*tau**(t_pol-1)*taud
      END WHERE
      arg1d(:) = n_pol*(temp*tempd+temp0*tempd0)
      arg1(:) = n_pol*(temp0*temp)
      arg2d(:) = -((etha*2*(delta-eps)+beta)*deltad)
      arg2(:) = -(etha*(delta-eps)**2) - beta*(delta-gama)
      temp1 = EXP(arg2(:))
      temp2 = tau**t_exp
      temp3 = delta**d_exp
      temp4 = temp3*temp2
      mask1 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask1)
         tempd1 = 0.0_pr
      ELSEWHERE
         tempd1 = d_exp*delta**(d_exp-1)*deltad
      END WHERE
      mask2 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(t_exp&
      &     ))
      WHERE (mask2)
         tempd2 = 0.0_pr
      ELSEWHERE
         tempd2 = t_exp*tau**(t_exp-1)*taud
      END WHERE
      arg3d(:) = n_exp*(temp1*(temp2*tempd1+temp3*tempd2)+temp4*EXP(arg2(:&
      &     ))*arg2d(:))
      arg3(:) = n_exp*(temp4*temp1)
      arg1b = 0.0_pr
      arg3b = 0.0_pr
      arg1b = aijb
      arg3b = aijb
      arg1db = 0.0_pr
      arg3db = 0.0_pr
      arg1db = aijdb
      arg3db = aijdb
      temp4b = 0.0_pr
      temp1b = 0.0_pr
      arg2b = 0.0_pr
      tempd1b = 0.0_pr
      tempd2b = 0.0_pr
      arg2db = 0.0_pr
      temp2b = 0.0_pr
      temp3b = 0.0_pr
      tempb1 = n_exp*arg3db
      temp1b = temp4*n_exp*arg3b + (temp2*tempd1+temp3*tempd2)*tempb1
      tempb2 = temp1*tempb1
      arg2b = EXP(arg2)*temp4*arg2d*tempb1 + EXP(arg2)*temp1b
      tempb3 = EXP(arg2)*tempb1
      temp4b = temp1*n_exp*arg3b + arg2d*tempb3
      arg2db = temp4*tempb3
      temp2b = tempd1*tempb2 + temp3*temp4b
      tempd1b = temp2*tempb2
      temp3b = tempd2*tempb2 + temp2*temp4b
      tempd2b = temp3*tempb2
      tempb = 0.0_pr
      temp0b = 0.0_pr
      tempd0b = 0.0_pr
      tempdb = 0.0_pr
      tempb0 = n_pol*arg1db
      temp0b = temp*n_pol*arg1b + tempd0*tempb0
      tempb = temp0*n_pol*arg1b + tempd*tempb0
      tempdb = temp*tempb0
      arg10(:) = .NOT.mask1 .AND. (.NOT.(delta .LE. 0.0 .AND. (d_exp - 1 &
      &     .EQ. 0.0 .OR. d_exp - 1 .NE. INT(d_exp - 1))))
      result1 = SUM((d_exp-1)*delta**(d_exp-2)*d_exp*tempd1b, mask=arg10(:&
      &     ))
      arg20(:) = .NOT.(delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp &
      &     .NE. INT(d_exp)))
      result2 = SUM(d_exp*delta**(d_exp-1)*temp3b, mask=arg20(:))
      arg30(:) = .NOT.mask .AND. (.NOT.(delta .LE. 0.0 .AND. (d_pol - 1 &
      &     .EQ. 0.0 .OR. d_pol - 1 .NE. INT(d_pol - 1))))
      result3 = SUM((d_pol-1)*delta**(d_pol-2)*d_pol*tempdb, mask=arg30(:)&
      &     )
      result4 = SUM((delta-eps)*etha*arg2b)
      arg4(:) = .NOT.(delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE.&
      &     INT(d_pol)))
      result5 = SUM(d_pol*delta**(d_pol-1)*temp0b, mask=arg4(:))
      deltab = deltab + result1*deltad + result2 + result3*deltad - 2*&
      &     result4 - SUM(beta*arg2b) - SUM(etha*arg2db)*2*deltad + result5
      arg10(:) = .NOT.mask1
      result1 = SUM(delta**(d_exp-1)*d_exp*tempd1b, mask=arg10(:))
      arg21(:) = .NOT.mask
      result2 = SUM(delta**(d_pol-1)*d_pol*tempdb, mask=arg21(:))
      result3 = SUM((beta+etha*2*(delta-eps))*arg2db)
      deltadb = deltadb + result1 + result2 - result3
      tempd0b = temp0*tempb0
      arg10(:) = .NOT.mask2 .AND. (.NOT.(tau .LE. 0.0 .AND. (t_exp - 1 &
      &     .EQ. 0.0 .OR. t_exp - 1 .NE. INT(t_exp - 1))))
      result1 = SUM((t_exp-1)*tau**(t_exp-2)*t_exp*tempd2b, mask=arg10(:))
      arg20(:) = .NOT.(tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. &
      &     INT(t_exp)))
      result2 = SUM(t_exp*tau**(t_exp-1)*temp2b, mask=arg20(:))
      arg30(:) = .NOT.mask0 .AND. (.NOT.(tau .LE. 0.0 .AND. (t_pol - 1 &
      &     .EQ. 0.0 .OR. t_pol - 1 .NE. INT(t_pol - 1))))
      result3 = SUM((t_pol-1)*tau**(t_pol-2)*t_pol*tempd0b, mask=arg30(:))
      arg4(:) = .NOT.(tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. &
      &     INT(t_pol)))
      result4 = SUM(t_pol*tau**(t_pol-1)*tempb, mask=arg4(:))
      taub = taub + result1*taud + result2 + result3*taud + result4
      arg10(:) = .NOT.mask2
      result1 = SUM(tau**(t_exp-1)*t_exp*tempd2b, mask=arg10(:))
      arg21(:) = .NOT.mask0
      result2 = SUM(tau**(t_pol-1)*t_pol*tempd0b, mask=arg21(:))
      taudb = taudb + result1 + result2
   end subroutine AR_IJ_D_B

!  Differentiation of ar_ij in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: aij
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_IJ_D(model, delta, deltad, tau, taud, binary, aij, aijd)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: delta
      REAL(pr), INTENT(IN) :: deltad
      REAL(pr), INTENT(IN) :: tau
      REAL(pr), INTENT(IN) :: taud
      class(GERG2008BINARY), INTENT(IN) :: binary
      REAL(pr), INTENT(OUT) :: aij
      REAL(pr), INTENT(OUT) :: aijd
      INTEGER :: idx_poly, idx_exp
      INTEGER :: k
      REAL(pr) :: n_pol(binary%kpolij), d_pol(binary%kpolij), t_pol(binary%&
      &   kpolij)
      REAL(pr) :: n_exp(binary%kexpij), d_exp(binary%kexpij), t_exp(binary%&
      &   kexpij)
      REAL(pr) :: etha(binary%kexpij), eps(binary%kexpij), beta(binary%&
      &   kexpij), gama(binary%kexpij)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(binary%kpolij) :: arg1
      REAL(pr), DIMENSION(binary%kpolij) :: arg1d
      REAL(pr), DIMENSION(binary%kexpij) :: arg2
      REAL(pr), DIMENSION(binary%kexpij) :: arg2d
      REAL(pr), DIMENSION(binary%kexpij) :: arg3
      REAL(pr), DIMENSION(binary%kexpij) :: arg3d
      REAL(pr), DIMENSION(binary%kpolij) :: temp
      REAL(pr), DIMENSION(binary%kpolij) :: temp0
      REAL(pr), DIMENSION(binary%kpolij) :: tempd
      REAL(pr), DIMENSION(binary%kpolij) :: tempd0
      REAL(pr), DIMENSION(binary%kexpij) :: temp1
      REAL(pr), DIMENSION(binary%kexpij) :: temp2
      REAL(pr), DIMENSION(binary%kexpij) :: temp3
      REAL(pr), DIMENSION(binary%kexpij) :: tempd1
      REAL(pr), DIMENSION(binary%kexpij) :: tempd2
      REAL(pr), DIMENSION(binary%kexpij) :: temp4
      INTRINSIC INT
      LOGICAL, DIMENSION(binary%kpolij) :: mask
      LOGICAL, DIMENSION(binary%kpolij) :: mask0
      LOGICAL, DIMENSION(binary%kexpij) :: mask1
      LOGICAL, DIMENSION(binary%kexpij) :: mask2
      idx_poly = binary%kpolij
      idx_exp = binary%kexpij + idx_poly
      n_pol = binary%nij(1:idx_poly)
      d_pol = binary%dij(1:idx_poly)
      t_pol = binary%tij(1:idx_poly)
      n_exp = binary%nij(idx_poly+1:idx_exp)
      d_exp = binary%dij(idx_poly+1:idx_exp)
      t_exp = binary%tij(idx_poly+1:idx_exp)
      etha = binary%ethaij(1:binary%kexpij)
      eps = binary%epsij(1:binary%kexpij)
      beta = binary%betaij(1:binary%kexpij)
      gama = binary%gammaij(1:binary%kexpij)
      temp = tau**t_pol
      temp0 = delta**d_pol
      mask = delta .LE. 0.0 .AND. (d_pol .EQ. 0.0 .OR. d_pol .NE. INT(&
      &     d_pol))
      WHERE (mask)
         tempd = 0.0_pr
      ELSEWHERE
         tempd = d_pol*delta**(d_pol-1)*deltad
      END WHERE
      mask0 = tau .LE. 0.0 .AND. (t_pol .EQ. 0.0 .OR. t_pol .NE. INT(t_pol&
      &     ))
      WHERE (mask0)
         tempd0 = 0.0_pr
      ELSEWHERE
         tempd0 = t_pol*tau**(t_pol-1)*taud
      END WHERE
      arg1d(:) = n_pol*(temp*tempd+temp0*tempd0)
      arg1(:) = n_pol*(temp0*temp)
      arg2d(:) = -((etha*2*(delta-eps)+beta)*deltad)
      arg2(:) = -(etha*(delta-eps)**2) - beta*(delta-gama)
      temp1 = EXP(arg2(:))
      temp2 = tau**t_exp
      temp3 = delta**d_exp
      temp4 = temp3*temp2
      mask1 = delta .LE. 0.0 .AND. (d_exp .EQ. 0.0 .OR. d_exp .NE. INT(&
      &     d_exp))
      WHERE (mask1)
         tempd1 = 0.0_pr
      ELSEWHERE
         tempd1 = d_exp*delta**(d_exp-1)*deltad
      END WHERE
      mask2 = tau .LE. 0.0 .AND. (t_exp .EQ. 0.0 .OR. t_exp .NE. INT(t_exp&
      &     ))
      WHERE (mask2)
         tempd2 = 0.0_pr
      ELSEWHERE
         tempd2 = t_exp*tau**(t_exp-1)*taud
      END WHERE
      arg3d(:) = n_exp*(temp1*(temp2*tempd1+temp3*tempd2)+temp4*EXP(arg2(:&
      &     ))*arg2d(:))
      arg3(:) = n_exp*(temp4*temp1)
      aijd = SUM(arg1d(:)) + SUM(arg3d(:))
      aij = SUM(arg1(:)) + SUM(arg3(:))
   end subroutine AR_IJ_D

!  Differentiation of ar_ij in reverse (adjoint) mode (with options noISIZE):
!   gradient     of useful results: tau delta aij
!   with respect to varying inputs: tau delta
   SUBROUTINE AR_IJ_B(model, delta, deltab, tau, taub, binary, aij, aijb)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: delta
      REAL(pr) :: deltab
      REAL(pr), INTENT(IN) :: tau
      REAL(pr) :: taub
      class(GERG2008BINARY), INTENT(IN) :: binary
      REAL(pr) :: aij
      REAL(pr) :: aijb
      INTEGER :: idx_poly, idx_exp
      INTEGER :: k
      REAL(pr) :: n_pol(binary%kpolij), d_pol(binary%kpolij), t_pol(binary%&
      &   kpolij)
      REAL(pr) :: n_exp(binary%kexpij), d_exp(binary%kexpij), t_exp(binary%&
      &   kexpij)
      REAL(pr) :: etha(binary%kexpij), eps(binary%kexpij), beta(binary%&
      &   kexpij), gama(binary%kexpij)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(binary%kpolij) :: arg1
      REAL(pr), DIMENSION(binary%kpolij) :: arg1b
      REAL(pr), DIMENSION(binary%kexpij) :: arg2
      REAL(pr), DIMENSION(binary%kexpij) :: arg2b
      REAL(pr), DIMENSION(binary%kexpij) :: arg3
      REAL(pr), DIMENSION(binary%kexpij) :: arg3b
      REAL(pr), DIMENSION(binary%kexpij) :: tempb
      REAL(pr), DIMENSION(binary%kexpij) :: temp
      REAL(pr), DIMENSION(binary%kexpij) :: temp0
      idx_poly = binary%kpolij
      idx_exp = binary%kexpij + idx_poly
      n_pol = binary%nij(1:idx_poly)
      d_pol = binary%dij(1:idx_poly)
      t_pol = binary%tij(1:idx_poly)
      n_exp = binary%nij(idx_poly+1:idx_exp)
      d_exp = binary%dij(idx_poly+1:idx_exp)
      t_exp = binary%tij(idx_poly+1:idx_exp)
      etha = binary%ethaij(1:binary%kexpij)
      eps = binary%epsij(1:binary%kexpij)
      beta = binary%betaij(1:binary%kexpij)
      gama = binary%gammaij(1:binary%kexpij)
      arg1(:) = n_pol*delta**d_pol*tau**t_pol
      arg2(:) = -(etha*(delta-eps)**2) - beta*(delta-gama)
      arg3(:) = n_exp*delta**d_exp*tau**t_exp*EXP(arg2(:))
      arg1b = 0.0_pr
      arg3b = 0.0_pr
      arg1b = aijb
      arg3b = aijb
      arg2b = 0.0_pr
      temp = tau**t_exp
      temp0 = delta**d_exp
      tempb = EXP(arg2)*n_exp*arg3b
      arg2b = EXP(arg2)*temp0*temp*n_exp*arg3b
      deltab = deltab + SUM(d_exp*delta**(d_exp-1)*temp*tempb, MASK=.NOT.(&
      &     delta.LE.0.0.AND.(d_exp.EQ.0.0.OR.d_exp.NE.INT(d_exp)))) + SUM(&
      &     d_pol*delta**(d_pol-1)*tau**t_pol*n_pol*arg1b, MASK=.NOT.(delta&
      &     .LE.0.0.AND.(d_pol.EQ.0.0.OR.d_pol.NE.INT(d_pol)))) - 2*SUM((delta&
      &     -eps)*etha*arg2b) - SUM(beta*arg2b)
      taub = taub + SUM(t_exp*tau**(t_exp-1)*temp0*tempb, MASK=.NOT.(tau&
      &     .LE.0.0.AND.(t_exp.EQ.0.0.OR.t_exp.NE.INT(t_exp)))) + SUM(t_pol*&
      &     tau**(t_pol-1)*delta**d_pol*n_pol*arg1b, MASK=.NOT.(tau.LE.0.0&
      &     .AND.(t_pol.EQ.0.0.OR.t_pol.NE.INT(t_pol))))
   end subroutine AR_IJ_B

   SUBROUTINE AR_IJ(model, delta, tau, binary, aij)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: delta
      REAL(pr), INTENT(IN) :: tau
      class(GERG2008BINARY), INTENT(IN) :: binary
      REAL(pr), INTENT(OUT) :: aij
      INTEGER :: idx_poly, idx_exp
      INTEGER :: k
      REAL(pr) :: n_pol(binary%kpolij), d_pol(binary%kpolij), t_pol(binary%&
      &   kpolij)
      REAL(pr) :: n_exp(binary%kexpij), d_exp(binary%kexpij), t_exp(binary%&
      &   kexpij)
      REAL(pr) :: etha(binary%kexpij), eps(binary%kexpij), beta(binary%&
      &   kexpij), gama(binary%kexpij)
      INTRINSIC SUM
      INTRINSIC EXP
      REAL(pr), DIMENSION(binary%kpolij) :: arg1
      REAL(pr), DIMENSION(binary%kexpij) :: arg2
      REAL(pr), DIMENSION(binary%kexpij) :: arg3
      idx_poly = binary%kpolij
      idx_exp = binary%kexpij + idx_poly
      n_pol = binary%nij(1:idx_poly)
      d_pol = binary%dij(1:idx_poly)
      t_pol = binary%tij(1:idx_poly)
      n_exp = binary%nij(idx_poly+1:idx_exp)
      d_exp = binary%dij(idx_poly+1:idx_exp)
      t_exp = binary%tij(idx_poly+1:idx_exp)
      etha = binary%ethaij(1:binary%kexpij)
      eps = binary%epsij(1:binary%kexpij)
      beta = binary%betaij(1:binary%kexpij)
      gama = binary%gammaij(1:binary%kexpij)
      arg1(:) = n_pol*delta**d_pol*tau**t_pol
      arg2(:) = -(etha*(delta-eps)**2) - beta*(delta-gama)
      arg3(:) = n_exp*delta**d_exp*tau**t_exp*EXP(arg2(:))
      aij = SUM(arg1(:)) + SUM(arg3(:))
   end subroutine AR_IJ

!  Differentiation of ar_d_d in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: arval arvaldd arvald arvald0
!   with respect to varying inputs: t v
!   RW status of diff variables: t:in v:in arval:out arvaldd:out
!                arvald:out arvald0:out
!  Differentiation of ar_d in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: arval arvald
!   with respect to varying inputs: t v
!   RW status of diff variables: t:in v:in arval:out arvald:out
!  Differentiation of ar in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: arval
!   with respect to varying inputs: n t v
!   RW status of diff variables: n:in t:in v:in arval:out
   SUBROUTINE AR_D_D_D(model, n, nd, v, vd1, vd0, vd, t, td1, td0, td, &
   &   arval, arvald1, arvald0, arvald0d, arvald, arvaldd0, arvaldd, &
   &   arvalddd)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:), v, t
      REAL(pr), INTENT(IN) :: vd1, td1
      REAL(pr), INTENT(IN) :: vd0, td0
      REAL(pr), INTENT(IN) :: nd(:), vd, td
      REAL(pr), INTENT(OUT) :: arval
      REAL(pr), INTENT(OUT) :: arvald1
      REAL(pr), INTENT(OUT) :: arvald0
      REAL(pr), INTENT(OUT) :: arvald0d
      REAL(pr), INTENT(OUT) :: arvald
      REAL(pr), INTENT(OUT) :: arvaldd0
      REAL(pr), INTENT(OUT) :: arvaldd
      REAL(pr), INTENT(OUT) :: arvalddd
      REAL(pr) :: vr, tr, x(SIZE(n)), rho_c(SIZE(n)), rho_r
      REAL(pr) :: vrd, trd, xd(SIZE(n)), rho_rd
      REAL(pr) :: delta, tau
      REAL(pr) :: deltad1, taud1
      REAL(pr) :: deltad0, taud0
      REAL(pr) :: deltad0d, taud0d
      REAL(pr) :: deltad, taud
      REAL(pr) :: deltadd0, taudd0
      REAL(pr) :: deltadd, taudd
      REAL(pr) :: deltaddd, tauddd
      TYPE(GERG2008PURE) :: pures(SIZE(n))
      TYPE(GERG2008BINARY) :: binary
      REAL(pr) :: fij(SIZE(n), SIZE(n)), aij
      REAL(pr) :: aijd1
      REAL(pr) :: aijd0
      REAL(pr) :: aijd0d
      REAL(pr) :: aijd
      REAL(pr) :: aijdd0
      REAL(pr) :: aijdd
      REAL(pr) :: aijddd
      REAL(pr) :: ar_pures(SIZE(n))
      REAL(pr) :: ar_puresd1(SIZE(n))
      REAL(pr) :: ar_puresd0(SIZE(n))
      REAL(pr) :: ar_puresd0d(SIZE(n))
      REAL(pr) :: ar_puresd(SIZE(n))
      REAL(pr) :: ar_puresdd0(SIZE(n))
      REAL(pr) :: ar_puresdd(SIZE(n))
      REAL(pr) :: ar_puresddd(SIZE(n))
      INTEGER :: i, j, k, nc
      INTRINSIC SUM
      REAL(pr) :: temp
      REAL(pr) :: tempd0
      REAL(pr) :: tempd
      REAL(pr) :: tempdd
      INTRINSIC SIZE
      REAL(pr) :: temp0
      REAL(pr) :: temp0d
      REAL(pr) :: temp1
      REAL(pr) :: temp1d
      REAL(pr) :: temp2
      REAL(pr) :: temp3
      fij = model%binaries%fij
      pures = model%pures
      nc = SIZE(n)
      temp = SUM(n)
      xd = (nd-n*SUM(nd)/temp)/temp
      x = n/temp
      CALL REDUCING_FUNCTIONS_D(model, n, nd, vr, vrd, tr, trd)
      rho_rd = -(vrd/vr**2)
      rho_r = 1/vr
      temp2 = 1.0/(rho_r*v)
      temp0d = -(temp2*vd1/v)
      temp0 = temp2
      tempdd = -(vd0*(temp0d-temp0*vd1/v)/v)
      tempd = -(temp0*vd0/v)
      tempd0 = temp0d
      temp = temp0
      temp2 = temp/(rho_r*v)
      temp0d = (tempd0-temp2*rho_r*vd1)/(rho_r*v)
      temp0 = temp2
      temp1d = rho_rd*vd1
      temp1 = rho_r*vd + rho_rd*v
      temp2 = temp1/(rho_r*v)
      temp3 = tempd - rho_r*vd0*temp0
      deltaddd = -(rho_rd*vd0*temp0d) - temp2*(tempdd-rho_r*vd0*temp0d) - &
      &     temp3*(temp1d-temp2*rho_r*vd1)/(rho_r*v)
      deltadd = -(rho_rd*vd0*temp0) - temp3*temp2
      deltadd0 = -(temp0*temp1d+temp1*temp0d)
      deltad = -(temp1*temp0)
      deltad0d = tempdd
      deltad0 = tempd
      deltad1 = tempd0
      delta = temp
      temp3 = tr*td/t
      temp1d = -(temp3*td1/t)
      temp1 = temp3
      temp3 = (trd-temp1)/t
      temp0d = (-temp1d-temp3*td1)/t
      temp0 = temp3
      temp3 = (temp1/t-temp0)/t
      tauddd = td0*((temp1d-temp1*td1/t)/t-temp0d-temp3*td1)/t
      taudd = td0*temp3
      taudd0 = temp0d
      taud = temp0
      temp3 = tr*td0/(t*t)
      taud0d = temp3*2*td1/t
      taud0 = -temp3
      taud1 = -(tr*td1/t**2)
      tau = tr/t
      ar_puresd = 0.0_pr
      ar_puresd0 = 0.0_pr
      ar_puresdd = 0.0_pr
      ar_puresd1 = 0.0_pr
      ar_puresddd = 0.0_pr
      ar_puresdd0 = 0.0_pr
      ar_puresd0d = 0.0_pr
      DO i=1,nc
         CALL AR_PURE_D_D_D(pures(i), delta, deltad1, deltad0, deltad0d, &
         &                  deltad, deltadd0, deltadd, deltaddd, tau, taud1, &
         &                  taud0, taud0d, taud, taudd0, taudd, tauddd, ar_pures(&
         &                  i), ar_puresd1(i), ar_puresd0(i), ar_puresd0d(i), &
         &                  ar_puresd(i), ar_puresdd0(i), ar_puresdd(i), &
         &                  ar_puresddd(i))
      END DO
      arvalddd = SUM(xd*ar_puresd0d + x*ar_puresddd)
      arvaldd = SUM(xd*ar_puresd0 + x*ar_puresdd)
      arvaldd0 = SUM(xd*ar_puresd1 + x*ar_puresdd0)
      arvald = SUM(ar_pures*xd + x*ar_puresd)
      arvald0d = SUM(x*ar_puresd0d)
      arvald0 = SUM(x*ar_puresd0)
      arvald1 = SUM(x*ar_puresd1)
      arval = SUM(x*ar_pures)
      DO i=1,nc
         DO j=i+1,nc
            binary = model%binaries(i, j)
            CALL AR_IJ_D_D_D(model, delta, deltad1, deltad0, deltad0d, &
            &                  deltad, deltadd0, deltadd, deltaddd, tau, taud1, &
            &                  taud0, taud0d, taud, taudd0, taudd, tauddd, binary, &
            &                  aij, aijd1, aijd0, aijd0d, aijd, aijdd0, aijdd, &
            &                  aijddd)
            arvalddd = arvalddd + fij(i, j)*(x(j)*(xd(i)*aijd0d+x(i)*aijddd)&
            &         +x(i)*xd(j)*aijd0d)
            arvaldd = arvaldd + fij(i, j)*(x(j)*(xd(i)*aijd0+x(i)*aijdd)+xd(&
            &         j)*x(i)*aijd0)
            arvaldd0 = arvaldd0 + fij(i, j)*(x(j)*(xd(i)*aijd1+x(i)*aijdd0)+&
            &         xd(j)*x(i)*aijd1)
            arvald = arvald + fij(i, j)*(x(j)*(aij*xd(i)+x(i)*aijd)+x(i)*aij&
            &         *xd(j))
            temp1 = x(j)*fij(i, j)
            arvald0d = arvald0d + x(i)*temp1*aijd0d
            arvald0 = arvald0 + temp1*x(i)*aijd0
            arvald1 = arvald1 + x(i)*temp1*aijd1
            arval = arval + x(i)*aij*temp1
         END DO
      END DO
      temp = SUM(n)
      temp1 = SUM(nd)
      arvalddd = ryaeos*(temp1*(arvald0*td1+t*arvald0d+td0*arvald1)+temp*(&
      &     td0*arvaldd0+arvaldd*td1+t*arvalddd+td*arvald0d))
      arvaldd = ryaeos*(temp1*(t*arvald0+arval*td0)+temp*(arvald*td0+t*&
      &     arvaldd+td*arvald0))
      arvaldd0 = ryaeos*(temp1*(t*arvald1+arval*td1)+temp*(arvald*td1+t*&
      &     arvaldd0+td*arvald1))
      arvald = ryaeos*(temp1*(arval*t)+temp*(t*arvald+td*arval))
      arvald0d = ryaeos*temp*(arvald0*td1+t*arvald0d+td0*arvald1)
      arvald0 = ryaeos*temp*(t*arvald0+arval*td0)
      arvald1 = ryaeos*temp*(t*arvald1+arval*td1)
      arval = ryaeos*(temp*(arval*t))
   end subroutine AR_D_D_D

!  Differentiation of ar_d in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: arval arvald
!   with respect to varying inputs: t v
!   RW status of diff variables: t:in v:in arval:out arvald:out
!  Differentiation of ar in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: arval
!   with respect to varying inputs: n t v
!   RW status of diff variables: n:in t:in v:in arval:out
   SUBROUTINE AR_D_D(model, n, nd, v, vd0, vd, t, td0, td, arval, arvald0&
   &   , arvald, arvaldd)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:), v, t
      REAL(pr), INTENT(IN) :: vd0, td0
      REAL(pr), INTENT(IN) :: nd(:), vd, td
      REAL(pr), INTENT(OUT) :: arval
      REAL(pr), INTENT(OUT) :: arvald0
      REAL(pr), INTENT(OUT) :: arvald
      REAL(pr), INTENT(OUT) :: arvaldd
      REAL(pr) :: vr, tr, x(SIZE(n)), rho_c(SIZE(n)), rho_r
      REAL(pr) :: vrd, trd, xd(SIZE(n)), rho_rd
      REAL(pr) :: delta, tau
      REAL(pr) :: deltad0, taud0
      REAL(pr) :: deltad, taud
      REAL(pr) :: deltadd, taudd
      TYPE(GERG2008PURE) :: pures(SIZE(n))
      TYPE(GERG2008BINARY) :: binary
      REAL(pr) :: fij(SIZE(n), SIZE(n)), aij
      REAL(pr) :: aijd0
      REAL(pr) :: aijd
      REAL(pr) :: aijdd
      REAL(pr) :: ar_pures(SIZE(n))
      REAL(pr) :: ar_puresd0(SIZE(n))
      REAL(pr) :: ar_puresd(SIZE(n))
      REAL(pr) :: ar_puresdd(SIZE(n))
      INTEGER :: i, j, k, nc
      INTRINSIC SUM
      REAL(pr) :: temp
      REAL(pr) :: tempd
      INTRINSIC SIZE
      REAL(pr) :: temp0
      REAL(pr) :: temp1
      fij = model%binaries%fij
      pures = model%pures
      nc = SIZE(n)
      temp = SUM(n)
      xd = (nd-n*SUM(nd)/temp)/temp
      x = n/temp
      CALL REDUCING_FUNCTIONS_D(model, n, nd, vr, vrd, tr, trd)
      rho_rd = -(vrd/vr**2)
      rho_r = 1/vr
      temp0 = 1.0/(rho_r*v)
      tempd = -(temp0*vd0/v)
      temp = temp0
      temp0 = temp/(rho_r*v)
      temp1 = rho_r*vd + rho_rd*v
      deltadd = -(temp0*rho_rd*vd0+temp1*(tempd-temp0*rho_r*vd0)/(rho_r*v)&
      &     )
      deltad = -(temp1*temp0)
      deltad0 = tempd
      delta = temp
      temp1 = tr*td/t
      temp0 = (trd-temp1)/t
      taudd = (temp1/t-temp0)*td0/t
      taud = temp0
      taud0 = -(tr*td0/t**2)
      tau = tr/t
      ar_puresd = 0.0_pr
      ar_puresd0 = 0.0_pr
      ar_puresdd = 0.0_pr
      DO i=1,nc
         CALL AR_PURE_D_D(pures(i), delta, deltad0, deltad, deltadd, tau, &
         &                taud0, taud, taudd, ar_pures(i), ar_puresd0(i), &
         &                ar_puresd(i), ar_puresdd(i))
      END DO
      arvaldd = SUM(xd*ar_puresd0 + x*ar_puresdd)
      arvald = SUM(ar_pures*xd + x*ar_puresd)
      arvald0 = SUM(x*ar_puresd0)
      arval = SUM(x*ar_pures)
      DO i=1,nc
         DO j=i+1,nc
            binary = model%binaries(i, j)
            CALL AR_IJ_D_D(model, delta, deltad0, deltad, deltadd, tau, &
            &                taud0, taud, taudd, binary, aij, aijd0, aijd, aijdd)
            arvaldd = arvaldd + fij(i, j)*(x(j)*(xd(i)*aijd0+x(i)*aijdd)+xd(&
            &         j)*x(i)*aijd0)
            arvald = arvald + fij(i, j)*(x(j)*(aij*xd(i)+x(i)*aijd)+x(i)*aij&
            &         *xd(j))
            temp1 = x(j)*fij(i, j)
            arvald0 = arvald0 + temp1*x(i)*aijd0
            arval = arval + x(i)*aij*temp1
         END DO
      END DO
      temp = SUM(n)
      temp1 = SUM(nd)
      arvaldd = ryaeos*(temp1*(t*arvald0+arval*td0)+temp*(arvald*td0+t*&
      &     arvaldd+td*arvald0))
      arvald = ryaeos*(temp1*(arval*t)+temp*(t*arvald+td*arval))
      arvald0 = ryaeos*temp*(t*arvald0+arval*td0)
      arval = ryaeos*(temp*(arval*t))
   end subroutine AR_D_D

!  Differentiation of ar_d in reverse (adjoint) mode (with options noISIZE):
!   gradient     of useful results: nd n t v arval arvald vd td
!   with respect to varying inputs: nd n t v arval arvald vd td
!   RW status of diff variables: nd:incr n:incr t:incr v:incr arval:in-zero
!                arvald:in-zero vd:incr td:incr
!  Differentiation of ar in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: arval
!   with respect to varying inputs: n t v
!   RW status of diff variables: n:in t:in v:in arval:out
   SUBROUTINE AR_D_B(model, n, nb, nd, ndb, v, vb, vd, vdb, t, tb, td, &
   &   tdb, arval, arvalb, arvald, arvaldb)
      USE ISO_C_BINDING
      USE ADMM_TAPENADE_INTERFACE
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:), v, t
      REAL(pr) :: nb(:), vb, tb
      REAL(pr), INTENT(IN) :: nd(:), vd, td
      REAL(pr) :: ndb(:), vdb, tdb
      REAL(pr) :: arval
      REAL(pr) :: arvalb
      REAL(pr) :: arvald
      REAL(pr) :: arvaldb
      REAL(pr) :: vr, tr, x(SIZE(n)), rho_c(SIZE(n)), rho_r
      REAL(pr) :: vrb, trb, xb(SIZE(n)), rho_rb
      REAL(pr) :: vrd, trd, xd(SIZE(n)), rho_rd
      REAL(pr) :: vrdb, trdb, xdb(SIZE(n)), rho_rdb
      REAL(pr) :: delta, tau
      REAL(pr) :: deltab, taub
      REAL(pr) :: deltad, taud
      REAL(pr) :: deltadb, taudb
      TYPE(GERG2008PURE) :: pures(SIZE(n))
      TYPE(GERG2008BINARY) :: binary
      REAL(pr) :: fij(SIZE(n), SIZE(n)), aij
      REAL(pr) :: aijb
      REAL(pr) :: aijd
      REAL(pr) :: aijdb
      REAL(pr) :: ar_pures(SIZE(n))
      REAL(pr) :: ar_puresb(SIZE(n))
      REAL(pr) :: ar_puresd(SIZE(n))
      REAL(pr) :: ar_puresdb(SIZE(n))
      INTEGER :: i, j, k, nc
      INTRINSIC SUM
      REAL(pr) :: temp
      REAL(pr) :: tempb
      INTRINSIC SIZE
      REAL(pr), DIMENSION(SIZE(n, 1)) :: tempb0
      REAL(pr), DIMENSION(SIZE(n, 1)) :: temp0
      REAL(pr) :: temp1
      REAL(pr), DIMENSION(SIZE(n, 1)) :: tempb1
      REAL(pr) :: tempb2
      REAL(pr) :: temp2
      REAL(pr) :: tempb3
      REAL(pr) :: tempb4
      INTEGER :: ad_from
      REAL(pr) :: result1
      fij = model%binaries%fij
      pures = model%pures
      nc = SIZE(n)
      temp = SUM(n)
      xd = (nd-n*SUM(nd)/temp)/temp
      x = n/temp
      CALL REDUCING_FUNCTIONS_D(model, n, nd, vr, vrd, tr, trd)
      rho_rd = -(vrd/vr**2)
      rho_r = 1/vr
      CALL PUSHREAL8(temp)
      temp = 1.0/(v*rho_r)
      deltad = -(temp*(rho_r*vd+v*rho_rd)/(v*rho_r))
      delta = temp
      taud = (trd-tr*td/t)/t
      tau = tr/t
      ar_puresd = 0.0_pr
      DO i=1,nc
         CALL AR_PURE_D(pures(i), delta, deltad, tau, taud, ar_pures(i), &
         &              ar_puresd(i))
      END DO
      arvald = SUM(ar_pures*xd + x*ar_puresd)
      arval = SUM(x*ar_pures)
      DO i=1,nc
         ad_from = i + 1
         DO j=ad_from,nc
            CALL PUSHREAL8(binary%bv)
            CALL PUSHREAL8(binary%gv)
            CALL PUSHREAL8(binary%bt)
            CALL PUSHREAL8(binary%gt)
            CALL PUSHINTEGER4(binary%kpolij)
            CALL PUSHINTEGER4(binary%kexpij)
            CALL PUSHREAL8(binary%fij)
            binary = model%binaries(i, j)
            CALL PUSHREAL8(aijd)
            CALL PUSHREAL8(aij)
            CALL AR_IJ_D(model, delta, deltad, tau, taud, binary, aij, aijd)
            arvald = arvald + fij(i, j)*(x(j)*(aij*xd(i)+x(i)*aijd)+x(i)*aij&
            &         *xd(j))
            arval = arval + x(i)*x(j)*fij(i, j)*aij
         END DO
         CALL PUSHINTEGER4(ad_from)
      END DO
      temp = SUM(n)
      tempb4 = ryaeos*arvalb
      arvalb = temp*t*tempb4
      tempb = arval*t*tempb4
      tb = tb + temp*arval*tempb4
      tempb4 = ryaeos*arvaldb
      tempb3 = SUM(nd)*tempb4
      ndb = ndb + arval*t*tempb4
      tempb = tempb + (t*arvald+arval*td)*tempb4
      tempb2 = temp*tempb4
      arvaldb = t*tempb2
      tb = tb + arvald*tempb2 + arval*tempb3
      arvalb = arvalb + td*tempb2 + t*tempb3
      tdb = tdb + arval*tempb2
      nb = nb + tempb
      temp = 1.0/(v*rho_r)
      taudb = 0.0_pr
      taub = 0.0_pr
      xdb = 0.0_pr
      xb = 0.0_pr
      deltadb = 0.0_pr
      deltab = 0.0_pr
      DO i=nc,1,-1
         CALL POPINTEGER4(ad_from)
         DO j=nc,ad_from,-1
            tempb4 = fij(i, j)*arvalb
            xb(i) = xb(i) + aij*x(j)*tempb4
            aijb = x(i)*x(j)*tempb4
            xb(j) = xb(j) + x(i)*aij*tempb4
            tempb4 = fij(i, j)*arvaldb
            xb(j) = xb(j) + (aij*xd(i)+x(i)*aijd)*tempb4
            tempb3 = x(j)*tempb4
            xb(i) = xb(i) + aij*xd(j)*tempb4 + aijd*tempb3
            aijb = aijb + x(i)*xd(j)*tempb4 + xd(i)*tempb3
            xdb(j) = xdb(j) + x(i)*aij*tempb4
            xdb(i) = xdb(i) + aij*tempb3
            aijdb = x(i)*tempb3
            CALL POPREAL8(aij)
            CALL POPREAL8(aijd)
            CALL AR_IJ_D_B(model, delta, deltab, deltad, deltadb, tau, taub&
            &                , taud, taudb, binary, aij, aijb, aijd, aijdb)
            CALL POPREAL8(binary%fij)
            CALL POPINTEGER4(binary%kexpij)
            CALL POPINTEGER4(binary%kpolij)
            CALL POPREAL8(binary%gt)
            CALL POPREAL8(binary%bt)
            CALL POPREAL8(binary%gv)
            CALL POPREAL8(binary%bv)
         END DO
      END DO
      ar_puresb = 0.0_pr
      xb = xb + ar_pures*arvalb + ar_puresd*arvaldb
      ar_puresb = x*arvalb + xd*arvaldb
      ar_puresdb = 0.0_pr
      xdb = xdb + ar_pures*arvaldb
      ar_puresdb = x*arvaldb
      DO i=nc,1,-1
         CALL AR_PURE_D_B(pures(i), delta, deltab, deltad, deltadb, tau, &
         &                taub, taud, taudb, ar_pures(i), ar_puresb(i), ar_puresd&
         &                (i), ar_puresdb(i))
         ar_puresb(i) = 0.0_pr
         ar_puresdb(i) = 0.0_pr
      END DO
      tempb2 = -((rho_r*vd+v*rho_rd)*deltadb/(v*rho_r))
      tempb4 = taudb/t
      tempb3 = -(tempb4/t)
      temp2 = tr*td/t
      trb = taub/t + td*tempb3
      tb = tb - tr*taub/t**2 - (trd-temp2)*tempb4/t - temp2*tempb3
      trdb = tempb4
      tdb = tdb + tr*tempb3
      tempb = deltab + tempb2
      temp1 = temp/(v*rho_r)
      tempb3 = -(temp1*deltadb)
      tempb4 = -(temp1*tempb2)
      vdb = vdb + rho_r*tempb3
      rho_rdb = v*tempb3
      CALL POPREAL8(temp)
      tempb2 = -(tempb/(v**2*rho_r**2))
      vb = vb + rho_r*tempb4 + rho_rd*tempb3 + rho_r*tempb2
      rho_rb = v*tempb4 + vd*tempb3 + v*tempb2
      tempb2 = -(rho_rdb/vr**2)
      vrb = -(rho_rb/vr**2) - 2*vrd*tempb2/vr
      vrdb = tempb2
      CALL REDUCING_FUNCTIONS_D_B(model, n, nb, nd, ndb, vr, vrb, vrd, &
      &                         vrdb, tr, trb, trd, trdb)
      temp0 = n/temp
      temp1 = SUM(nd)
      tempb0 = xdb/temp
      ndb = ndb + tempb0 - SUM(temp0*tempb0)
      tempb1 = -(temp1*tempb0/temp)
      result1 = SUM((nd-temp1*temp0)*tempb0)
      tempb = -(SUM(n*xb)/temp**2) - result1/temp - SUM(temp0*tempb1)
      nb = nb + xb/temp + tempb1 + tempb
      arvalb = 0.0_pr
      arvaldb = 0.0_pr
   end subroutine AR_D_B

!  Differentiation of ar in forward (tangent) mode (with options noISIZE):
!   variations   of useful results: arval
!   with respect to varying inputs: n t v
!   RW status of diff variables: n:in t:in v:in arval:out
   SUBROUTINE AR_D(model, n, nd, v, vd, t, td, arval, arvald)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:), v, t
      REAL(pr), INTENT(IN) :: nd(:), vd, td
      REAL(pr), INTENT(OUT) :: arval
      REAL(pr), INTENT(OUT) :: arvald
      REAL(pr) :: vr, tr, x(SIZE(n)), rho_c(SIZE(n)), rho_r
      REAL(pr) :: vrd, trd, xd(SIZE(n)), rho_rd
      REAL(pr) :: delta, tau
      REAL(pr) :: deltad, taud
      TYPE(GERG2008PURE) :: pures(SIZE(n))
      TYPE(GERG2008BINARY) :: binary
      REAL(pr) :: fij(SIZE(n), SIZE(n)), aij
      REAL(pr) :: aijd
      REAL(pr) :: ar_pures(SIZE(n))
      REAL(pr) :: ar_puresd(SIZE(n))
      INTEGER :: i, j, k, nc
      INTRINSIC SUM
      REAL(pr) :: temp
      INTRINSIC SIZE
      fij = model%binaries%fij
      pures = model%pures
      nc = SIZE(n)
      temp = SUM(n)
      xd = (nd-n*SUM(nd)/temp)/temp
      x = n/temp
      CALL REDUCING_FUNCTIONS_D(model, n, nd, vr, vrd, tr, trd)
      rho_rd = -(vrd/vr**2)
      rho_r = 1/vr
      temp = 1.0/(v*rho_r)
      deltad = -(temp*(rho_r*vd+v*rho_rd)/(v*rho_r))
      delta = temp
      taud = (trd-tr*td/t)/t
      tau = tr/t
      ar_puresd = 0.0_pr
      DO i=1,nc
         CALL AR_PURE_D(pures(i), delta, deltad, tau, taud, ar_pures(i), &
         &              ar_puresd(i))
      END DO
      arvald = SUM(ar_pures*xd + x*ar_puresd)
      arval = SUM(x*ar_pures)
      DO i=1,nc
         DO j=i+1,nc
            binary = model%binaries(i, j)
            CALL AR_IJ_D(model, delta, deltad, tau, taud, binary, aij, aijd)
            arvald = arvald + fij(i, j)*(x(j)*(aij*xd(i)+x(i)*aijd)+x(i)*aij&
            &         *xd(j))
            arval = arval + x(i)*x(j)*fij(i, j)*aij
         END DO
      END DO
      temp = SUM(n)
      arvald = ryaeos*(arval*t*SUM(nd)+temp*(t*arvald+arval*td))
      arval = ryaeos*(temp*(arval*t))
   end subroutine AR_D

!  Differentiation of ar in reverse (adjoint) mode (with options noISIZE):
!   gradient     of useful results: arval
!   with respect to varying inputs: n t v arval
!   RW status of diff variables: n:out t:out v:out arval:in-zero
   SUBROUTINE AR_B(model, n, nb, v, vb, t, tb, arval, arvalb)
      USE ISO_C_BINDING
      USE ADMM_TAPENADE_INTERFACE
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:), v, t
      REAL(pr) :: nb(:), vb, tb
      REAL(pr) :: arval
      REAL(pr) :: arvalb
      REAL(pr) :: vr, tr, x(SIZE(n)), rho_c(SIZE(n)), rho_r
      REAL(pr) :: vrb, trb, xb(SIZE(n)), rho_rb
      REAL(pr) :: delta, tau
      REAL(pr) :: deltab, taub
      TYPE(GERG2008PURE) :: pures(SIZE(n))
      TYPE(GERG2008BINARY) :: binary
      REAL(pr) :: fij(SIZE(n), SIZE(n)), aij
      REAL(pr) :: aijb
      REAL(pr) :: ar_pures(SIZE(n))
      REAL(pr) :: ar_puresb(SIZE(n))
      INTEGER :: i, j, k, nc
      INTRINSIC SUM
      INTRINSIC SIZE
      REAL(pr) :: temp
      REAL(pr) :: tempb
      INTEGER :: ad_from
      fij = model%binaries%fij
      pures = model%pures
      nc = SIZE(n)
      x = n/SUM(n)
      CALL REDUCING_FUNCTIONS(model, n, vr, tr)
      rho_r = 1/vr
      delta = 1/v/rho_r
      tau = tr/t
      DO i=1,nc
         CALL AR_PURE(pures(i), delta, tau, ar_pures(i))
      END DO
      arval = SUM(x*ar_pures)
      DO i=1,nc
         ad_from = i + 1
         DO j=ad_from,nc
            CALL PUSHREAL8(binary%bv)
            CALL PUSHREAL8(binary%gv)
            CALL PUSHREAL8(binary%bt)
            CALL PUSHREAL8(binary%gt)
            CALL PUSHINTEGER4(binary%kpolij)
            CALL PUSHINTEGER4(binary%kexpij)
            CALL PUSHREAL8(binary%fij)
            binary = model%binaries(i, j)
            CALL PUSHREAL8(aij)
            CALL AR_IJ(model, delta, tau, binary, aij)
            arval = arval + x(i)*x(j)*fij(i, j)*aij
         END DO
         CALL PUSHINTEGER4(ad_from)
      END DO
      nb = 0.0_pr
      nb = arval*t*ryaeos*arvalb
      tempb = SUM(n)*ryaeos*arvalb
      arvalb = t*tempb
      tb = arval*tempb
      taub = 0.0_pr
      xb = 0.0_pr
      deltab = 0.0_pr
      DO i=nc,1,-1
         CALL POPINTEGER4(ad_from)
         DO j=nc,ad_from,-1
            tempb = fij(i, j)*arvalb
            xb(i) = xb(i) + aij*x(j)*tempb
            aijb = x(i)*x(j)*tempb
            xb(j) = xb(j) + x(i)*aij*tempb
            CALL POPREAL8(aij)
            CALL AR_IJ_B(model, delta, deltab, tau, taub, binary, aij, aijb)
            CALL POPREAL8(binary%fij)
            CALL POPINTEGER4(binary%kexpij)
            CALL POPINTEGER4(binary%kpolij)
            CALL POPREAL8(binary%gt)
            CALL POPREAL8(binary%bt)
            CALL POPREAL8(binary%gv)
            CALL POPREAL8(binary%bv)
         END DO
      END DO
      ar_puresb = 0.0_pr
      xb = xb + ar_pures*arvalb
      ar_puresb = x*arvalb
      DO i=nc,1,-1
         CALL AR_PURE_B(pures(i), delta, deltab, tau, taub, ar_pures(i), &
         &              ar_puresb(i))
         ar_puresb(i) = 0.0_pr
      END DO
      trb = taub/t
      tb = tb - tr*taub/t**2
      tempb = -(deltab/(v**2*rho_r**2))
      vb = rho_r*tempb
      rho_rb = v*tempb
      vrb = -(rho_rb/vr**2)
      CALL REDUCING_FUNCTIONS_B(model, n, nb, vr, vrb, tr, trb)
      temp = SUM(n)
      nb = nb + xb/temp - SUM(n*xb)/temp**2
      arvalb = 0.0_pr
   end subroutine AR_B

   SUBROUTINE AR(model, n, v, t, arval)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: model
      REAL(pr), INTENT(IN) :: n(:), v, t
      REAL(pr), INTENT(OUT) :: arval
      REAL(pr) :: vr, tr, x(SIZE(n)), rho_c(SIZE(n)), rho_r
      REAL(pr) :: delta, tau
      TYPE(GERG2008PURE) :: pures(SIZE(n))
      TYPE(GERG2008BINARY) :: binary
      REAL(pr) :: fij(SIZE(n), SIZE(n)), aij
      REAL(pr) :: ar_pures(SIZE(n))
      INTEGER :: i, j, k, nc
      INTRINSIC SUM
      INTRINSIC SIZE
      fij = model%binaries%fij
      pures = model%pures
      nc = SIZE(n)
      x = n/SUM(n)
      CALL REDUCING_FUNCTIONS(model, n, vr, tr)
      rho_r = 1/vr
      delta = 1/v/rho_r
      tau = tr/t
      DO i=1,nc
         CALL AR_PURE(pures(i), delta, tau, ar_pures(i))
      END DO
      arval = SUM(x*ar_pures)
      DO i=1,nc
         DO j=i+1,nc
            binary = model%binaries(i, j)
            CALL AR_IJ(model, delta, tau, binary, aij)
            arval = arval + x(i)*x(j)*fij(i, j)*aij
         END DO
      END DO
      arval = arval*(SUM(n)*ryaeos*t)
   end subroutine AR

   FUNCTION VOLUME_INITALIZER(self, n, p, t) RESULT (v0)
      IMPLICIT NONE
      class(GERG2008), INTENT(IN) :: self
      REAL(pr), INTENT(IN) :: n(:)
      REAL(pr), INTENT(IN) :: p
      REAL(pr), INTENT(IN) :: t
      REAL(pr) :: v0

      call self%srk%volume(n, P, T, V0, root_type="liquid")
   end function VOLUME_INITALIZER

end module YAEOS__MODELS_AR_GERG2008

